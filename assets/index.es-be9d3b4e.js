import{g as dc,c as gr,t as bi,d as p1,e as ie,f as d1,w as Ml,j as jl,k as gc,l as lo,m as g1,I as _i,A as v1,U as y1,o as Z,p as m1,q as oc,u as _1,_ as w1,P as b1,V as Ah,v as E1,x as x1,y as I1,Z as Oh,$ as S1,z as P1,E as ao,G as C1,H as zl,J as Dr,K as A1,L as O1,X as cs,M as Dt,N as tr,O as mi,Q as cr,R as R1,S as us,T as ql,Y as T1,a0 as N1,a1 as L1,a2 as Ul,a3 as F1,a4 as kl,a5 as Hl,a6 as ls,a7 as ac,a8 as io,a9 as ps,aa as D1,ab as so,ac as $1,ad as M1,ae as j1,af as z1,ag as q1,ah as Ka,ai as Rh,aj as U1,ak as k1,al as H1,am as Th,an as K1,ao as V1,ap as B1,aq as G1,ar as W1,as as J1,at as Y1,au as X1,av as no,aw as Kl,ax as Va,ay as Z1,az as Q1}from"./index-59901e21.js";var vc={exports:{}},fs=typeof Reflect=="object"?Reflect:null,Nh=fs&&typeof fs.apply=="function"?fs.apply:function(r,i,n){return Function.prototype.apply.call(r,i,n)},oo;fs&&typeof fs.ownKeys=="function"?oo=fs.ownKeys:Object.getOwnPropertySymbols?oo=function(r){return Object.getOwnPropertyNames(r).concat(Object.getOwnPropertySymbols(r))}:oo=function(r){return Object.getOwnPropertyNames(r)};function em(c){console&&console.warn&&console.warn(c)}var Vl=Number.isNaN||function(r){return r!==r};function ke(){ke.init.call(this)}vc.exports=ke;vc.exports.once=sm;ke.EventEmitter=ke;ke.prototype._events=void 0;ke.prototype._eventsCount=0;ke.prototype._maxListeners=void 0;var Lh=10;function fo(c){if(typeof c!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof c)}Object.defineProperty(ke,"defaultMaxListeners",{enumerable:!0,get:function(){return Lh},set:function(c){if(typeof c!="number"||c<0||Vl(c))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+c+".");Lh=c}});ke.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};ke.prototype.setMaxListeners=function(r){if(typeof r!="number"||r<0||Vl(r))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+r+".");return this._maxListeners=r,this};function Bl(c){return c._maxListeners===void 0?ke.defaultMaxListeners:c._maxListeners}ke.prototype.getMaxListeners=function(){return Bl(this)};ke.prototype.emit=function(r){for(var i=[],n=1;n<arguments.length;n++)i.push(arguments[n]);var o=r==="error",l=this._events;if(l!==void 0)o=o&&l.error===void 0;else if(!o)return!1;if(o){var d;if(i.length>0&&(d=i[0]),d instanceof Error)throw d;var v=new Error("Unhandled error."+(d?" ("+d.message+")":""));throw v.context=d,v}var _=l[r];if(_===void 0)return!1;if(typeof _=="function")Nh(_,this,i);else for(var S=_.length,F=Xl(_,S),n=0;n<S;++n)Nh(F[n],this,i);return!0};function Gl(c,r,i,n){var o,l,d;if(fo(i),l=c._events,l===void 0?(l=c._events=Object.create(null),c._eventsCount=0):(l.newListener!==void 0&&(c.emit("newListener",r,i.listener?i.listener:i),l=c._events),d=l[r]),d===void 0)d=l[r]=i,++c._eventsCount;else if(typeof d=="function"?d=l[r]=n?[i,d]:[d,i]:n?d.unshift(i):d.push(i),o=Bl(c),o>0&&d.length>o&&!d.warned){d.warned=!0;var v=new Error("Possible EventEmitter memory leak detected. "+d.length+" "+String(r)+" listeners added. Use emitter.setMaxListeners() to increase limit");v.name="MaxListenersExceededWarning",v.emitter=c,v.type=r,v.count=d.length,em(v)}return c}ke.prototype.addListener=function(r,i){return Gl(this,r,i,!1)};ke.prototype.on=ke.prototype.addListener;ke.prototype.prependListener=function(r,i){return Gl(this,r,i,!0)};function tm(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Wl(c,r,i){var n={fired:!1,wrapFn:void 0,target:c,type:r,listener:i},o=tm.bind(n);return o.listener=i,n.wrapFn=o,o}ke.prototype.once=function(r,i){return fo(i),this.on(r,Wl(this,r,i)),this};ke.prototype.prependOnceListener=function(r,i){return fo(i),this.prependListener(r,Wl(this,r,i)),this};ke.prototype.removeListener=function(r,i){var n,o,l,d,v;if(fo(i),o=this._events,o===void 0)return this;if(n=o[r],n===void 0)return this;if(n===i||n.listener===i)--this._eventsCount===0?this._events=Object.create(null):(delete o[r],o.removeListener&&this.emit("removeListener",r,n.listener||i));else if(typeof n!="function"){for(l=-1,d=n.length-1;d>=0;d--)if(n[d]===i||n[d].listener===i){v=n[d].listener,l=d;break}if(l<0)return this;l===0?n.shift():rm(n,l),n.length===1&&(o[r]=n[0]),o.removeListener!==void 0&&this.emit("removeListener",r,v||i)}return this};ke.prototype.off=ke.prototype.removeListener;ke.prototype.removeAllListeners=function(r){var i,n,o;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[r]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[r]),this;if(arguments.length===0){var l=Object.keys(n),d;for(o=0;o<l.length;++o)d=l[o],d!=="removeListener"&&this.removeAllListeners(d);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(i=n[r],typeof i=="function")this.removeListener(r,i);else if(i!==void 0)for(o=i.length-1;o>=0;o--)this.removeListener(r,i[o]);return this};function Jl(c,r,i){var n=c._events;if(n===void 0)return[];var o=n[r];return o===void 0?[]:typeof o=="function"?i?[o.listener||o]:[o]:i?im(o):Xl(o,o.length)}ke.prototype.listeners=function(r){return Jl(this,r,!0)};ke.prototype.rawListeners=function(r){return Jl(this,r,!1)};ke.listenerCount=function(c,r){return typeof c.listenerCount=="function"?c.listenerCount(r):Yl.call(c,r)};ke.prototype.listenerCount=Yl;function Yl(c){var r=this._events;if(r!==void 0){var i=r[c];if(typeof i=="function")return 1;if(i!==void 0)return i.length}return 0}ke.prototype.eventNames=function(){return this._eventsCount>0?oo(this._events):[]};function Xl(c,r){for(var i=new Array(r),n=0;n<r;++n)i[n]=c[n];return i}function rm(c,r){for(;r+1<c.length;r++)c[r]=c[r+1];c.pop()}function im(c){for(var r=new Array(c.length),i=0;i<r.length;++i)r[i]=c[i].listener||c[i];return r}function sm(c,r){return new Promise(function(i,n){function o(d){c.removeListener(r,l),n(d)}function l(){typeof c.removeListener=="function"&&c.removeListener("error",o),i([].slice.call(arguments))}Zl(c,r,l,{once:!0}),r!=="error"&&nm(c,o,{once:!0})})}function nm(c,r,i){typeof c.on=="function"&&Zl(c,"error",r,i)}function Zl(c,r,i,n){if(typeof c.on=="function")n.once?c.once(r,i):c.on(r,i);else if(typeof c.addEventListener=="function")c.addEventListener(r,function o(l){n.once&&c.removeEventListener(r,o),i(l)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof c)}var vr=vc.exports;const yc=dc(vr);var po={},Gs={};Object.defineProperty(Gs,"__esModule",{value:!0});function om(c){if(typeof c!="string")throw new Error(`Cannot safe json parse value of type ${typeof c}`);try{return JSON.parse(c)}catch{return c}}Gs.safeJsonParse=om;function am(c){return typeof c=="string"?c:JSON.stringify(c,(r,i)=>typeof i>"u"?null:i)}Gs.safeJsonStringify=am;var Fs={exports:{}},Fh;function cm(){return Fh||(Fh=1,function(){let c;function r(){}c=r,c.prototype.getItem=function(i){return this.hasOwnProperty(i)?String(this[i]):null},c.prototype.setItem=function(i,n){this[i]=String(n)},c.prototype.removeItem=function(i){delete this[i]},c.prototype.clear=function(){const i=this;Object.keys(i).forEach(function(n){i[n]=void 0,delete i[n]})},c.prototype.key=function(i){return i=i||0,Object.keys(this)[i]},c.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof gr<"u"&&gr.localStorage?Fs.exports=gr.localStorage:typeof window<"u"&&window.localStorage?Fs.exports=window.localStorage:Fs.exports=new r}()),Fs.exports}var Ba={},Ds={},Dh;function um(){if(Dh)return Ds;Dh=1,Object.defineProperty(Ds,"__esModule",{value:!0}),Ds.IKeyValueStorage=void 0;class c{}return Ds.IKeyValueStorage=c,Ds}var $s={},$h;function hm(){if($h)return $s;$h=1,Object.defineProperty($s,"__esModule",{value:!0}),$s.parseEntry=void 0;const c=Gs;function r(i){var n;return[i[0],c.safeJsonParse((n=i[1])!==null&&n!==void 0?n:"")]}return $s.parseEntry=r,$s}var Mh;function lm(){return Mh||(Mh=1,function(c){Object.defineProperty(c,"__esModule",{value:!0});const r=bi;r.__exportStar(um(),c),r.__exportStar(hm(),c)}(Ba)),Ba}Object.defineProperty(po,"__esModule",{value:!0});po.KeyValueStorage=void 0;const hs=bi,jh=Gs,fm=hs.__importDefault(cm()),pm=lm();class Ql{constructor(){this.localStorage=fm.default}getKeys(){return hs.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return hs.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(pm.parseEntry)})}getItem(r){return hs.__awaiter(this,void 0,void 0,function*(){const i=this.localStorage.getItem(r);if(i!==null)return jh.safeJsonParse(i)})}setItem(r,i){return hs.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(r,jh.safeJsonStringify(i))})}removeItem(r){return hs.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(r)})}}po.KeyValueStorage=Ql;var dm=po.default=Ql,ds={},Ms={},Ga={},js={};let qi=class{};const gm=Object.freeze(Object.defineProperty({__proto__:null,IEvents:qi},Symbol.toStringTag,{value:"Module"})),vm=p1(gm);var zh;function ym(){if(zh)return js;zh=1,Object.defineProperty(js,"__esModule",{value:!0}),js.IHeartBeat=void 0;const c=vm;class r extends c.IEvents{constructor(n){super()}}return js.IHeartBeat=r,js}var qh;function ef(){return qh||(qh=1,function(c){Object.defineProperty(c,"__esModule",{value:!0}),bi.__exportStar(ym(),c)}(Ga)),Ga}var Wa={},ji={},Uh;function mm(){if(Uh)return ji;Uh=1,Object.defineProperty(ji,"__esModule",{value:!0}),ji.HEARTBEAT_EVENTS=ji.HEARTBEAT_INTERVAL=void 0;const c=ie;return ji.HEARTBEAT_INTERVAL=c.FIVE_SECONDS,ji.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},ji}var kh;function tf(){return kh||(kh=1,function(c){Object.defineProperty(c,"__esModule",{value:!0}),bi.__exportStar(mm(),c)}(Wa)),Wa}var Hh;function _m(){if(Hh)return Ms;Hh=1,Object.defineProperty(Ms,"__esModule",{value:!0}),Ms.HeartBeat=void 0;const c=bi,r=vr,i=ie,n=ef(),o=tf();class l extends n.IHeartBeat{constructor(v){super(v),this.events=new r.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(v==null?void 0:v.interval)||o.HEARTBEAT_INTERVAL}static init(v){return c.__awaiter(this,void 0,void 0,function*(){const _=new l(v);return yield _.init(),_})}init(){return c.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(v,_){this.events.on(v,_)}once(v,_){this.events.once(v,_)}off(v,_){this.events.off(v,_)}removeListener(v,_){this.events.removeListener(v,_)}initialize(){return c.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),i.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return Ms.HeartBeat=l,Ms}(function(c){Object.defineProperty(c,"__esModule",{value:!0});const r=bi;r.__exportStar(_m(),c),r.__exportStar(ef(),c),r.__exportStar(tf(),c)})(ds);var Ae={},Ja,Kh;function wm(){if(Kh)return Ja;Kh=1;function c(i){try{return JSON.stringify(i)}catch{return'"[Circular]"'}}Ja=r;function r(i,n,o){var l=o&&o.stringify||c,d=1;if(typeof i=="object"&&i!==null){var v=n.length+d;if(v===1)return i;var _=new Array(v);_[0]=l(i);for(var S=1;S<v;S++)_[S]=l(n[S]);return _.join(" ")}if(typeof i!="string")return i;var F=n.length;if(F===0)return i;for(var G="",W=1-d,V=-1,q=i&&i.length||0,K=0;K<q;){if(i.charCodeAt(K)===37&&K+1<q){switch(V=V>-1?V:0,i.charCodeAt(K+1)){case 100:case 102:if(W>=F||n[W]==null)break;V<K&&(G+=i.slice(V,K)),G+=Number(n[W]),V=K+2,K++;break;case 105:if(W>=F||n[W]==null)break;V<K&&(G+=i.slice(V,K)),G+=Math.floor(Number(n[W])),V=K+2,K++;break;case 79:case 111:case 106:if(W>=F||n[W]===void 0)break;V<K&&(G+=i.slice(V,K));var oe=typeof n[W];if(oe==="string"){G+="'"+n[W]+"'",V=K+2,K++;break}if(oe==="function"){G+=n[W].name||"<anonymous>",V=K+2,K++;break}G+=l(n[W]),V=K+2,K++;break;case 115:if(W>=F)break;V<K&&(G+=i.slice(V,K)),G+=String(n[W]),V=K+2,K++;break;case 37:V<K&&(G+=i.slice(V,K)),G+="%",V=K+2,K++,W--;break}++W}++K}return V===-1?i:(V<q&&(G+=i.slice(V)),G)}return Ja}var Ya,Vh;function bm(){if(Vh)return Ya;Vh=1;const c=wm();Ya=o;const r=he().console||{},i={mapHttpRequest:q,mapHttpResponse:q,wrapRequestSerializer:K,wrapResponseSerializer:K,wrapErrorSerializer:K,req:q,res:q,err:W};function n(R,j){return Array.isArray(R)?R.filter(function(ge){return ge!=="!stdSerializers.err"}):R===!0?Object.keys(j):!1}function o(R){R=R||{},R.browser=R.browser||{};const j=R.browser.transmit;if(j&&typeof j.send!="function")throw Error("pino: transmit option must have a send function");const B=R.browser.write||r;R.browser.write&&(R.browser.asObject=!0);const ge=R.serializers||{},te=n(R.browser.serialize,ge);let Ee=R.browser.serialize;Array.isArray(R.browser.serialize)&&R.browser.serialize.indexOf("!stdSerializers.err")>-1&&(Ee=!1);const Oe=["error","fatal","warn","info","debug","trace"];typeof B=="function"&&(B.error=B.fatal=B.warn=B.info=B.debug=B.trace=B),R.enabled===!1&&(R.level="silent");const tt=R.level||"info",C=Object.create(B);C.log||(C.log=oe),Object.defineProperty(C,"levelVal",{get:ze}),Object.defineProperty(C,"level",{get:Re,set:J});const D={transmit:j,serialize:te,asObject:R.browser.asObject,levels:Oe,timestamp:V(R)};C.levels=o.levels,C.level=tt,C.setMaxListeners=C.getMaxListeners=C.emit=C.addListener=C.on=C.prependListener=C.once=C.prependOnceListener=C.removeListener=C.removeAllListeners=C.listeners=C.listenerCount=C.eventNames=C.write=C.flush=oe,C.serializers=ge,C._serialize=te,C._stdErrSerialize=Ee,C.child=U,j&&(C._logEvent=G());function ze(){return this.level==="silent"?1/0:this.levels.values[this.level]}function Re(){return this._level}function J(z){if(z!=="silent"&&!this.levels.values[z])throw Error("unknown level "+z);this._level=z,l(D,C,"error","log"),l(D,C,"fatal","error"),l(D,C,"warn","error"),l(D,C,"info","log"),l(D,C,"debug","log"),l(D,C,"trace","log")}function U(z,k){if(!z)throw new Error("missing bindings for child Pino");k=k||{},te&&z.serializers&&(k.serializers=z.serializers);const ut=k.serializers;if(te&&ut){var He=Object.assign({},ge,ut),Mr=R.browser.serialize===!0?Object.keys(He):te;delete z.serializers,_([z],Mr,He,this._stdErrSerialize)}function _e(St){this._childLevel=(St._childLevel|0)+1,this.error=S(St,z,"error"),this.fatal=S(St,z,"fatal"),this.warn=S(St,z,"warn"),this.info=S(St,z,"info"),this.debug=S(St,z,"debug"),this.trace=S(St,z,"trace"),He&&(this.serializers=He,this._serialize=Mr),j&&(this._logEvent=G([].concat(St._logEvent.bindings,z)))}return _e.prototype=this,new _e(this)}return C}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=i,o.stdTimeFunctions=Object.assign({},{nullTime:be,epochTime:de,unixTime:pe,isoTime:ue});function l(R,j,B,ge){const te=Object.getPrototypeOf(j);j[B]=j.levelVal>j.levels.values[B]?oe:te[B]?te[B]:r[B]||r[ge]||oe,d(R,j,B)}function d(R,j,B){!R.transmit&&j[B]===oe||(j[B]=function(ge){return function(){const Ee=R.timestamp(),Oe=new Array(arguments.length),tt=Object.getPrototypeOf&&Object.getPrototypeOf(this)===r?r:this;for(var C=0;C<Oe.length;C++)Oe[C]=arguments[C];if(R.serialize&&!R.asObject&&_(Oe,this._serialize,this.serializers,this._stdErrSerialize),R.asObject?ge.call(tt,v(this,B,Oe,Ee)):ge.apply(tt,Oe),R.transmit){const D=R.transmit.level||j.level,ze=o.levels.values[D],Re=o.levels.values[B];if(Re<ze)return;F(this,{ts:Ee,methodLevel:B,methodValue:Re,transmitLevel:D,transmitValue:o.levels.values[R.transmit.level||j.level],send:R.transmit.send,val:j.levelVal},Oe)}}}(j[B]))}function v(R,j,B,ge){R._serialize&&_(B,R._serialize,R.serializers,R._stdErrSerialize);const te=B.slice();let Ee=te[0];const Oe={};ge&&(Oe.time=ge),Oe.level=o.levels.values[j];let tt=(R._childLevel|0)+1;if(tt<1&&(tt=1),Ee!==null&&typeof Ee=="object"){for(;tt--&&typeof te[0]=="object";)Object.assign(Oe,te.shift());Ee=te.length?c(te.shift(),te):void 0}else typeof Ee=="string"&&(Ee=c(te.shift(),te));return Ee!==void 0&&(Oe.msg=Ee),Oe}function _(R,j,B,ge){for(const te in R)if(ge&&R[te]instanceof Error)R[te]=o.stdSerializers.err(R[te]);else if(typeof R[te]=="object"&&!Array.isArray(R[te]))for(const Ee in R[te])j&&j.indexOf(Ee)>-1&&Ee in B&&(R[te][Ee]=B[Ee](R[te][Ee]))}function S(R,j,B){return function(){const ge=new Array(1+arguments.length);ge[0]=j;for(var te=1;te<ge.length;te++)ge[te]=arguments[te-1];return R[B].apply(this,ge)}}function F(R,j,B){const ge=j.send,te=j.ts,Ee=j.methodLevel,Oe=j.methodValue,tt=j.val,C=R._logEvent.bindings;_(B,R._serialize||Object.keys(R.serializers),R.serializers,R._stdErrSerialize===void 0?!0:R._stdErrSerialize),R._logEvent.ts=te,R._logEvent.messages=B.filter(function(D){return C.indexOf(D)===-1}),R._logEvent.level.label=Ee,R._logEvent.level.value=Oe,ge(Ee,R._logEvent,tt),R._logEvent=G(C)}function G(R){return{ts:0,messages:[],bindings:R||[],level:{label:"",value:0}}}function W(R){const j={type:R.constructor.name,msg:R.message,stack:R.stack};for(const B in R)j[B]===void 0&&(j[B]=R[B]);return j}function V(R){return typeof R.timestamp=="function"?R.timestamp:R.timestamp===!1?be:de}function q(){return{}}function K(R){return R}function oe(){}function be(){return!1}function de(){return Date.now()}function pe(){return Math.round(Date.now()/1e3)}function ue(){return new Date(Date.now()).toISOString()}function he(){function R(j){return typeof j<"u"&&j}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return R(self)||R(window)||R(this)||{}}}return Ya}var zi={},Bh;function rf(){return Bh||(Bh=1,Object.defineProperty(zi,"__esModule",{value:!0}),zi.PINO_CUSTOM_CONTEXT_KEY=zi.PINO_LOGGER_DEFAULTS=void 0,zi.PINO_LOGGER_DEFAULTS={level:"info"},zi.PINO_CUSTOM_CONTEXT_KEY="custom_context"),zi}var er={},Gh;function Em(){if(Gh)return er;Gh=1,Object.defineProperty(er,"__esModule",{value:!0}),er.generateChildLogger=er.formatChildLoggerContext=er.getLoggerContext=er.setBrowserLoggerContext=er.getBrowserLoggerContext=er.getDefaultLoggerOptions=void 0;const c=rf();function r(v){return Object.assign(Object.assign({},v),{level:(v==null?void 0:v.level)||c.PINO_LOGGER_DEFAULTS.level})}er.getDefaultLoggerOptions=r;function i(v,_=c.PINO_CUSTOM_CONTEXT_KEY){return v[_]||""}er.getBrowserLoggerContext=i;function n(v,_,S=c.PINO_CUSTOM_CONTEXT_KEY){return v[S]=_,v}er.setBrowserLoggerContext=n;function o(v,_=c.PINO_CUSTOM_CONTEXT_KEY){let S="";return typeof v.bindings>"u"?S=i(v,_):S=v.bindings().context||"",S}er.getLoggerContext=o;function l(v,_,S=c.PINO_CUSTOM_CONTEXT_KEY){const F=o(v,S);return F.trim()?`${F}/${_}`:_}er.formatChildLoggerContext=l;function d(v,_,S=c.PINO_CUSTOM_CONTEXT_KEY){const F=l(v,_,S),G=v.child({context:F});return n(G,F,S)}return er.generateChildLogger=d,er}(function(c){Object.defineProperty(c,"__esModule",{value:!0}),c.pino=void 0;const r=bi,i=r.__importDefault(bm());Object.defineProperty(c,"pino",{enumerable:!0,get:function(){return i.default}}),r.__exportStar(rf(),c),r.__exportStar(Em(),c)})(Ae);class xm extends qi{constructor(r){super(),this.opts=r,this.protocol="wc",this.version=2}}class Im extends qi{constructor(r,i){super(),this.core=r,this.logger=i,this.records=new Map}}class Sm{constructor(r,i){this.logger=r,this.core=i}}let Pm=class extends qi{constructor(r,i){super(),this.relayer=r,this.logger=i}},Cm=class extends qi{constructor(r){super()}},Am=class{constructor(r,i,n,o){this.core=r,this.logger=i,this.name=n}};class Om extends qi{constructor(r,i){super(),this.relayer=r,this.logger=i}}let Rm=class extends qi{constructor(r,i){super(),this.core=r,this.logger=i}},Tm=class{constructor(r,i){this.projectId=r,this.logger=i}},Nm=class{constructor(r){this.opts=r,this.protocol="wc",this.version=2}},Lm=class{constructor(r){this.client=r}};const Fm=c=>JSON.stringify(c,(r,i)=>typeof i=="bigint"?i.toString()+"n":i),Dm=c=>{const r=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,i=c.replace(r,'$1"$2n"$3');return JSON.parse(i,(n,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function mc(c){if(typeof c!="string")throw new Error(`Cannot safe json parse value of type ${typeof c}`);try{return Dm(c)}catch{return c}}function Bs(c){return typeof c=="string"?c:Fm(c)||""}var _c={},sf={};(function(c){Object.defineProperty(c,"__esModule",{value:!0});var r=d1,i=Ml;c.DIGEST_LENGTH=64,c.BLOCK_SIZE=128;var n=function(){function v(){this.digestLength=c.DIGEST_LENGTH,this.blockSize=c.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return v.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},v.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},v.prototype.clean=function(){i.wipe(this._buffer),i.wipe(this._tempHi),i.wipe(this._tempLo),this.reset()},v.prototype.update=function(_,S){if(S===void 0&&(S=_.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var F=0;if(this._bytesHashed+=S,this._bufferLength>0){for(;this._bufferLength<c.BLOCK_SIZE&&S>0;)this._buffer[this._bufferLength++]=_[F++],S--;this._bufferLength===this.blockSize&&(l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(S>=this.blockSize&&(F=l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,_,F,S),S%=this.blockSize);S>0;)this._buffer[this._bufferLength++]=_[F++],S--;return this},v.prototype.finish=function(_){if(!this._finished){var S=this._bytesHashed,F=this._bufferLength,G=S/536870912|0,W=S<<3,V=S%128<112?128:256;this._buffer[F]=128;for(var q=F+1;q<V-8;q++)this._buffer[q]=0;r.writeUint32BE(G,this._buffer,V-8),r.writeUint32BE(W,this._buffer,V-4),l(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,V),this._finished=!0}for(var q=0;q<this.digestLength/8;q++)r.writeUint32BE(this._stateHi[q],_,q*8),r.writeUint32BE(this._stateLo[q],_,q*8+4);return this},v.prototype.digest=function(){var _=new Uint8Array(this.digestLength);return this.finish(_),_},v.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},v.prototype.restoreState=function(_){return this._stateHi.set(_.stateHi),this._stateLo.set(_.stateLo),this._bufferLength=_.bufferLength,_.buffer&&this._buffer.set(_.buffer),this._bytesHashed=_.bytesHashed,this._finished=!1,this},v.prototype.cleanSavedState=function(_){i.wipe(_.stateHi),i.wipe(_.stateLo),_.buffer&&i.wipe(_.buffer),_.bufferLength=0,_.bytesHashed=0},v}();c.SHA512=n;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function l(v,_,S,F,G,W,V){for(var q=S[0],K=S[1],oe=S[2],be=S[3],de=S[4],pe=S[5],ue=S[6],he=S[7],R=F[0],j=F[1],B=F[2],ge=F[3],te=F[4],Ee=F[5],Oe=F[6],tt=F[7],C,D,ze,Re,J,U,z,k;V>=128;){for(var ut=0;ut<16;ut++){var He=8*ut+W;v[ut]=r.readUint32BE(G,He),_[ut]=r.readUint32BE(G,He+4)}for(var ut=0;ut<80;ut++){var Mr=q,_e=K,St=oe,O=be,A=de,I=pe,u=ue,w=he,Q=R,ae=j,ye=B,Te=ge,Le=te,Ie=Ee,Pt=Oe,_t=tt;if(C=he,D=tt,J=D&65535,U=D>>>16,z=C&65535,k=C>>>16,C=(de>>>14|te<<32-14)^(de>>>18|te<<32-18)^(te>>>41-32|de<<32-(41-32)),D=(te>>>14|de<<32-14)^(te>>>18|de<<32-18)^(de>>>41-32|te<<32-(41-32)),J+=D&65535,U+=D>>>16,z+=C&65535,k+=C>>>16,C=de&pe^~de&ue,D=te&Ee^~te&Oe,J+=D&65535,U+=D>>>16,z+=C&65535,k+=C>>>16,C=o[ut*2],D=o[ut*2+1],J+=D&65535,U+=D>>>16,z+=C&65535,k+=C>>>16,C=v[ut%16],D=_[ut%16],J+=D&65535,U+=D>>>16,z+=C&65535,k+=C>>>16,U+=J>>>16,z+=U>>>16,k+=z>>>16,ze=z&65535|k<<16,Re=J&65535|U<<16,C=ze,D=Re,J=D&65535,U=D>>>16,z=C&65535,k=C>>>16,C=(q>>>28|R<<32-28)^(R>>>34-32|q<<32-(34-32))^(R>>>39-32|q<<32-(39-32)),D=(R>>>28|q<<32-28)^(q>>>34-32|R<<32-(34-32))^(q>>>39-32|R<<32-(39-32)),J+=D&65535,U+=D>>>16,z+=C&65535,k+=C>>>16,C=q&K^q&oe^K&oe,D=R&j^R&B^j&B,J+=D&65535,U+=D>>>16,z+=C&65535,k+=C>>>16,U+=J>>>16,z+=U>>>16,k+=z>>>16,w=z&65535|k<<16,_t=J&65535|U<<16,C=O,D=Te,J=D&65535,U=D>>>16,z=C&65535,k=C>>>16,C=ze,D=Re,J+=D&65535,U+=D>>>16,z+=C&65535,k+=C>>>16,U+=J>>>16,z+=U>>>16,k+=z>>>16,O=z&65535|k<<16,Te=J&65535|U<<16,K=Mr,oe=_e,be=St,de=O,pe=A,ue=I,he=u,q=w,j=Q,B=ae,ge=ye,te=Te,Ee=Le,Oe=Ie,tt=Pt,R=_t,ut%16===15)for(var He=0;He<16;He++)C=v[He],D=_[He],J=D&65535,U=D>>>16,z=C&65535,k=C>>>16,C=v[(He+9)%16],D=_[(He+9)%16],J+=D&65535,U+=D>>>16,z+=C&65535,k+=C>>>16,ze=v[(He+1)%16],Re=_[(He+1)%16],C=(ze>>>1|Re<<32-1)^(ze>>>8|Re<<32-8)^ze>>>7,D=(Re>>>1|ze<<32-1)^(Re>>>8|ze<<32-8)^(Re>>>7|ze<<32-7),J+=D&65535,U+=D>>>16,z+=C&65535,k+=C>>>16,ze=v[(He+14)%16],Re=_[(He+14)%16],C=(ze>>>19|Re<<32-19)^(Re>>>61-32|ze<<32-(61-32))^ze>>>6,D=(Re>>>19|ze<<32-19)^(ze>>>61-32|Re<<32-(61-32))^(Re>>>6|ze<<32-6),J+=D&65535,U+=D>>>16,z+=C&65535,k+=C>>>16,U+=J>>>16,z+=U>>>16,k+=z>>>16,v[He]=z&65535|k<<16,_[He]=J&65535|U<<16}C=q,D=R,J=D&65535,U=D>>>16,z=C&65535,k=C>>>16,C=S[0],D=F[0],J+=D&65535,U+=D>>>16,z+=C&65535,k+=C>>>16,U+=J>>>16,z+=U>>>16,k+=z>>>16,S[0]=q=z&65535|k<<16,F[0]=R=J&65535|U<<16,C=K,D=j,J=D&65535,U=D>>>16,z=C&65535,k=C>>>16,C=S[1],D=F[1],J+=D&65535,U+=D>>>16,z+=C&65535,k+=C>>>16,U+=J>>>16,z+=U>>>16,k+=z>>>16,S[1]=K=z&65535|k<<16,F[1]=j=J&65535|U<<16,C=oe,D=B,J=D&65535,U=D>>>16,z=C&65535,k=C>>>16,C=S[2],D=F[2],J+=D&65535,U+=D>>>16,z+=C&65535,k+=C>>>16,U+=J>>>16,z+=U>>>16,k+=z>>>16,S[2]=oe=z&65535|k<<16,F[2]=B=J&65535|U<<16,C=be,D=ge,J=D&65535,U=D>>>16,z=C&65535,k=C>>>16,C=S[3],D=F[3],J+=D&65535,U+=D>>>16,z+=C&65535,k+=C>>>16,U+=J>>>16,z+=U>>>16,k+=z>>>16,S[3]=be=z&65535|k<<16,F[3]=ge=J&65535|U<<16,C=de,D=te,J=D&65535,U=D>>>16,z=C&65535,k=C>>>16,C=S[4],D=F[4],J+=D&65535,U+=D>>>16,z+=C&65535,k+=C>>>16,U+=J>>>16,z+=U>>>16,k+=z>>>16,S[4]=de=z&65535|k<<16,F[4]=te=J&65535|U<<16,C=pe,D=Ee,J=D&65535,U=D>>>16,z=C&65535,k=C>>>16,C=S[5],D=F[5],J+=D&65535,U+=D>>>16,z+=C&65535,k+=C>>>16,U+=J>>>16,z+=U>>>16,k+=z>>>16,S[5]=pe=z&65535|k<<16,F[5]=Ee=J&65535|U<<16,C=ue,D=Oe,J=D&65535,U=D>>>16,z=C&65535,k=C>>>16,C=S[6],D=F[6],J+=D&65535,U+=D>>>16,z+=C&65535,k+=C>>>16,U+=J>>>16,z+=U>>>16,k+=z>>>16,S[6]=ue=z&65535|k<<16,F[6]=Oe=J&65535|U<<16,C=he,D=tt,J=D&65535,U=D>>>16,z=C&65535,k=C>>>16,C=S[7],D=F[7],J+=D&65535,U+=D>>>16,z+=C&65535,k+=C>>>16,U+=J>>>16,z+=U>>>16,k+=z>>>16,S[7]=he=z&65535|k<<16,F[7]=tt=J&65535|U<<16,W+=128,V-=128}return W}function d(v){var _=new n;_.update(v);var S=_.digest();return _.clean(),S}c.hash=d})(sf);(function(c){Object.defineProperty(c,"__esModule",{value:!0}),c.convertSecretKeyToX25519=c.convertPublicKeyToX25519=c.verify=c.sign=c.extractPublicKeyFromSecretKey=c.generateKeyPair=c.generateKeyPairFromSeed=c.SEED_LENGTH=c.SECRET_KEY_LENGTH=c.PUBLIC_KEY_LENGTH=c.SIGNATURE_LENGTH=void 0;const r=jl,i=sf,n=Ml;c.SIGNATURE_LENGTH=64,c.PUBLIC_KEY_LENGTH=32,c.SECRET_KEY_LENGTH=64,c.SEED_LENGTH=32;function o(O){const A=new Float64Array(16);if(O)for(let I=0;I<O.length;I++)A[I]=O[I];return A}const l=new Uint8Array(32);l[0]=9;const d=o(),v=o([1]),_=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),S=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),F=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),G=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),W=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function V(O,A){for(let I=0;I<16;I++)O[I]=A[I]|0}function q(O){let A=1;for(let I=0;I<16;I++){let u=O[I]+A+65535;A=Math.floor(u/65536),O[I]=u-A*65536}O[0]+=A-1+37*(A-1)}function K(O,A,I){const u=~(I-1);for(let w=0;w<16;w++){const Q=u&(O[w]^A[w]);O[w]^=Q,A[w]^=Q}}function oe(O,A){const I=o(),u=o();for(let w=0;w<16;w++)u[w]=A[w];q(u),q(u),q(u);for(let w=0;w<2;w++){I[0]=u[0]-65517;for(let ae=1;ae<15;ae++)I[ae]=u[ae]-65535-(I[ae-1]>>16&1),I[ae-1]&=65535;I[15]=u[15]-32767-(I[14]>>16&1);const Q=I[15]>>16&1;I[14]&=65535,K(u,I,1-Q)}for(let w=0;w<16;w++)O[2*w]=u[w]&255,O[2*w+1]=u[w]>>8}function be(O,A){let I=0;for(let u=0;u<32;u++)I|=O[u]^A[u];return(1&I-1>>>8)-1}function de(O,A){const I=new Uint8Array(32),u=new Uint8Array(32);return oe(I,O),oe(u,A),be(I,u)}function pe(O){const A=new Uint8Array(32);return oe(A,O),A[0]&1}function ue(O,A){for(let I=0;I<16;I++)O[I]=A[2*I]+(A[2*I+1]<<8);O[15]&=32767}function he(O,A,I){for(let u=0;u<16;u++)O[u]=A[u]+I[u]}function R(O,A,I){for(let u=0;u<16;u++)O[u]=A[u]-I[u]}function j(O,A,I){let u,w,Q=0,ae=0,ye=0,Te=0,Le=0,Ie=0,Pt=0,_t=0,nt=0,De=0,Ye=0,Xe=0,ot=0,qe=0,Ze=0,Ne=0,Ke=0,ht=0,Me=0,Ct=0,$t=0,kt=0,Ht=0,zt=0,Wt=0,rr=0,jr=0,Jt=0,Br=0,ai=0,Ii=0,lt=I[0],rt=I[1],ft=I[2],pt=I[3],at=I[4],it=I[5],At=I[6],Ot=I[7],dt=I[8],Rt=I[9],gt=I[10],wt=I[11],vt=I[12],Je=I[13],Tt=I[14],Nt=I[15];u=A[0],Q+=u*lt,ae+=u*rt,ye+=u*ft,Te+=u*pt,Le+=u*at,Ie+=u*it,Pt+=u*At,_t+=u*Ot,nt+=u*dt,De+=u*Rt,Ye+=u*gt,Xe+=u*wt,ot+=u*vt,qe+=u*Je,Ze+=u*Tt,Ne+=u*Nt,u=A[1],ae+=u*lt,ye+=u*rt,Te+=u*ft,Le+=u*pt,Ie+=u*at,Pt+=u*it,_t+=u*At,nt+=u*Ot,De+=u*dt,Ye+=u*Rt,Xe+=u*gt,ot+=u*wt,qe+=u*vt,Ze+=u*Je,Ne+=u*Tt,Ke+=u*Nt,u=A[2],ye+=u*lt,Te+=u*rt,Le+=u*ft,Ie+=u*pt,Pt+=u*at,_t+=u*it,nt+=u*At,De+=u*Ot,Ye+=u*dt,Xe+=u*Rt,ot+=u*gt,qe+=u*wt,Ze+=u*vt,Ne+=u*Je,Ke+=u*Tt,ht+=u*Nt,u=A[3],Te+=u*lt,Le+=u*rt,Ie+=u*ft,Pt+=u*pt,_t+=u*at,nt+=u*it,De+=u*At,Ye+=u*Ot,Xe+=u*dt,ot+=u*Rt,qe+=u*gt,Ze+=u*wt,Ne+=u*vt,Ke+=u*Je,ht+=u*Tt,Me+=u*Nt,u=A[4],Le+=u*lt,Ie+=u*rt,Pt+=u*ft,_t+=u*pt,nt+=u*at,De+=u*it,Ye+=u*At,Xe+=u*Ot,ot+=u*dt,qe+=u*Rt,Ze+=u*gt,Ne+=u*wt,Ke+=u*vt,ht+=u*Je,Me+=u*Tt,Ct+=u*Nt,u=A[5],Ie+=u*lt,Pt+=u*rt,_t+=u*ft,nt+=u*pt,De+=u*at,Ye+=u*it,Xe+=u*At,ot+=u*Ot,qe+=u*dt,Ze+=u*Rt,Ne+=u*gt,Ke+=u*wt,ht+=u*vt,Me+=u*Je,Ct+=u*Tt,$t+=u*Nt,u=A[6],Pt+=u*lt,_t+=u*rt,nt+=u*ft,De+=u*pt,Ye+=u*at,Xe+=u*it,ot+=u*At,qe+=u*Ot,Ze+=u*dt,Ne+=u*Rt,Ke+=u*gt,ht+=u*wt,Me+=u*vt,Ct+=u*Je,$t+=u*Tt,kt+=u*Nt,u=A[7],_t+=u*lt,nt+=u*rt,De+=u*ft,Ye+=u*pt,Xe+=u*at,ot+=u*it,qe+=u*At,Ze+=u*Ot,Ne+=u*dt,Ke+=u*Rt,ht+=u*gt,Me+=u*wt,Ct+=u*vt,$t+=u*Je,kt+=u*Tt,Ht+=u*Nt,u=A[8],nt+=u*lt,De+=u*rt,Ye+=u*ft,Xe+=u*pt,ot+=u*at,qe+=u*it,Ze+=u*At,Ne+=u*Ot,Ke+=u*dt,ht+=u*Rt,Me+=u*gt,Ct+=u*wt,$t+=u*vt,kt+=u*Je,Ht+=u*Tt,zt+=u*Nt,u=A[9],De+=u*lt,Ye+=u*rt,Xe+=u*ft,ot+=u*pt,qe+=u*at,Ze+=u*it,Ne+=u*At,Ke+=u*Ot,ht+=u*dt,Me+=u*Rt,Ct+=u*gt,$t+=u*wt,kt+=u*vt,Ht+=u*Je,zt+=u*Tt,Wt+=u*Nt,u=A[10],Ye+=u*lt,Xe+=u*rt,ot+=u*ft,qe+=u*pt,Ze+=u*at,Ne+=u*it,Ke+=u*At,ht+=u*Ot,Me+=u*dt,Ct+=u*Rt,$t+=u*gt,kt+=u*wt,Ht+=u*vt,zt+=u*Je,Wt+=u*Tt,rr+=u*Nt,u=A[11],Xe+=u*lt,ot+=u*rt,qe+=u*ft,Ze+=u*pt,Ne+=u*at,Ke+=u*it,ht+=u*At,Me+=u*Ot,Ct+=u*dt,$t+=u*Rt,kt+=u*gt,Ht+=u*wt,zt+=u*vt,Wt+=u*Je,rr+=u*Tt,jr+=u*Nt,u=A[12],ot+=u*lt,qe+=u*rt,Ze+=u*ft,Ne+=u*pt,Ke+=u*at,ht+=u*it,Me+=u*At,Ct+=u*Ot,$t+=u*dt,kt+=u*Rt,Ht+=u*gt,zt+=u*wt,Wt+=u*vt,rr+=u*Je,jr+=u*Tt,Jt+=u*Nt,u=A[13],qe+=u*lt,Ze+=u*rt,Ne+=u*ft,Ke+=u*pt,ht+=u*at,Me+=u*it,Ct+=u*At,$t+=u*Ot,kt+=u*dt,Ht+=u*Rt,zt+=u*gt,Wt+=u*wt,rr+=u*vt,jr+=u*Je,Jt+=u*Tt,Br+=u*Nt,u=A[14],Ze+=u*lt,Ne+=u*rt,Ke+=u*ft,ht+=u*pt,Me+=u*at,Ct+=u*it,$t+=u*At,kt+=u*Ot,Ht+=u*dt,zt+=u*Rt,Wt+=u*gt,rr+=u*wt,jr+=u*vt,Jt+=u*Je,Br+=u*Tt,ai+=u*Nt,u=A[15],Ne+=u*lt,Ke+=u*rt,ht+=u*ft,Me+=u*pt,Ct+=u*at,$t+=u*it,kt+=u*At,Ht+=u*Ot,zt+=u*dt,Wt+=u*Rt,rr+=u*gt,jr+=u*wt,Jt+=u*vt,Br+=u*Je,ai+=u*Tt,Ii+=u*Nt,Q+=38*Ke,ae+=38*ht,ye+=38*Me,Te+=38*Ct,Le+=38*$t,Ie+=38*kt,Pt+=38*Ht,_t+=38*zt,nt+=38*Wt,De+=38*rr,Ye+=38*jr,Xe+=38*Jt,ot+=38*Br,qe+=38*ai,Ze+=38*Ii,w=1,u=Q+w+65535,w=Math.floor(u/65536),Q=u-w*65536,u=ae+w+65535,w=Math.floor(u/65536),ae=u-w*65536,u=ye+w+65535,w=Math.floor(u/65536),ye=u-w*65536,u=Te+w+65535,w=Math.floor(u/65536),Te=u-w*65536,u=Le+w+65535,w=Math.floor(u/65536),Le=u-w*65536,u=Ie+w+65535,w=Math.floor(u/65536),Ie=u-w*65536,u=Pt+w+65535,w=Math.floor(u/65536),Pt=u-w*65536,u=_t+w+65535,w=Math.floor(u/65536),_t=u-w*65536,u=nt+w+65535,w=Math.floor(u/65536),nt=u-w*65536,u=De+w+65535,w=Math.floor(u/65536),De=u-w*65536,u=Ye+w+65535,w=Math.floor(u/65536),Ye=u-w*65536,u=Xe+w+65535,w=Math.floor(u/65536),Xe=u-w*65536,u=ot+w+65535,w=Math.floor(u/65536),ot=u-w*65536,u=qe+w+65535,w=Math.floor(u/65536),qe=u-w*65536,u=Ze+w+65535,w=Math.floor(u/65536),Ze=u-w*65536,u=Ne+w+65535,w=Math.floor(u/65536),Ne=u-w*65536,Q+=w-1+37*(w-1),w=1,u=Q+w+65535,w=Math.floor(u/65536),Q=u-w*65536,u=ae+w+65535,w=Math.floor(u/65536),ae=u-w*65536,u=ye+w+65535,w=Math.floor(u/65536),ye=u-w*65536,u=Te+w+65535,w=Math.floor(u/65536),Te=u-w*65536,u=Le+w+65535,w=Math.floor(u/65536),Le=u-w*65536,u=Ie+w+65535,w=Math.floor(u/65536),Ie=u-w*65536,u=Pt+w+65535,w=Math.floor(u/65536),Pt=u-w*65536,u=_t+w+65535,w=Math.floor(u/65536),_t=u-w*65536,u=nt+w+65535,w=Math.floor(u/65536),nt=u-w*65536,u=De+w+65535,w=Math.floor(u/65536),De=u-w*65536,u=Ye+w+65535,w=Math.floor(u/65536),Ye=u-w*65536,u=Xe+w+65535,w=Math.floor(u/65536),Xe=u-w*65536,u=ot+w+65535,w=Math.floor(u/65536),ot=u-w*65536,u=qe+w+65535,w=Math.floor(u/65536),qe=u-w*65536,u=Ze+w+65535,w=Math.floor(u/65536),Ze=u-w*65536,u=Ne+w+65535,w=Math.floor(u/65536),Ne=u-w*65536,Q+=w-1+37*(w-1),O[0]=Q,O[1]=ae,O[2]=ye,O[3]=Te,O[4]=Le,O[5]=Ie,O[6]=Pt,O[7]=_t,O[8]=nt,O[9]=De,O[10]=Ye,O[11]=Xe,O[12]=ot,O[13]=qe,O[14]=Ze,O[15]=Ne}function B(O,A){j(O,A,A)}function ge(O,A){const I=o();let u;for(u=0;u<16;u++)I[u]=A[u];for(u=253;u>=0;u--)B(I,I),u!==2&&u!==4&&j(I,I,A);for(u=0;u<16;u++)O[u]=I[u]}function te(O,A){const I=o();let u;for(u=0;u<16;u++)I[u]=A[u];for(u=250;u>=0;u--)B(I,I),u!==1&&j(I,I,A);for(u=0;u<16;u++)O[u]=I[u]}function Ee(O,A){const I=o(),u=o(),w=o(),Q=o(),ae=o(),ye=o(),Te=o(),Le=o(),Ie=o();R(I,O[1],O[0]),R(Ie,A[1],A[0]),j(I,I,Ie),he(u,O[0],O[1]),he(Ie,A[0],A[1]),j(u,u,Ie),j(w,O[3],A[3]),j(w,w,S),j(Q,O[2],A[2]),he(Q,Q,Q),R(ae,u,I),R(ye,Q,w),he(Te,Q,w),he(Le,u,I),j(O[0],ae,ye),j(O[1],Le,Te),j(O[2],Te,ye),j(O[3],ae,Le)}function Oe(O,A,I){for(let u=0;u<4;u++)K(O[u],A[u],I)}function tt(O,A){const I=o(),u=o(),w=o();ge(w,A[2]),j(I,A[0],w),j(u,A[1],w),oe(O,u),O[31]^=pe(I)<<7}function C(O,A,I){V(O[0],d),V(O[1],v),V(O[2],v),V(O[3],d);for(let u=255;u>=0;--u){const w=I[u/8|0]>>(u&7)&1;Oe(O,A,w),Ee(A,O),Ee(O,O),Oe(O,A,w)}}function D(O,A){const I=[o(),o(),o(),o()];V(I[0],F),V(I[1],G),V(I[2],v),j(I[3],F,G),C(O,I,A)}function ze(O){if(O.length!==c.SEED_LENGTH)throw new Error(`ed25519: seed must be ${c.SEED_LENGTH} bytes`);const A=(0,i.hash)(O);A[0]&=248,A[31]&=127,A[31]|=64;const I=new Uint8Array(32),u=[o(),o(),o(),o()];D(u,A),tt(I,u);const w=new Uint8Array(64);return w.set(O),w.set(I,32),{publicKey:I,secretKey:w}}c.generateKeyPairFromSeed=ze;function Re(O){const A=(0,r.randomBytes)(32,O),I=ze(A);return(0,n.wipe)(A),I}c.generateKeyPair=Re;function J(O){if(O.length!==c.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${c.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(O.subarray(32))}c.extractPublicKeyFromSecretKey=J;const U=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function z(O,A){let I,u,w,Q;for(u=63;u>=32;--u){for(I=0,w=u-32,Q=u-12;w<Q;++w)A[w]+=I-16*A[u]*U[w-(u-32)],I=Math.floor((A[w]+128)/256),A[w]-=I*256;A[w]+=I,A[u]=0}for(I=0,w=0;w<32;w++)A[w]+=I-(A[31]>>4)*U[w],I=A[w]>>8,A[w]&=255;for(w=0;w<32;w++)A[w]-=I*U[w];for(u=0;u<32;u++)A[u+1]+=A[u]>>8,O[u]=A[u]&255}function k(O){const A=new Float64Array(64);for(let I=0;I<64;I++)A[I]=O[I];for(let I=0;I<64;I++)O[I]=0;z(O,A)}function ut(O,A){const I=new Float64Array(64),u=[o(),o(),o(),o()],w=(0,i.hash)(O.subarray(0,32));w[0]&=248,w[31]&=127,w[31]|=64;const Q=new Uint8Array(64);Q.set(w.subarray(32),32);const ae=new i.SHA512;ae.update(Q.subarray(32)),ae.update(A);const ye=ae.digest();ae.clean(),k(ye),D(u,ye),tt(Q,u),ae.reset(),ae.update(Q.subarray(0,32)),ae.update(O.subarray(32)),ae.update(A);const Te=ae.digest();k(Te);for(let Le=0;Le<32;Le++)I[Le]=ye[Le];for(let Le=0;Le<32;Le++)for(let Ie=0;Ie<32;Ie++)I[Le+Ie]+=Te[Le]*w[Ie];return z(Q.subarray(32),I),Q}c.sign=ut;function He(O,A){const I=o(),u=o(),w=o(),Q=o(),ae=o(),ye=o(),Te=o();return V(O[2],v),ue(O[1],A),B(w,O[1]),j(Q,w,_),R(w,w,O[2]),he(Q,O[2],Q),B(ae,Q),B(ye,ae),j(Te,ye,ae),j(I,Te,w),j(I,I,Q),te(I,I),j(I,I,w),j(I,I,Q),j(I,I,Q),j(O[0],I,Q),B(u,O[0]),j(u,u,Q),de(u,w)&&j(O[0],O[0],W),B(u,O[0]),j(u,u,Q),de(u,w)?-1:(pe(O[0])===A[31]>>7&&R(O[0],d,O[0]),j(O[3],O[0],O[1]),0)}function Mr(O,A,I){const u=new Uint8Array(32),w=[o(),o(),o(),o()],Q=[o(),o(),o(),o()];if(I.length!==c.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${c.SIGNATURE_LENGTH} bytes`);if(He(Q,O))return!1;const ae=new i.SHA512;ae.update(I.subarray(0,32)),ae.update(O),ae.update(A);const ye=ae.digest();return k(ye),C(w,Q,ye),D(Q,I.subarray(32)),Ee(w,Q),tt(u,w),!be(I,u)}c.verify=Mr;function _e(O){let A=[o(),o(),o(),o()];if(He(A,O))throw new Error("Ed25519: invalid public key");let I=o(),u=o(),w=A[1];he(I,v,w),R(u,v,w),ge(u,u),j(I,I,u);let Q=new Uint8Array(32);return oe(Q,I),Q}c.convertPublicKeyToX25519=_e;function St(O){const A=(0,i.hash)(O.subarray(0,32));A[0]&=248,A[31]&=127,A[31]|=64;const I=new Uint8Array(A.subarray(0,32));return(0,n.wipe)(A),I}c.convertSecretKeyToX25519=St})(_c);const $m="EdDSA",Mm="JWT",nf=".",of="base64url",jm="utf8",zm="utf8",qm=":",Um="did",km="key",Wh="base58btc",Hm="z",Km="K36",Vm=32;function co(c){return lo(gc(Bs(c),jm),of)}function af(c){const r=gc(Km,Wh),i=Hm+lo(g1([r,c]),Wh);return[Um,km,i].join(qm)}function Bm(c){return lo(c,of)}function Gm(c){return gc([co(c.header),co(c.payload)].join(nf),zm)}function Wm(c){return[co(c.header),co(c.payload),Bm(c.signature)].join(nf)}function Jh(c=jl.randomBytes(Vm)){return _c.generateKeyPairFromSeed(c)}async function Jm(c,r,i,n,o=ie.fromMiliseconds(Date.now())){const l={alg:$m,typ:Mm},d=af(n.publicKey),v=o+i,_={iss:d,sub:c,aud:r,iat:o,exp:v},S=Gm({header:l,payload:_}),F=_c.sign(n.secretKey,S);return Wm({header:l,payload:_,signature:F})}const Ym="PARSE_ERROR",Xm="INVALID_REQUEST",Zm="METHOD_NOT_FOUND",Qm="INVALID_PARAMS",cf="INTERNAL_ERROR",wc="SERVER_ERROR",e_=[-32700,-32600,-32601,-32602,-32603],Vs={[Ym]:{code:-32700,message:"Parse error"},[Xm]:{code:-32600,message:"Invalid Request"},[Zm]:{code:-32601,message:"Method not found"},[Qm]:{code:-32602,message:"Invalid params"},[cf]:{code:-32603,message:"Internal error"},[wc]:{code:-32e3,message:"Server error"}},uf=wc;function t_(c){return e_.includes(c)}function Yh(c){return Object.keys(Vs).includes(c)?Vs[c]:Vs[uf]}function r_(c){const r=Object.values(Vs).find(i=>i.code===c);return r||Vs[uf]}function hf(c,r,i){return c.message.includes("getaddrinfo ENOTFOUND")||c.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${i} RPC url at ${r}`):c}var lf={},si={},Xh;function i_(){if(Xh)return si;Xh=1,Object.defineProperty(si,"__esModule",{value:!0}),si.isBrowserCryptoAvailable=si.getSubtleCrypto=si.getBrowerCrypto=void 0;function c(){return(gr===null||gr===void 0?void 0:gr.crypto)||(gr===null||gr===void 0?void 0:gr.msCrypto)||{}}si.getBrowerCrypto=c;function r(){const n=c();return n.subtle||n.webkitSubtle}si.getSubtleCrypto=r;function i(){return!!c()&&!!r()}return si.isBrowserCryptoAvailable=i,si}var ni={},Zh;function s_(){if(Zh)return ni;Zh=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.isBrowser=ni.isNode=ni.isReactNative=void 0;function c(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}ni.isReactNative=c;function r(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}ni.isNode=r;function i(){return!c()&&!r()}return ni.isBrowser=i,ni}(function(c){Object.defineProperty(c,"__esModule",{value:!0});const r=bi;r.__exportStar(i_(),c),r.__exportStar(s_(),c)})(lf);function ff(c=3){const r=Date.now()*Math.pow(10,c),i=Math.floor(Math.random()*Math.pow(10,c));return r+i}function bc(c=6){return BigInt(ff(c))}function go(c,r,i){return{id:i||ff(),jsonrpc:"2.0",method:c,params:r}}function Ec(c,r){return{id:c,jsonrpc:"2.0",result:r}}function vo(c,r,i){return{id:c,jsonrpc:"2.0",error:n_(r,i)}}function n_(c,r){return typeof c>"u"?Yh(cf):(typeof c=="string"&&(c=Object.assign(Object.assign({},Yh(wc)),{message:c})),typeof r<"u"&&(c.data=r),t_(c.code)&&(c=r_(c.code)),c)}class o_{}class a_ extends o_{constructor(){super()}}class c_ extends a_{constructor(r){super()}}const u_="^https?:",h_="^wss?:";function l_(c){const r=c.match(new RegExp(/^\w+:/,"gi"));if(!(!r||!r.length))return r[0]}function pf(c,r){const i=l_(c);return typeof i>"u"?!1:new RegExp(r).test(i)}function Qh(c){return pf(c,u_)}function el(c){return pf(c,h_)}function f_(c){return new RegExp("wss?://localhost(:d{2,5})?").test(c)}function df(c){return typeof c=="object"&&"id"in c&&"jsonrpc"in c&&c.jsonrpc==="2.0"}function xc(c){return df(c)&&"method"in c}function yo(c){return df(c)&&(oi(c)||$r(c))}function oi(c){return"result"in c}function $r(c){return"error"in c}class Ei extends c_{constructor(r){super(r),this.events=new vr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(r),this.connection.connected&&this.registerEventListeners()}async connect(r=this.connection){await this.open(r)}async disconnect(){await this.close()}on(r,i){this.events.on(r,i)}once(r,i){this.events.once(r,i)}off(r,i){this.events.off(r,i)}removeListener(r,i){this.events.removeListener(r,i)}async request(r,i){return this.requestStrict(go(r.method,r.params||[],r.id||bc().toString()),i)}async requestStrict(r,i){return new Promise(async(n,o)=>{if(!this.connection.connected)try{await this.open()}catch(l){o(l)}this.events.on(`${r.id}`,l=>{$r(l)?o(l.error):n(l.result)});try{await this.connection.send(r,i)}catch(l){o(l)}})}setConnection(r=this.connection){return r}onPayload(r){this.events.emit("payload",r),yo(r)?this.events.emit(`${r.id}`,r):this.events.emit("message",{type:r.method,data:r.params})}onClose(r){r&&r.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${r.code} ${r.reason?`(${r.reason})`:""}`)),this.events.emit("disconnect")}async open(r=this.connection){this.connection===r&&this.connection.connected||(this.connection.connected&&this.close(),typeof r=="string"&&(await this.connection.open(r),r=this.connection),this.connection=this.setConnection(r),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",r=>this.onPayload(r)),this.connection.on("close",r=>this.onClose(r)),this.connection.on("error",r=>this.events.emit("error",r)),this.connection.on("register_error",r=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const p_=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),d_=()=>typeof window<"u",tl=c=>c.split("?")[0],rl=10,g_=p_();class v_{constructor(r){if(this.url=r,this.events=new vr.EventEmitter,this.registering=!1,!el(r))throw new Error(`Provided URL is not compatible with WebSocket connection: ${r}`);this.url=r}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(r,i){this.events.on(r,i)}once(r,i){this.events.once(r,i)}off(r,i){this.events.off(r,i)}removeListener(r,i){this.events.removeListener(r,i)}async open(r=this.url){await this.register(r)}async close(){return new Promise((r,i)=>{if(typeof this.socket>"u"){i(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),r()},this.socket.close()})}async send(r,i){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Bs(r))}catch(n){this.onError(r.id,n)}}register(r=this.url){if(!el(r))throw new Error(`Provided URL is not compatible with WebSocket connection: ${r}`);if(this.registering){const i=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=i||this.events.listenerCount("open")>=i)&&this.events.setMaxListeners(i+1),new Promise((n,o)=>{this.events.once("register_error",l=>{this.resetMaxListeners(),o(l)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=r,this.registering=!0,new Promise((i,n)=>{const o=lf.isReactNative()?void 0:{rejectUnauthorized:!f_(r)},l=new g_(r,[],o);d_()?l.onerror=d=>{const v=d;n(this.emitError(v.error))}:l.on("error",d=>{n(this.emitError(d))}),l.onopen=()=>{this.onOpen(l),i(l)}})}onOpen(r){r.onmessage=i=>this.onPayload(i),r.onclose=i=>this.onClose(i),this.socket=r,this.registering=!1,this.events.emit("open")}onClose(r){this.socket=void 0,this.registering=!1,this.events.emit("close",r)}onPayload(r){if(typeof r.data>"u")return;const i=typeof r.data=="string"?mc(r.data):r.data;this.events.emit("payload",i)}onError(r,i){const n=this.parseError(i),o=n.message||n.toString(),l=vo(r,o);this.events.emit("payload",l)}parseError(r,i=this.url){return hf(r,tl(i),"WS")}resetMaxListeners(){this.events.getMaxListeners()>rl&&this.events.setMaxListeners(rl)}emitError(r){const i=this.parseError(new Error((r==null?void 0:r.message)||`WebSocket connection failed for host: ${tl(this.url)}`));return this.events.emit("register_error",i),i}}var uo={exports:{}};uo.exports;(function(c,r){var i=200,n="__lodash_hash_undefined__",o=1,l=2,d=9007199254740991,v="[object Arguments]",_="[object Array]",S="[object AsyncFunction]",F="[object Boolean]",G="[object Date]",W="[object Error]",V="[object Function]",q="[object GeneratorFunction]",K="[object Map]",oe="[object Number]",be="[object Null]",de="[object Object]",pe="[object Promise]",ue="[object Proxy]",he="[object RegExp]",R="[object Set]",j="[object String]",B="[object Symbol]",ge="[object Undefined]",te="[object WeakMap]",Ee="[object ArrayBuffer]",Oe="[object DataView]",tt="[object Float32Array]",C="[object Float64Array]",D="[object Int8Array]",ze="[object Int16Array]",Re="[object Int32Array]",J="[object Uint8Array]",U="[object Uint8ClampedArray]",z="[object Uint16Array]",k="[object Uint32Array]",ut=/[\\^$.*+?()[\]{}|]/g,He=/^\[object .+?Constructor\]$/,Mr=/^(?:0|[1-9]\d*)$/,_e={};_e[tt]=_e[C]=_e[D]=_e[ze]=_e[Re]=_e[J]=_e[U]=_e[z]=_e[k]=!0,_e[v]=_e[_]=_e[Ee]=_e[F]=_e[Oe]=_e[G]=_e[W]=_e[V]=_e[K]=_e[oe]=_e[de]=_e[he]=_e[R]=_e[j]=_e[te]=!1;var St=typeof gr=="object"&&gr&&gr.Object===Object&&gr,O=typeof self=="object"&&self&&self.Object===Object&&self,A=St||O||Function("return this")(),I=r&&!r.nodeType&&r,u=I&&!0&&c&&!c.nodeType&&c,w=u&&u.exports===I,Q=w&&St.process,ae=function(){try{return Q&&Q.binding&&Q.binding("util")}catch{}}(),ye=ae&&ae.isTypedArray;function Te(g,b){for(var $=-1,Y=g==null?0:g.length,Be=0,le=[];++$<Y;){var Qe=g[$];b(Qe,$,g)&&(le[Be++]=Qe)}return le}function Le(g,b){for(var $=-1,Y=b.length,Be=g.length;++$<Y;)g[Be+$]=b[$];return g}function Ie(g,b){for(var $=-1,Y=g==null?0:g.length;++$<Y;)if(b(g[$],$,g))return!0;return!1}function Pt(g,b){for(var $=-1,Y=Array(g);++$<g;)Y[$]=b($);return Y}function _t(g){return function(b){return g(b)}}function nt(g,b){return g.has(b)}function De(g,b){return g==null?void 0:g[b]}function Ye(g){var b=-1,$=Array(g.size);return g.forEach(function(Y,Be){$[++b]=[Be,Y]}),$}function Xe(g,b){return function($){return g(b($))}}function ot(g){var b=-1,$=Array(g.size);return g.forEach(function(Y){$[++b]=Y}),$}var qe=Array.prototype,Ze=Function.prototype,Ne=Object.prototype,Ke=A["__core-js_shared__"],ht=Ze.toString,Me=Ne.hasOwnProperty,Ct=function(){var g=/[^.]+$/.exec(Ke&&Ke.keys&&Ke.keys.IE_PROTO||"");return g?"Symbol(src)_1."+g:""}(),$t=Ne.toString,kt=RegExp("^"+ht.call(Me).replace(ut,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ht=w?A.Buffer:void 0,zt=A.Symbol,Wt=A.Uint8Array,rr=Ne.propertyIsEnumerable,jr=qe.splice,Jt=zt?zt.toStringTag:void 0,Br=Object.getOwnPropertySymbols,ai=Ht?Ht.isBuffer:void 0,Ii=Xe(Object.keys,Object),lt=ur(A,"DataView"),rt=ur(A,"Map"),ft=ur(A,"Promise"),pt=ur(A,"Set"),at=ur(A,"WeakMap"),it=ur(Object,"create"),At=Wr(lt),Ot=Wr(rt),dt=Wr(ft),Rt=Wr(pt),gt=Wr(at),wt=zt?zt.prototype:void 0,vt=wt?wt.valueOf:void 0;function Je(g){var b=-1,$=g==null?0:g.length;for(this.clear();++b<$;){var Y=g[b];this.set(Y[0],Y[1])}}function Tt(){this.__data__=it?it(null):{},this.size=0}function Nt(g){var b=this.has(g)&&delete this.__data__[g];return this.size-=b?1:0,b}function wo(g){var b=this.__data__;if(it){var $=b[g];return $===n?void 0:$}return Me.call(b,g)?b[g]:void 0}function bo(g){var b=this.__data__;return it?b[g]!==void 0:Me.call(b,g)}function Eo(g,b){var $=this.__data__;return this.size+=this.has(g)?0:1,$[g]=it&&b===void 0?n:b,this}Je.prototype.clear=Tt,Je.prototype.delete=Nt,Je.prototype.get=wo,Je.prototype.has=bo,Je.prototype.set=Eo;function yr(g){var b=-1,$=g==null?0:g.length;for(this.clear();++b<$;){var Y=g[b];this.set(Y[0],Y[1])}}function xo(){this.__data__=[],this.size=0}function Io(g){var b=this.__data__,$=Si(b,g);if($<0)return!1;var Y=b.length-1;return $==Y?b.pop():jr.call(b,$,1),--this.size,!0}function So(g){var b=this.__data__,$=Si(b,g);return $<0?void 0:b[$][1]}function Po(g){return Si(this.__data__,g)>-1}function Co(g,b){var $=this.__data__,Y=Si($,g);return Y<0?(++this.size,$.push([g,b])):$[Y][1]=b,this}yr.prototype.clear=xo,yr.prototype.delete=Io,yr.prototype.get=So,yr.prototype.has=Po,yr.prototype.set=Co;function Gr(g){var b=-1,$=g==null?0:g.length;for(this.clear();++b<$;){var Y=g[b];this.set(Y[0],Y[1])}}function ki(){this.size=0,this.__data__={hash:new Je,map:new(rt||yr),string:new Je}}function Ao(g){var b=ci(this,g).delete(g);return this.size-=b?1:0,b}function Hi(g){return ci(this,g).get(g)}function Oo(g){return ci(this,g).has(g)}function Ro(g,b){var $=ci(this,g),Y=$.size;return $.set(g,b),this.size+=$.size==Y?0:1,this}Gr.prototype.clear=ki,Gr.prototype.delete=Ao,Gr.prototype.get=Hi,Gr.prototype.has=Oo,Gr.prototype.set=Ro;function Ki(g){var b=-1,$=g==null?0:g.length;for(this.__data__=new Gr;++b<$;)this.add(g[b])}function Js(g){return this.__data__.set(g,n),this}function Ys(g){return this.__data__.has(g)}Ki.prototype.add=Ki.prototype.push=Js,Ki.prototype.has=Ys;function Or(g){var b=this.__data__=new yr(g);this.size=b.size}function To(){this.__data__=new yr,this.size=0}function No(g){var b=this.__data__,$=b.delete(g);return this.size=b.size,$}function Lo(g){return this.__data__.get(g)}function Fo(g){return this.__data__.has(g)}function Xs(g,b){var $=this.__data__;if($ instanceof yr){var Y=$.__data__;if(!rt||Y.length<i-1)return Y.push([g,b]),this.size=++$.size,this;$=this.__data__=new Gr(Y)}return $.set(g,b),this.size=$.size,this}Or.prototype.clear=To,Or.prototype.delete=No,Or.prototype.get=Lo,Or.prototype.has=Fo,Or.prototype.set=Xs;function Zs(g,b){var $=Gi(g),Y=!$&&ln(g),Be=!$&&!Y&&ys(g),le=!$&&!Y&&!Be&&dn(g),Qe=$||Y||Be||le,Lt=Qe?Pt(g.length,String):[],Pe=Lt.length;for(var Ge in g)(b||Me.call(g,Ge))&&!(Qe&&(Ge=="length"||Be&&(Ge=="offset"||Ge=="parent")||le&&(Ge=="buffer"||Ge=="byteLength"||Ge=="byteOffset")||on(Ge,Pe)))&&Lt.push(Ge);return Lt}function Si(g,b){for(var $=g.length;$--;)if(hn(g[$][0],b))return $;return-1}function gs(g,b,$){var Y=b(g);return Gi(g)?Y:Le(Y,$(g))}function Pi(g){return g==null?g===void 0?ge:be:Jt&&Jt in Object(g)?sn(g):Mo(g)}function vs(g){return Ai(g)&&Pi(g)==v}function Ci(g,b,$,Y,Be){return g===b?!0:g==null||b==null||!Ai(g)&&!Ai(b)?g!==g&&b!==b:Qs(g,b,$,Y,Ci,Be)}function Qs(g,b,$,Y,Be,le){var Qe=Gi(g),Lt=Gi(b),Pe=Qe?_:zr(g),Ge=Lt?_:zr(b);Pe=Pe==v?de:Pe,Ge=Ge==v?de:Ge;var bt=Pe==de,ir=Ge==de,Ft=Pe==Ge;if(Ft&&ys(g)){if(!ys(b))return!1;Qe=!0,bt=!1}if(Ft&&!bt)return le||(le=new Or),Qe||dn(g)?Vi(g,b,$,Y,Be,le):$o(g,b,Pe,$,Y,Be,le);if(!($&o)){var et=bt&&Me.call(g,"__wrapped__"),Yt=ir&&Me.call(b,"__wrapped__");if(et||Yt){var Rr=et?g.value():g,mr=Yt?b.value():b;return le||(le=new Or),Be(Rr,mr,$,Y,le)}}return Ft?(le||(le=new Or),rn(g,b,$,Y,Be,le)):!1}function Do(g){if(!pn(g)||cn(g))return!1;var b=Wi(g)?kt:He;return b.test(Wr(g))}function en(g){return Ai(g)&&fn(g.length)&&!!_e[Pi(g)]}function tn(g){if(!un(g))return Ii(g);var b=[];for(var $ in Object(g))Me.call(g,$)&&$!="constructor"&&b.push($);return b}function Vi(g,b,$,Y,Be,le){var Qe=$&o,Lt=g.length,Pe=b.length;if(Lt!=Pe&&!(Qe&&Pe>Lt))return!1;var Ge=le.get(g);if(Ge&&le.get(b))return Ge==b;var bt=-1,ir=!0,Ft=$&l?new Ki:void 0;for(le.set(g,b),le.set(b,g);++bt<Lt;){var et=g[bt],Yt=b[bt];if(Y)var Rr=Qe?Y(Yt,et,bt,b,g,le):Y(et,Yt,bt,g,b,le);if(Rr!==void 0){if(Rr)continue;ir=!1;break}if(Ft){if(!Ie(b,function(mr,qr){if(!nt(Ft,qr)&&(et===mr||Be(et,mr,$,Y,le)))return Ft.push(qr)})){ir=!1;break}}else if(!(et===Yt||Be(et,Yt,$,Y,le))){ir=!1;break}}return le.delete(g),le.delete(b),ir}function $o(g,b,$,Y,Be,le,Qe){switch($){case Oe:if(g.byteLength!=b.byteLength||g.byteOffset!=b.byteOffset)return!1;g=g.buffer,b=b.buffer;case Ee:return!(g.byteLength!=b.byteLength||!le(new Wt(g),new Wt(b)));case F:case G:case oe:return hn(+g,+b);case W:return g.name==b.name&&g.message==b.message;case he:case j:return g==b+"";case K:var Lt=Ye;case R:var Pe=Y&o;if(Lt||(Lt=ot),g.size!=b.size&&!Pe)return!1;var Ge=Qe.get(g);if(Ge)return Ge==b;Y|=l,Qe.set(g,b);var bt=Vi(Lt(g),Lt(b),Y,Be,le,Qe);return Qe.delete(g),bt;case B:if(vt)return vt.call(g)==vt.call(b)}return!1}function rn(g,b,$,Y,Be,le){var Qe=$&o,Lt=Bi(g),Pe=Lt.length,Ge=Bi(b),bt=Ge.length;if(Pe!=bt&&!Qe)return!1;for(var ir=Pe;ir--;){var Ft=Lt[ir];if(!(Qe?Ft in b:Me.call(b,Ft)))return!1}var et=le.get(g);if(et&&le.get(b))return et==b;var Yt=!0;le.set(g,b),le.set(b,g);for(var Rr=Qe;++ir<Pe;){Ft=Lt[ir];var mr=g[Ft],qr=b[Ft];if(Y)var ms=Qe?Y(qr,mr,Ft,b,g,le):Y(mr,qr,Ft,g,b,le);if(!(ms===void 0?mr===qr||Be(mr,qr,$,Y,le):ms)){Yt=!1;break}Rr||(Rr=Ft=="constructor")}if(Yt&&!Rr){var Oi=g.constructor,qt=b.constructor;Oi!=qt&&"constructor"in g&&"constructor"in b&&!(typeof Oi=="function"&&Oi instanceof Oi&&typeof qt=="function"&&qt instanceof qt)&&(Yt=!1)}return le.delete(g),le.delete(b),Yt}function Bi(g){return gs(g,qo,nn)}function ci(g,b){var $=g.__data__;return an(b)?$[typeof b=="string"?"string":"hash"]:$.map}function ur(g,b){var $=De(g,b);return Do($)?$:void 0}function sn(g){var b=Me.call(g,Jt),$=g[Jt];try{g[Jt]=void 0;var Y=!0}catch{}var Be=$t.call(g);return Y&&(b?g[Jt]=$:delete g[Jt]),Be}var nn=Br?function(g){return g==null?[]:(g=Object(g),Te(Br(g),function(b){return rr.call(g,b)}))}:Ve,zr=Pi;(lt&&zr(new lt(new ArrayBuffer(1)))!=Oe||rt&&zr(new rt)!=K||ft&&zr(ft.resolve())!=pe||pt&&zr(new pt)!=R||at&&zr(new at)!=te)&&(zr=function(g){var b=Pi(g),$=b==de?g.constructor:void 0,Y=$?Wr($):"";if(Y)switch(Y){case At:return Oe;case Ot:return K;case dt:return pe;case Rt:return R;case gt:return te}return b});function on(g,b){return b=b??d,!!b&&(typeof g=="number"||Mr.test(g))&&g>-1&&g%1==0&&g<b}function an(g){var b=typeof g;return b=="string"||b=="number"||b=="symbol"||b=="boolean"?g!=="__proto__":g===null}function cn(g){return!!Ct&&Ct in g}function un(g){var b=g&&g.constructor,$=typeof b=="function"&&b.prototype||Ne;return g===$}function Mo(g){return $t.call(g)}function Wr(g){if(g!=null){try{return ht.call(g)}catch{}try{return g+""}catch{}}return""}function hn(g,b){return g===b||g!==g&&b!==b}var ln=vs(function(){return arguments}())?vs:function(g){return Ai(g)&&Me.call(g,"callee")&&!rr.call(g,"callee")},Gi=Array.isArray;function jo(g){return g!=null&&fn(g.length)&&!Wi(g)}var ys=ai||Ue;function zo(g,b){return Ci(g,b)}function Wi(g){if(!pn(g))return!1;var b=Pi(g);return b==V||b==q||b==S||b==ue}function fn(g){return typeof g=="number"&&g>-1&&g%1==0&&g<=d}function pn(g){var b=typeof g;return g!=null&&(b=="object"||b=="function")}function Ai(g){return g!=null&&typeof g=="object"}var dn=ye?_t(ye):en;function qo(g){return jo(g)?Zs(g):tn(g)}function Ve(){return[]}function Ue(){return!1}c.exports=zo})(uo,uo.exports);var y_=uo.exports;const m_=dc(y_);function __(c,r){if(c.length>=255)throw new TypeError("Alphabet too long");for(var i=new Uint8Array(256),n=0;n<i.length;n++)i[n]=255;for(var o=0;o<c.length;o++){var l=c.charAt(o),d=l.charCodeAt(0);if(i[d]!==255)throw new TypeError(l+" is ambiguous");i[d]=o}var v=c.length,_=c.charAt(0),S=Math.log(v)/Math.log(256),F=Math.log(256)/Math.log(v);function G(q){if(q instanceof Uint8Array||(ArrayBuffer.isView(q)?q=new Uint8Array(q.buffer,q.byteOffset,q.byteLength):Array.isArray(q)&&(q=Uint8Array.from(q))),!(q instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(q.length===0)return"";for(var K=0,oe=0,be=0,de=q.length;be!==de&&q[be]===0;)be++,K++;for(var pe=(de-be)*F+1>>>0,ue=new Uint8Array(pe);be!==de;){for(var he=q[be],R=0,j=pe-1;(he!==0||R<oe)&&j!==-1;j--,R++)he+=256*ue[j]>>>0,ue[j]=he%v>>>0,he=he/v>>>0;if(he!==0)throw new Error("Non-zero carry");oe=R,be++}for(var B=pe-oe;B!==pe&&ue[B]===0;)B++;for(var ge=_.repeat(K);B<pe;++B)ge+=c.charAt(ue[B]);return ge}function W(q){if(typeof q!="string")throw new TypeError("Expected String");if(q.length===0)return new Uint8Array;var K=0;if(q[K]!==" "){for(var oe=0,be=0;q[K]===_;)oe++,K++;for(var de=(q.length-K)*S+1>>>0,pe=new Uint8Array(de);q[K];){var ue=i[q.charCodeAt(K)];if(ue===255)return;for(var he=0,R=de-1;(ue!==0||he<be)&&R!==-1;R--,he++)ue+=v*pe[R]>>>0,pe[R]=ue%256>>>0,ue=ue/256>>>0;if(ue!==0)throw new Error("Non-zero carry");be=he,K++}if(q[K]!==" "){for(var j=de-be;j!==de&&pe[j]===0;)j++;for(var B=new Uint8Array(oe+(de-j)),ge=oe;j!==de;)B[ge++]=pe[j++];return B}}}function V(q){var K=W(q);if(K)return K;throw new Error(`Non-${r} character`)}return{encode:G,decodeUnsafe:W,decode:V}}var w_=__,b_=w_;const gf=c=>{if(c instanceof Uint8Array&&c.constructor.name==="Uint8Array")return c;if(c instanceof ArrayBuffer)return new Uint8Array(c);if(ArrayBuffer.isView(c))return new Uint8Array(c.buffer,c.byteOffset,c.byteLength);throw new Error("Unknown type, must be binary type")},E_=c=>new TextEncoder().encode(c),x_=c=>new TextDecoder().decode(c);class I_{constructor(r,i,n){this.name=r,this.prefix=i,this.baseEncode=n}encode(r){if(r instanceof Uint8Array)return`${this.prefix}${this.baseEncode(r)}`;throw Error("Unknown type, must be binary type")}}class S_{constructor(r,i,n){if(this.name=r,this.prefix=i,i.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=i.codePointAt(0),this.baseDecode=n}decode(r){if(typeof r=="string"){if(r.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(r)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(r.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(r){return vf(this,r)}}class P_{constructor(r){this.decoders=r}or(r){return vf(this,r)}decode(r){const i=r[0],n=this.decoders[i];if(n)return n.decode(r);throw RangeError(`Unable to decode multibase string ${JSON.stringify(r)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const vf=(c,r)=>new P_({...c.decoders||{[c.prefix]:c},...r.decoders||{[r.prefix]:r}});class C_{constructor(r,i,n,o){this.name=r,this.prefix=i,this.baseEncode=n,this.baseDecode=o,this.encoder=new I_(r,i,n),this.decoder=new S_(r,i,o)}encode(r){return this.encoder.encode(r)}decode(r){return this.decoder.decode(r)}}const mo=({name:c,prefix:r,encode:i,decode:n})=>new C_(c,r,i,n),Ws=({prefix:c,name:r,alphabet:i})=>{const{encode:n,decode:o}=b_(i,r);return mo({prefix:c,name:r,encode:n,decode:l=>gf(o(l))})},A_=(c,r,i,n)=>{const o={};for(let F=0;F<r.length;++F)o[r[F]]=F;let l=c.length;for(;c[l-1]==="=";)--l;const d=new Uint8Array(l*i/8|0);let v=0,_=0,S=0;for(let F=0;F<l;++F){const G=o[c[F]];if(G===void 0)throw new SyntaxError(`Non-${n} character`);_=_<<i|G,v+=i,v>=8&&(v-=8,d[S++]=255&_>>v)}if(v>=i||255&_<<8-v)throw new SyntaxError("Unexpected end of data");return d},O_=(c,r,i)=>{const n=r[r.length-1]==="=",o=(1<<i)-1;let l="",d=0,v=0;for(let _=0;_<c.length;++_)for(v=v<<8|c[_],d+=8;d>i;)d-=i,l+=r[o&v>>d];if(d&&(l+=r[o&v<<i-d]),n)for(;l.length*i&7;)l+="=";return l},Vt=({name:c,prefix:r,bitsPerChar:i,alphabet:n})=>mo({prefix:r,name:c,encode(o){return O_(o,n,i)},decode(o){return A_(o,n,i,c)}}),R_=mo({prefix:"\0",name:"identity",encode:c=>x_(c),decode:c=>E_(c)});var T_=Object.freeze({__proto__:null,identity:R_});const N_=Vt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var L_=Object.freeze({__proto__:null,base2:N_});const F_=Vt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var D_=Object.freeze({__proto__:null,base8:F_});const $_=Ws({prefix:"9",name:"base10",alphabet:"0123456789"});var M_=Object.freeze({__proto__:null,base10:$_});const j_=Vt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),z_=Vt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var q_=Object.freeze({__proto__:null,base16:j_,base16upper:z_});const U_=Vt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),k_=Vt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),H_=Vt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),K_=Vt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),V_=Vt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),B_=Vt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),G_=Vt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),W_=Vt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),J_=Vt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Y_=Object.freeze({__proto__:null,base32:U_,base32upper:k_,base32pad:H_,base32padupper:K_,base32hex:V_,base32hexupper:B_,base32hexpad:G_,base32hexpadupper:W_,base32z:J_});const X_=Ws({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Z_=Ws({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Q_=Object.freeze({__proto__:null,base36:X_,base36upper:Z_});const ew=Ws({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),tw=Ws({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var rw=Object.freeze({__proto__:null,base58btc:ew,base58flickr:tw});const iw=Vt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),sw=Vt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),nw=Vt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),ow=Vt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var aw=Object.freeze({__proto__:null,base64:iw,base64pad:sw,base64url:nw,base64urlpad:ow});const yf=Array.from(""),cw=yf.reduce((c,r,i)=>(c[i]=r,c),[]),uw=yf.reduce((c,r,i)=>(c[r.codePointAt(0)]=i,c),[]);function hw(c){return c.reduce((r,i)=>(r+=cw[i],r),"")}function lw(c){const r=[];for(const i of c){const n=uw[i.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${i}`);r.push(n)}return new Uint8Array(r)}const fw=mo({prefix:"",name:"base256emoji",encode:hw,decode:lw});var pw=Object.freeze({__proto__:null,base256emoji:fw}),dw=mf,il=128,gw=127,vw=~gw,yw=Math.pow(2,31);function mf(c,r,i){r=r||[],i=i||0;for(var n=i;c>=yw;)r[i++]=c&255|il,c/=128;for(;c&vw;)r[i++]=c&255|il,c>>>=7;return r[i]=c|0,mf.bytes=i-n+1,r}var mw=cc,_w=128,sl=127;function cc(c,n){var i=0,n=n||0,o=0,l=n,d,v=c.length;do{if(l>=v)throw cc.bytes=0,new RangeError("Could not decode varint");d=c[l++],i+=o<28?(d&sl)<<o:(d&sl)*Math.pow(2,o),o+=7}while(d>=_w);return cc.bytes=l-n,i}var ww=Math.pow(2,7),bw=Math.pow(2,14),Ew=Math.pow(2,21),xw=Math.pow(2,28),Iw=Math.pow(2,35),Sw=Math.pow(2,42),Pw=Math.pow(2,49),Cw=Math.pow(2,56),Aw=Math.pow(2,63),Ow=function(c){return c<ww?1:c<bw?2:c<Ew?3:c<xw?4:c<Iw?5:c<Sw?6:c<Pw?7:c<Cw?8:c<Aw?9:10},Rw={encode:dw,decode:mw,encodingLength:Ow},_f=Rw;const nl=(c,r,i=0)=>(_f.encode(c,r,i),r),ol=c=>_f.encodingLength(c),uc=(c,r)=>{const i=r.byteLength,n=ol(c),o=n+ol(i),l=new Uint8Array(o+i);return nl(c,l,0),nl(i,l,n),l.set(r,o),new Tw(c,i,r,l)};class Tw{constructor(r,i,n,o){this.code=r,this.size=i,this.digest=n,this.bytes=o}}const wf=({name:c,code:r,encode:i})=>new Nw(c,r,i);class Nw{constructor(r,i,n){this.name=r,this.code=i,this.encode=n}digest(r){if(r instanceof Uint8Array){const i=this.encode(r);return i instanceof Uint8Array?uc(this.code,i):i.then(n=>uc(this.code,n))}else throw Error("Unknown type, must be binary type")}}const bf=c=>async r=>new Uint8Array(await crypto.subtle.digest(c,r)),Lw=wf({name:"sha2-256",code:18,encode:bf("SHA-256")}),Fw=wf({name:"sha2-512",code:19,encode:bf("SHA-512")});var Dw=Object.freeze({__proto__:null,sha256:Lw,sha512:Fw});const Ef=0,$w="identity",xf=gf,Mw=c=>uc(Ef,xf(c)),jw={code:Ef,name:$w,encode:xf,digest:Mw};var zw=Object.freeze({__proto__:null,identity:jw});new TextEncoder,new TextDecoder;const al={...T_,...L_,...D_,...M_,...q_,...Y_,...Q_,...rw,...aw,...pw};({...Dw,...zw});function If(c){return globalThis.Buffer!=null?new Uint8Array(c.buffer,c.byteOffset,c.byteLength):c}function qw(c=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?If(globalThis.Buffer.allocUnsafe(c)):new Uint8Array(c)}function Sf(c,r,i,n){return{name:c,prefix:r,encoder:{name:c,prefix:r,encode:i},decoder:{decode:n}}}const cl=Sf("utf8","u",c=>"u"+new TextDecoder("utf8").decode(c),c=>new TextEncoder().encode(c.substring(1))),Xa=Sf("ascii","a",c=>{let r="a";for(let i=0;i<c.length;i++)r+=String.fromCharCode(c[i]);return r},c=>{c=c.substring(1);const r=qw(c.length);for(let i=0;i<c.length;i++)r[i]=c.charCodeAt(i);return r}),Uw={utf8:cl,"utf-8":cl,hex:al.base16,latin1:Xa,ascii:Xa,binary:Xa,...al};function kw(c,r="utf8"){const i=Uw[r];if(!i)throw new Error(`Unsupported encoding "${r}"`);return(r==="utf8"||r==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?If(globalThis.Buffer.from(c,"utf-8")):i.decoder.decode(`${i.prefix}${c}`)}const Pf="wc",Hw=2,Ic="core",wi=`${Pf}@2:${Ic}:`,Kw={name:Ic,logger:"error"},Vw={database:":memory:"},Bw="crypto",ul="client_ed25519_seed",Gw=ie.ONE_DAY,Ww="keychain",Jw="0.3",Yw="messages",Xw="0.3",Zw=ie.SIX_HOURS,Qw="publisher",Cf="irn",eb="error",Af="wss://relay.walletconnect.com",hl="wss://relay.walletconnect.org",tb="relayer",mt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},rb="_subscription",zs={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},ib=ie.ONE_SECOND/2,sb="2.9.0",nb=1e4,ob="0.3",ab="WALLETCONNECT_CLIENT_ID",Vr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},cb="subscription",ub="0.3",hb=ie.FIVE_SECONDS*1e3,lb="pairing",fb="0.3",qs={wc_pairingDelete:{req:{ttl:ie.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ie.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ie.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ie.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ie.ONE_DAY,prompt:!1,tag:0},res:{ttl:ie.ONE_DAY,prompt:!1,tag:0}}},Kr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},pb="history",db="0.3",gb="expirer",Cr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},vb="0.3",Za="verify-api",ll="https://verify.walletconnect.com";class yb{constructor(r,i){this.core=r,this.logger=i,this.keychain=new Map,this.name=Ww,this.version=Jw,this.initialized=!1,this.storagePrefix=wi,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,o)=>{this.isInitialized(),this.keychain.set(n,o),await this.persist()},this.get=n=>{this.isInitialized();const o=this.keychain.get(n);if(typeof o>"u"){const{message:l}=Z("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(l)}return o},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=r,this.logger=Ae.generateChildLogger(i,this.name)}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(r){await this.core.storage.setItem(this.storageKey,kl(r))}async getKeyChain(){const r=await this.core.storage.getItem(this.storageKey);return typeof r<"u"?Hl(r):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:r}=Z("NOT_INITIALIZED",this.name);throw new Error(r)}}}class mb{constructor(r,i,n){this.core=r,this.logger=i,this.name=Bw,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),l=Jh(o);return af(l.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=m1();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const l=await this.getClientSeed(),d=Jh(l),v=oc();return await Jm(v,o,Gw,d)},this.generateSharedKey=(o,l,d)=>{this.isInitialized();const v=this.getPrivateKey(o),_=_1(v,l);return this.setSymKey(_,d)},this.setSymKey=async(o,l)=>{this.isInitialized();const d=l||w1(o);return await this.keychain.set(d,o),d},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,l,d)=>{this.isInitialized();const v=b1(d),_=Bs(l);if(Ah(v)){const W=v.senderPublicKey,V=v.receiverPublicKey;o=await this.generateSharedKey(W,V)}const S=this.getSymKey(o),{type:F,senderPublicKey:G}=v;return E1({type:F,symKey:S,message:_,senderPublicKey:G})},this.decode=async(o,l,d)=>{this.isInitialized();const v=x1(l,d);if(Ah(v)){const F=v.receiverPublicKey,G=v.senderPublicKey;o=await this.generateSharedKey(F,G)}const _=this.getSymKey(o),S=I1({symKey:_,encoded:l});return mc(S)},this.getPayloadType=o=>{const l=Oh(o);return S1(l.type)},this.getPayloadSenderPublicKey=o=>{const l=Oh(o);return l.senderPublicKey?lo(l.senderPublicKey,P1):void 0},this.core=r,this.logger=Ae.generateChildLogger(i,this.name),this.keychain=n||new yb(this.core,this.logger)}get context(){return Ae.getLoggerContext(this.logger)}async setPrivateKey(r,i){return await this.keychain.set(r,i),r}getPrivateKey(r){return this.keychain.get(r)}async getClientSeed(){let r="";try{r=this.keychain.get(ul)}catch{r=oc(),await this.keychain.set(ul,r)}return kw(r,"base16")}getSymKey(r){return this.keychain.get(r)}isInitialized(){if(!this.initialized){const{message:r}=Z("NOT_INITIALIZED",this.name);throw new Error(r)}}}class _b extends Sm{constructor(r,i){super(r,i),this.logger=r,this.core=i,this.messages=new Map,this.name=Yw,this.version=Xw,this.initialized=!1,this.storagePrefix=wi,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,o)=>{this.isInitialized();const l=ls(o);let d=this.messages.get(n);return typeof d>"u"&&(d={}),typeof d[l]<"u"||(d[l]=o,this.messages.set(n,d),await this.persist()),l},this.get=n=>{this.isInitialized();let o=this.messages.get(n);return typeof o>"u"&&(o={}),o},this.has=(n,o)=>{this.isInitialized();const l=this.get(n),d=ls(o);return typeof l[d]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=Ae.generateChildLogger(r,this.name),this.core=i}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(r){await this.core.storage.setItem(this.storageKey,kl(r))}async getRelayerMessages(){const r=await this.core.storage.getItem(this.storageKey);return typeof r<"u"?Hl(r):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:r}=Z("NOT_INITIALIZED",this.name);throw new Error(r)}}}class wb extends Pm{constructor(r,i){super(r,i),this.relayer=r,this.logger=i,this.events=new vr.EventEmitter,this.name=Qw,this.queue=new Map,this.publishTimeout=ie.toMiliseconds(ie.TEN_SECONDS),this.queueTimeout=ie.toMiliseconds(ie.FIVE_SECONDS),this.needsTransportRestart=!1,this.publish=async(n,o,l)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:o,opts:l}});try{const d=(l==null?void 0:l.ttl)||Zw,v=ac(l),_=(l==null?void 0:l.prompt)||!1,S=(l==null?void 0:l.tag)||0,F=(l==null?void 0:l.id)||bc().toString(),G={topic:n,message:o,opts:{ttl:d,relay:v,prompt:_,tag:S,id:F}},W=setTimeout(()=>this.queue.set(F,G),this.queueTimeout);try{await await ao(this.rpcPublish(n,o,d,v,_,S,F),this.publishTimeout),clearTimeout(W),this.relayer.events.emit(mt.publish,G)}catch{this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0;return}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:o,opts:l}})}catch(d){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(d),d}},this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.relayer=r,this.logger=Ae.generateChildLogger(i,this.name),this.registerEventListeners()}get context(){return Ae.getLoggerContext(this.logger)}rpcPublish(r,i,n,o,l,d,v){var _,S,F,G;const W={method:io(o.protocol).publish,params:{topic:r,message:i,ttl:n,prompt:l,tag:d},id:v};return _i((_=W.params)==null?void 0:_.prompt)&&((S=W.params)==null||delete S.prompt),_i((F=W.params)==null?void 0:F.tag)&&((G=W.params)==null||delete G.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:W}),this.relayer.request(W)}onPublish(r){this.queue.delete(r)}checkQueue(){this.queue.forEach(async r=>{const{topic:i,message:n,opts:o}=r;await this.publish(i,n,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(ds.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(mt.connection_stalled);return}this.checkQueue()}),this.relayer.on(mt.message_ack,r=>{this.onPublish(r.id.toString())})}}class bb{constructor(){this.map=new Map,this.set=(r,i)=>{const n=this.get(r);this.exists(r,i)||this.map.set(r,[...n,i])},this.get=r=>this.map.get(r)||[],this.exists=(r,i)=>this.get(r).includes(i),this.delete=(r,i)=>{if(typeof i>"u"){this.map.delete(r);return}if(!this.map.has(r))return;const n=this.get(r);if(!this.exists(r,i))return;const o=n.filter(l=>l!==i);if(!o.length){this.map.delete(r);return}this.map.set(r,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var Eb=Object.defineProperty,xb=Object.defineProperties,Ib=Object.getOwnPropertyDescriptors,fl=Object.getOwnPropertySymbols,Sb=Object.prototype.hasOwnProperty,Pb=Object.prototype.propertyIsEnumerable,pl=(c,r,i)=>r in c?Eb(c,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[r]=i,Us=(c,r)=>{for(var i in r||(r={}))Sb.call(r,i)&&pl(c,i,r[i]);if(fl)for(var i of fl(r))Pb.call(r,i)&&pl(c,i,r[i]);return c},Qa=(c,r)=>xb(c,Ib(r));class Cb extends Om{constructor(r,i){super(r,i),this.relayer=r,this.logger=i,this.subscriptions=new Map,this.topicMap=new bb,this.events=new vr.EventEmitter,this.name=cb,this.version=ub,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=wi,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:o}});try{const l=ac(o),d={topic:n,relay:l};this.pending.set(n,d);const v=await this.rpcSubscribe(n,l);return this.onSubscribe(v,d),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:o}}),v}catch(l){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(l),l}},this.unsubscribe=async(n,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(n,o.id,o):await this.unsubscribeByTopic(n,o)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((o,l)=>{const d=new ie.Watch;d.start(this.pendingSubscriptionWatchLabel);const v=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(v),d.stop(this.pendingSubscriptionWatchLabel),o(!0)),d.elapsed(this.pendingSubscriptionWatchLabel)>=hb&&(clearInterval(v),d.stop(this.pendingSubscriptionWatchLabel),l(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=r,this.logger=Ae.generateChildLogger(i,this.name),this.clientId=""}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(r,i){let n=!1;try{n=this.getSubscription(r).topic===i}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(r,i){const n=this.topicMap.get(r);await Promise.all(n.map(async o=>await this.unsubscribeById(r,o,i)))}async unsubscribeById(r,i,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:r,id:i,opts:n}});try{const o=ac(n);await this.rpcUnsubscribe(r,i,o);const l=tr("USER_DISCONNECTED",`${this.name}, ${r}`);await this.onUnsubscribe(r,i,l),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:r,id:i,opts:n}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(r,i){const n={method:io(i.protocol).subscribe,params:{topic:r}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await ao(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(mt.connection_stalled)}return ls(r+this.clientId)}async rpcBatchSubscribe(r){if(!r.length)return;const i=r[0].relay,n={method:io(i.protocol).batchSubscribe,params:{topics:r.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await ao(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(mt.connection_stalled)}}rpcUnsubscribe(r,i,n){const o={method:io(n.protocol).unsubscribe,params:{topic:r,id:i}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(r,i){this.setSubscription(r,Qa(Us({},i),{id:r})),this.pending.delete(i.topic)}onBatchSubscribe(r){r.length&&r.forEach(i=>{this.setSubscription(i.id,Us({},i)),this.pending.delete(i.topic)})}async onUnsubscribe(r,i,n){this.events.removeAllListeners(i),this.hasSubscription(i,r)&&this.deleteSubscription(i,n),await this.relayer.messages.del(r)}async setRelayerSubscriptions(r){await this.relayer.core.storage.setItem(this.storageKey,r)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(r,i){this.subscriptions.has(r)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:r,subscription:i}),this.addSubscription(r,i))}addSubscription(r,i){this.subscriptions.set(r,Us({},i)),this.topicMap.set(i.topic,r),this.events.emit(Vr.created,i)}getSubscription(r){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:r});const i=this.subscriptions.get(r);if(!i){const{message:n}=Z("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(n)}return i}deleteSubscription(r,i){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:r,reason:i});const n=this.getSubscription(r);this.subscriptions.delete(r),this.topicMap.delete(n.topic,r),this.events.emit(Vr.deleted,Qa(Us({},n),{reason:i}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Vr.sync)}async reset(){if(this.cached.length){const r=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let i=0;i<r;i++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(Vr.resubscribed)}async restore(){try{const r=await this.getRelayerSubscriptions();if(typeof r>"u"||!r.length)return;if(this.subscriptions.size){const{message:i}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(i)}this.cached=r,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(r){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(r)}}async batchSubscribe(r){if(!r.length)return;const i=await this.rpcBatchSubscribe(r);ps(i)&&this.onBatchSubscribe(i.map((n,o)=>Qa(Us({},r[o]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(this.relayer.transportExplicitlyClosed)return;const r=[];this.pending.forEach(i=>{r.push(i)}),await this.batchSubscribe(r)}registerEventListeners(){this.relayer.core.heartbeat.on(ds.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(mt.connect,async()=>{await this.onConnect()}),this.relayer.on(mt.disconnect,()=>{this.onDisconnect()}),this.events.on(Vr.created,async r=>{const i=Vr.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),await this.persist()}),this.events.on(Vr.deleted,async r=>{const i=Vr.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:r}=Z("NOT_INITIALIZED",this.name);throw new Error(r)}}async restartToComplete(){this.restartInProgress&&await new Promise(r=>{const i=setInterval(()=>{this.restartInProgress||(clearInterval(i),r())},this.pollingInterval)})}}var Ab=Object.defineProperty,dl=Object.getOwnPropertySymbols,Ob=Object.prototype.hasOwnProperty,Rb=Object.prototype.propertyIsEnumerable,gl=(c,r,i)=>r in c?Ab(c,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[r]=i,Tb=(c,r)=>{for(var i in r||(r={}))Ob.call(r,i)&&gl(c,i,r[i]);if(dl)for(var i of dl(r))Rb.call(r,i)&&gl(c,i,r[i]);return c};class Nb extends Cm{constructor(r){super(r),this.protocol="wc",this.version=2,this.events=new vr.EventEmitter,this.name=tb,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.request=async i=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(i)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.core=r.core,this.logger=typeof r.logger<"u"&&typeof r.logger!="string"?Ae.generateChildLogger(r.logger,this.name):Ae.pino(Ae.getDefaultLoggerOptions({level:r.logger||eb})),this.messages=new _b(this.logger,r.core),this.subscriber=new Cb(this,this.logger),this.publisher=new wb(this,this.logger),this.relayUrl=(r==null?void 0:r.relayUrl)||Af,this.projectId=r.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${hl}...`),await this.restartTransport(hl)}this.registerEventListeners(),this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},nb)}get context(){return Ae.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(r,i,n){this.isInitialized(),await this.publisher.publish(r,i,n),await this.recordMessageEvent({topic:r,message:i,publishedAt:Date.now()})}async subscribe(r,i){var n;this.isInitialized();let o=((n=this.subscriber.topicMap.get(r))==null?void 0:n[0])||"";return o||(await Promise.all([new Promise(l=>{this.subscriber.once(Vr.created,d=>{d.topic===r&&l()})}),new Promise(async l=>{o=await this.subscriber.subscribe(r,i),l()})]),o)}async unsubscribe(r,i){this.isInitialized(),await this.subscriber.unsubscribe(r,i)}on(r,i){this.events.on(r,i)}once(r,i){this.events.once(r,i)}off(r,i){this.events.off(r,i)}removeListener(r,i){this.events.removeListener(r,i)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(mt.transport_closed))}async transportOpen(r){if(this.transportExplicitlyClosed=!1,!this.reconnecting){this.relayUrl=r||this.relayUrl,this.reconnecting=!0;try{await Promise.all([new Promise(i=>{this.initialized||i(),this.subscriber.once(Vr.resubscribed,()=>{i()})}),await Promise.race([new Promise(async(i,n)=>{await ao(this.provider.connect(),5e3,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(o=>n(o)).then(()=>i()).finally(()=>this.removeListener(mt.transport_closed,this.rejectTransportOpen))}),new Promise(i=>this.once(mt.transport_closed,this.rejectTransportOpen))])])}catch(i){this.logger.error(i);const n=i;if(!this.isConnectionStalled(n.message))throw i;this.events.emit(mt.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(r){this.transportExplicitlyClosed||this.reconnecting||(this.relayUrl=r||this.relayUrl,this.connected&&await Promise.all([new Promise(i=>{this.provider.once(zs.disconnect,()=>{i()})}),this.transportClose()]),await this.createProvider(),await this.transportOpen())}isConnectionStalled(r){return this.staleConnectionErrors.some(i=>r.includes(i))}rejectTransportOpen(){throw new Error("Attempt to connect to relay via `transportOpen` has stalled. Retrying...")}async createProvider(){const r=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Ei(new v_(C1({sdkVersion:sb,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:r,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(r){const{topic:i,message:n}=r;await this.messages.set(i,n)}async shouldIgnoreMessageEvent(r){const{topic:i,message:n}=r;return await this.subscriber.isSubscribed(i)?this.messages.has(i,n):!0}async onProviderPayload(r){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:r}),xc(r)){if(!r.method.endsWith(rb))return;const i=r.params,{topic:n,message:o,publishedAt:l}=i.data,d={topic:n,message:o,publishedAt:l};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Tb({type:"event",event:i.id},d)),this.events.emit(i.id,d),await this.acknowledgePayload(r),await this.onMessageEvent(d)}else yo(r)&&this.events.emit(mt.message_ack,r)}async onMessageEvent(r){await this.shouldIgnoreMessageEvent(r)||(this.events.emit(mt.message,r),await this.recordMessageEvent(r))}async acknowledgePayload(r){const i=Ec(r.id,!0);await this.provider.connection.send(i)}registerProviderListeners(){this.provider.on(zs.payload,r=>this.onProviderPayload(r)),this.provider.on(zs.connect,()=>{this.events.emit(mt.connect)}),this.provider.on(zs.disconnect,()=>{this.onProviderDisconnect()}),this.provider.on(zs.error,r=>{this.logger.error(r),this.events.emit(mt.error,r)})}registerEventListeners(){this.events.on(mt.connection_stalled,async()=>{await this.restartTransport()})}onProviderDisconnect(){this.events.emit(mt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.restartTransport()},ie.toMiliseconds(ib))}isInitialized(){if(!this.initialized){const{message:r}=Z("NOT_INITIALIZED",this.name);throw new Error(r)}}async toEstablishConnection(){if(!this.connected){if(this.connecting)return await new Promise(r=>{const i=setInterval(()=>{this.connected&&(clearInterval(i),r())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var Lb=Object.defineProperty,vl=Object.getOwnPropertySymbols,Fb=Object.prototype.hasOwnProperty,Db=Object.prototype.propertyIsEnumerable,yl=(c,r,i)=>r in c?Lb(c,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[r]=i,ml=(c,r)=>{for(var i in r||(r={}))Fb.call(r,i)&&yl(c,i,r[i]);if(vl)for(var i of vl(r))Db.call(r,i)&&yl(c,i,r[i]);return c};class _o extends Am{constructor(r,i,n,o=wi,l=void 0){super(r,i,n,o),this.core=r,this.logger=i,this.name=n,this.map=new Map,this.version=ob,this.cached=[],this.initialized=!1,this.storagePrefix=wi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(d=>{this.getKey&&d!==null&&!_i(d)?this.map.set(this.getKey(d),d):v1(d)?this.map.set(d.id,d):y1(d)&&this.map.set(d.topic,d)}),this.cached=[],this.initialized=!0)},this.set=async(d,v)=>{this.isInitialized(),this.map.has(d)?await this.update(d,v):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:d,value:v}),this.map.set(d,v),await this.persist())},this.get=d=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:d}),this.getData(d)),this.getAll=d=>(this.isInitialized(),d?this.values.filter(v=>Object.keys(d).every(_=>m_(v[_],d[_]))):this.values),this.update=async(d,v)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:d,update:v});const _=ml(ml({},this.getData(d)),v);this.map.set(d,_),await this.persist()},this.delete=async(d,v)=>{this.isInitialized(),this.map.has(d)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:d,reason:v}),this.map.delete(d),await this.persist())},this.logger=Ae.generateChildLogger(i,this.name),this.storagePrefix=o,this.getKey=l}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(r){await this.core.storage.setItem(this.storageKey,r)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(r){const i=this.map.get(r);if(!i){const{message:n}=Z("NO_MATCHING_KEY",`${this.name}: ${r}`);throw this.logger.error(n),new Error(n)}return i}async persist(){await this.setDataStore(this.values)}async restore(){try{const r=await this.getDataStore();if(typeof r>"u"||!r.length)return;if(this.map.size){const{message:i}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=r,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(r){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(r)}}isInitialized(){if(!this.initialized){const{message:r}=Z("NOT_INITIALIZED",this.name);throw new Error(r)}}}class $b{constructor(r,i){this.core=r,this.logger=i,this.name=lb,this.version=fb,this.events=new yc,this.initialized=!1,this.storagePrefix=wi,this.ignoredPayloadTypes=[zl],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=oc(),o=await this.core.crypto.setSymKey(n),l=Dr(ie.FIVE_MINUTES),d={protocol:Cf},v={topic:o,expiry:l,relay:d,active:!1},_=A1({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:n,relay:d});return await this.pairings.set(o,v),await this.core.relayer.subscribe(o),this.core.expirer.set(o,l),{topic:o,uri:_}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:o,symKey:l,relay:d}=O1(n.uri);if(this.pairings.keys.includes(o))throw new Error(`Pairing already exists: ${o}`);if(this.core.crypto.hasKeys(o))throw new Error(`Keychain already exists: ${o}`);const v=Dr(ie.FIVE_MINUTES),_={topic:o,relay:d,expiry:v,active:!1};return await this.pairings.set(o,_),await this.core.crypto.setSymKey(l,o),await this.core.relayer.subscribe(o,{relay:d}),this.core.expirer.set(o,v),n.activatePairing&&await this.activate({topic:o}),_},this.activate=async({topic:n})=>{this.isInitialized();const o=Dr(ie.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:o}),this.core.expirer.set(n,o)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:o}=n;if(this.pairings.keys.includes(o)){const l=await this.sendRequest(o,"wc_pairingPing",{}),{done:d,resolve:v,reject:_}=cs();this.events.once(Dt("pairing_ping",l),({error:S})=>{S?_(S):v()}),await d()}},this.updateExpiry=async({topic:n,expiry:o})=>{this.isInitialized(),await this.pairings.update(n,{expiry:o})},this.updateMetadata=async({topic:n,metadata:o})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:o}=n;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",tr("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(n,o,l)=>{const d=go(o,l),v=await this.core.crypto.encode(n,d),_=qs[o].req;return this.core.history.set(n,d),this.core.relayer.publish(n,v,_),d.id},this.sendResult=async(n,o,l)=>{const d=Ec(n,l),v=await this.core.crypto.encode(o,d),_=await this.core.history.get(o,n),S=qs[_.request.method].res;await this.core.relayer.publish(o,v,S),await this.core.history.resolve(d)},this.sendError=async(n,o,l)=>{const d=vo(n,l),v=await this.core.crypto.encode(o,d),_=await this.core.history.get(o,n),S=qs[_.request.method]?qs[_.request.method].res:qs.unregistered_method.res;await this.core.relayer.publish(o,v,S),await this.core.history.resolve(d)},this.deletePairing=async(n,o)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,tr("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),o?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(o=>mi(o.expiry));await Promise.all(n.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=n=>{const{topic:o,payload:l}=n,d=l.method;if(this.pairings.keys.includes(o))switch(d){case"wc_pairingPing":return this.onPairingPingRequest(o,l);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,l);default:return this.onUnknownRpcMethodRequest(o,l)}},this.onRelayEventResponse=async n=>{const{topic:o,payload:l}=n,d=(await this.core.history.get(o,l.id)).request.method;if(this.pairings.keys.includes(o))switch(d){case"wc_pairingPing":return this.onPairingPingResponse(o,l);default:return this.onUnknownRpcMethodResponse(d)}},this.onPairingPingRequest=async(n,o)=>{const{id:l}=o;try{this.isValidPing({topic:n}),await this.sendResult(l,n,!0),this.events.emit("pairing_ping",{id:l,topic:n})}catch(d){await this.sendError(l,n,d),this.logger.error(d)}},this.onPairingPingResponse=(n,o)=>{const{id:l}=o;setTimeout(()=>{oi(o)?this.events.emit(Dt("pairing_ping",l),{}):$r(o)&&this.events.emit(Dt("pairing_ping",l),{error:o.error})},500)},this.onPairingDeleteRequest=async(n,o)=>{const{id:l}=o;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit("pairing_delete",{id:l,topic:n})}catch(d){await this.sendError(l,n,d),this.logger.error(d)}},this.onUnknownRpcMethodRequest=async(n,o)=>{const{id:l,method:d}=o;try{if(this.registeredMethods.includes(d))return;const v=tr("WC_METHOD_UNSUPPORTED",d);await this.sendError(l,n,v),this.logger.error(v)}catch(v){await this.sendError(l,n,v),this.logger.error(v)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(tr("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{if(!cr(n)){const{message:o}=Z("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(o)}if(!R1(n.uri)){const{message:o}=Z("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(o)}},this.isValidPing=async n=>{if(!cr(n)){const{message:l}=Z("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(l)}const{topic:o}=n;await this.isValidPairingTopic(o)},this.isValidDisconnect=async n=>{if(!cr(n)){const{message:l}=Z("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(l)}const{topic:o}=n;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async n=>{if(!us(n,!1)){const{message:o}=Z("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(o)}if(!this.pairings.keys.includes(n)){const{message:o}=Z("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(o)}if(mi(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:o}=Z("EXPIRED",`pairing topic: ${n}`);throw new Error(o)}},this.core=r,this.logger=Ae.generateChildLogger(i,this.name),this.pairings=new _o(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Ae.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:r}=Z("NOT_INITIALIZED",this.name);throw new Error(r)}}registerRelayerEvents(){this.core.relayer.on(mt.message,async r=>{const{topic:i,message:n}=r;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const o=await this.core.crypto.decode(i,n);xc(o)?(this.core.history.set(i,o),this.onRelayEventRequest({topic:i,payload:o})):yo(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:i,payload:o}),this.core.history.delete(i,o.id))})}registerExpirerEvents(){this.core.expirer.on(Cr.expired,async r=>{const{topic:i}=ql(r.target);i&&this.pairings.keys.includes(i)&&(await this.deletePairing(i,!0),this.events.emit("pairing_expire",{topic:i}))})}}class Mb extends Im{constructor(r,i){super(r,i),this.core=r,this.logger=i,this.records=new Map,this.events=new vr.EventEmitter,this.name=pb,this.version=db,this.cached=[],this.initialized=!1,this.storagePrefix=wi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,o,l)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:o,chainId:l}),this.records.has(o.id))return;const d={id:o.id,topic:n,request:{method:o.method,params:o.params||null},chainId:l,expiry:Dr(ie.THIRTY_DAYS)};this.records.set(d.id,d),this.events.emit(Kr.created,d)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const o=await this.getRecord(n.id);typeof o.response>"u"&&(o.response=$r(n)?{error:n.error}:{result:n.result},this.records.set(o.id,o),this.events.emit(Kr.updated,o))},this.get=async(n,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:o}),await this.getRecord(o)),this.delete=(n,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(l=>{if(l.topic===n){if(typeof o<"u"&&l.id!==o)return;this.records.delete(l.id),this.events.emit(Kr.deleted,l)}})},this.exists=async(n,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===n:!1),this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.logger=Ae.generateChildLogger(i,this.name)}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const r=[];return this.values.forEach(i=>{if(typeof i.response<"u")return;const n={topic:i.topic,request:go(i.request.method,i.request.params,i.id),chainId:i.chainId};return r.push(n)}),r}async setJsonRpcRecords(r){await this.core.storage.setItem(this.storageKey,r)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(r){this.isInitialized();const i=this.records.get(r);if(!i){const{message:n}=Z("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(n)}return i}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Kr.sync)}async restore(){try{const r=await this.getJsonRpcRecords();if(typeof r>"u"||!r.length)return;if(this.records.size){const{message:i}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=r,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(r){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(r)}}registerEventListeners(){this.events.on(Kr.created,r=>{const i=Kr.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:r}),this.persist()}),this.events.on(Kr.updated,r=>{const i=Kr.updated;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:r}),this.persist()}),this.events.on(Kr.deleted,r=>{const i=Kr.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,record:r}),this.persist()}),this.core.heartbeat.on(ds.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(r=>{ie.toMiliseconds(r.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${r.id}`),this.delete(r.topic,r.id))})}catch(r){this.logger.warn(r)}}isInitialized(){if(!this.initialized){const{message:r}=Z("NOT_INITIALIZED",this.name);throw new Error(r)}}}class jb extends Rm{constructor(r,i){super(r,i),this.core=r,this.logger=i,this.expirations=new Map,this.events=new vr.EventEmitter,this.name=gb,this.version=vb,this.cached=[],this.initialized=!1,this.storagePrefix=wi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const o=this.formatTarget(n);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(n,o)=>{this.isInitialized();const l=this.formatTarget(n),d={target:l,expiry:o};this.expirations.set(l,d),this.checkExpiry(l,d),this.events.emit(Cr.created,{target:l,expiration:d})},this.get=n=>{this.isInitialized();const o=this.formatTarget(n);return this.getExpiration(o)},this.del=n=>{if(this.isInitialized(),this.has(n)){const o=this.formatTarget(n),l=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Cr.deleted,{target:o,expiration:l})}},this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.logger=Ae.generateChildLogger(i,this.name)}get context(){return Ae.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(r){if(typeof r=="string")return T1(r);if(typeof r=="number")return N1(r);const{message:i}=Z("UNKNOWN_TYPE",`Target type: ${typeof r}`);throw new Error(i)}async setExpirations(r){await this.core.storage.setItem(this.storageKey,r)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Cr.sync)}async restore(){try{const r=await this.getExpirations();if(typeof r>"u"||!r.length)return;if(this.expirations.size){const{message:i}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(i),new Error(i)}this.cached=r,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(r){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(r)}}getExpiration(r){const i=this.expirations.get(r);if(!i){const{message:n}=Z("NO_MATCHING_KEY",`${this.name}: ${r}`);throw this.logger.error(n),new Error(n)}return i}checkExpiry(r,i){const{expiry:n}=i;ie.toMiliseconds(n)-Date.now()<=0&&this.expire(r,i)}expire(r,i){this.expirations.delete(r),this.events.emit(Cr.expired,{target:r,expiration:i})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((r,i)=>this.checkExpiry(i,r))}registerEventListeners(){this.core.heartbeat.on(ds.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Cr.created,r=>{const i=Cr.created;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),this.persist()}),this.events.on(Cr.expired,r=>{const i=Cr.expired;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),this.persist()}),this.events.on(Cr.deleted,r=>{const i=Cr.deleted;this.logger.info(`Emitting ${i}`),this.logger.debug({type:"event",event:i,data:r}),this.persist()})}isInitialized(){if(!this.initialized){const{message:r}=Z("NOT_INITIALIZED",this.name);throw new Error(r)}}}class zb extends Tm{constructor(r,i){super(r,i),this.projectId=r,this.logger=i,this.name=Za,this.initialized=!1,this.init=async n=>{L1()||!Ul()||(this.verifyUrl=(n==null?void 0:n.verifyUrl)||ll,await this.createIframe())},this.register=async n=>{var o;if(this.initialized||await this.init(),!!this.iframe)try{(o=this.iframe.contentWindow)==null||o.postMessage(n.attestationId,this.verifyUrl),this.logger.info(`postMessage sent: ${n.attestationId} ${this.verifyUrl}`)}catch{}},this.resolve=async n=>{var o;if(this.isDevEnv)return"";this.logger.info(`resolving attestation: ${n.attestationId}`);const l=this.startAbortTimer(ie.FIVE_SECONDS),d=await fetch(`${this.verifyUrl}/attestation/${n.attestationId}`,{signal:this.abortController.signal});return clearTimeout(l),d.status===200?(o=await d.json())==null?void 0:o.origin:""},this.createIframe=async()=>{try{await Promise.race([new Promise((n,o)=>{if(document.getElementById(Za))return n();const l=document.createElement("iframe");l.setAttribute("id",Za),l.setAttribute("src",`${this.verifyUrl}/${this.projectId}`),l.style.display="none",l.addEventListener("load",()=>{this.initialized=!0,n()}),l.addEventListener("error",d=>{o(d)}),document.body.append(l),this.iframe=l}),new Promise(n=>{setTimeout(()=>n("iframe load timeout"),ie.toMiliseconds(ie.ONE_SECOND/2))})])}catch(n){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(n)}},this.logger=Ae.generateChildLogger(i,this.name),this.verifyUrl=ll,this.abortController=new AbortController,this.isDevEnv=F1()&&{}.IS_VITEST}get context(){return Ae.getLoggerContext(this.logger)}startAbortTimer(r){return setTimeout(()=>this.abortController.abort(),ie.toMiliseconds(r))}}var qb=Object.defineProperty,_l=Object.getOwnPropertySymbols,Ub=Object.prototype.hasOwnProperty,kb=Object.prototype.propertyIsEnumerable,wl=(c,r,i)=>r in c?qb(c,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[r]=i,bl=(c,r)=>{for(var i in r||(r={}))Ub.call(r,i)&&wl(c,i,r[i]);if(_l)for(var i of _l(r))kb.call(r,i)&&wl(c,i,r[i]);return c};class Sc extends xm{constructor(r){super(r),this.protocol=Pf,this.version=Hw,this.name=Ic,this.events=new vr.EventEmitter,this.initialized=!1,this.on=(n,o)=>this.events.on(n,o),this.once=(n,o)=>this.events.once(n,o),this.off=(n,o)=>this.events.off(n,o),this.removeListener=(n,o)=>this.events.removeListener(n,o),this.projectId=r==null?void 0:r.projectId,this.relayUrl=(r==null?void 0:r.relayUrl)||Af;const i=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:Ae.pino(Ae.getDefaultLoggerOptions({level:(r==null?void 0:r.logger)||Kw.logger}));this.logger=Ae.generateChildLogger(i,this.name),this.heartbeat=new ds.HeartBeat,this.crypto=new mb(this,this.logger,r==null?void 0:r.keychain),this.history=new Mb(this,this.logger),this.expirer=new jb(this,this.logger),this.storage=r!=null&&r.storage?r.storage:new dm(bl(bl({},Vw),r==null?void 0:r.storageOptions)),this.relayer=new Nb({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new $b(this,this.logger),this.verify=new zb(this.projectId||"",this.logger)}static async init(r){const i=new Sc(r);await i.initialize();const n=await i.crypto.getClientId();return await i.storage.setItem(ab,n),i}get context(){return Ae.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(r){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,r),this.logger.error(r.message),r}}}const Hb=Sc,Of="wc",Rf=2,Tf="client",Pc=`${Of}@${Rf}:${Tf}:`,ec={name:Tf,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},Kb="WALLETCONNECT_DEEPLINK_CHOICE",Vb="proposal",Nf="Proposal expired",Bb="session",eo=ie.SEVEN_DAYS,Gb="engine",ks={wc_sessionPropose:{req:{ttl:ie.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ie.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ie.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ie.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ie.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ie.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ie.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ie.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ie.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ie.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ie.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ie.THIRTY_SECONDS,prompt:!1,tag:1115}}},tc={min:ie.FIVE_MINUTES,max:ie.SEVEN_DAYS},Wb="request",Jb=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var Yb=Object.defineProperty,Xb=Object.defineProperties,Zb=Object.getOwnPropertyDescriptors,El=Object.getOwnPropertySymbols,Qb=Object.prototype.hasOwnProperty,eE=Object.prototype.propertyIsEnumerable,xl=(c,r,i)=>r in c?Yb(c,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[r]=i,Pr=(c,r)=>{for(var i in r||(r={}))Qb.call(r,i)&&xl(c,i,r[i]);if(El)for(var i of El(r))eE.call(r,i)&&xl(c,i,r[i]);return c},rc=(c,r)=>Xb(c,Zb(r));class tE extends Lm{constructor(r){super(r),this.name=Gb,this.events=new yc,this.initialized=!1,this.ignoredPayloadTypes=[zl],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(ks)}),this.initialized=!0)},this.connect=async i=>{this.isInitialized();const n=rc(Pr({},i),{requiredNamespaces:i.requiredNamespaces||{},optionalNamespaces:i.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:o,requiredNamespaces:l,optionalNamespaces:d,sessionProperties:v,relays:_}=n;let S=o,F,G=!1;if(S&&(G=this.client.core.pairing.pairings.get(S).active),!S||!G){const{topic:pe,uri:ue}=await this.client.core.pairing.create();S=pe,F=ue}const W=await this.client.core.crypto.generateKeyPair(),V=Pr({requiredNamespaces:l,optionalNamespaces:d,relays:_??[{protocol:Cf}],proposer:{publicKey:W,metadata:this.client.metadata}},v&&{sessionProperties:v}),{reject:q,resolve:K,done:oe}=cs(ie.FIVE_MINUTES,Nf);if(this.events.once(Dt("session_connect"),async({error:pe,session:ue})=>{if(pe)q(pe);else if(ue){ue.self.publicKey=W;const he=rc(Pr({},ue),{requiredNamespaces:ue.requiredNamespaces,optionalNamespaces:ue.optionalNamespaces});await this.client.session.set(ue.topic,he),await this.setExpiry(ue.topic,ue.expiry),S&&await this.client.core.pairing.updateMetadata({topic:S,metadata:ue.peer.metadata}),K(he)}}),!S){const{message:pe}=Z("NO_MATCHING_KEY",`connect() pairing topic: ${S}`);throw new Error(pe)}const be=await this.sendRequest(S,"wc_sessionPropose",V),de=Dr(ie.FIVE_MINUTES);return await this.setProposal(be,Pr({id:be,expiry:de},V)),{uri:F,approval:oe}},this.pair=async i=>(this.isInitialized(),await this.client.core.pairing.pair(i)),this.approve=async i=>{this.isInitialized(),await this.isValidApprove(i);const{id:n,relayProtocol:o,namespaces:l,sessionProperties:d}=i,v=this.client.proposal.get(n);let{pairingTopic:_,proposer:S,requiredNamespaces:F,optionalNamespaces:G}=v;_=_||"",so(F)||(F=$1(l,"approve()"));const W=await this.client.core.crypto.generateKeyPair(),V=S.publicKey,q=await this.client.core.crypto.generateSharedKey(W,V);_&&n&&(await this.client.core.pairing.updateMetadata({topic:_,metadata:S.metadata}),await this.sendResult(n,_,{relay:{protocol:o??"irn"},responderPublicKey:W}),await this.client.proposal.delete(n,tr("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:_}));const K=Pr({relay:{protocol:o??"irn"},namespaces:l,requiredNamespaces:F,optionalNamespaces:G,pairingTopic:_,controller:{publicKey:W,metadata:this.client.metadata},expiry:Dr(eo)},d&&{sessionProperties:d});await this.client.core.relayer.subscribe(q),await this.sendRequest(q,"wc_sessionSettle",K);const oe=rc(Pr({},K),{topic:q,pairingTopic:_,acknowledged:!1,self:K.controller,peer:{publicKey:S.publicKey,metadata:S.metadata},controller:W});return await this.client.session.set(q,oe),await this.setExpiry(q,Dr(eo)),{topic:q,acknowledged:()=>new Promise(be=>setTimeout(()=>be(this.client.session.get(q)),500))}},this.reject=async i=>{this.isInitialized(),await this.isValidReject(i);const{id:n,reason:o}=i,{pairingTopic:l}=this.client.proposal.get(n);l&&(await this.sendError(n,l,o),await this.client.proposal.delete(n,tr("USER_DISCONNECTED")))},this.update=async i=>{this.isInitialized(),await this.isValidUpdate(i);const{topic:n,namespaces:o}=i,l=await this.sendRequest(n,"wc_sessionUpdate",{namespaces:o}),{done:d,resolve:v,reject:_}=cs();return this.events.once(Dt("session_update",l),({error:S})=>{S?_(S):v()}),await this.client.session.update(n,{namespaces:o}),{acknowledged:d}},this.extend=async i=>{this.isInitialized(),await this.isValidExtend(i);const{topic:n}=i,o=await this.sendRequest(n,"wc_sessionExtend",{}),{done:l,resolve:d,reject:v}=cs();return this.events.once(Dt("session_extend",o),({error:_})=>{_?v(_):d()}),await this.setExpiry(n,Dr(eo)),{acknowledged:l}},this.request=async i=>{this.isInitialized(),await this.isValidRequest(i);const{chainId:n,request:o,topic:l,expiry:d}=i,v=await this.sendRequest(l,"wc_sessionRequest",{request:o,chainId:n},d),{done:_,resolve:S,reject:F}=cs(d);this.events.once(Dt("session_request",v),({error:W,result:V})=>{W?F(W):S(V)}),this.client.events.emit("session_request_sent",{topic:l,request:o,chainId:n,id:v});const G=await this.client.core.storage.getItem(Kb);return M1({id:v,topic:l,wcDeepLink:G}),await _()},this.respond=async i=>{this.isInitialized(),await this.isValidRespond(i);const{topic:n,response:o}=i,{id:l}=o;oi(o)?await this.sendResult(l,n,o.result):$r(o)&&await this.sendError(l,n,o.error),this.deletePendingSessionRequest(i.response.id,{message:"fulfilled",code:0})},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i);const{topic:n}=i;if(this.client.session.keys.includes(n)){const o=await this.sendRequest(n,"wc_sessionPing",{}),{done:l,resolve:d,reject:v}=cs();this.events.once(Dt("session_ping",o),({error:_})=>{_?v(_):d()}),await l()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async i=>{this.isInitialized(),await this.isValidEmit(i);const{topic:n,event:o,chainId:l}=i;await this.sendRequest(n,"wc_sessionEvent",{event:o,chainId:l})},this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:n}=i;if(this.client.session.keys.includes(n)){const o=bc().toString();let l;const d=v=>{(v==null?void 0:v.id.toString())===o&&(this.client.core.relayer.events.removeListener(mt.message_ack,d),l())};await Promise.all([new Promise(v=>{l=v,this.client.core.relayer.on(mt.message_ack,d)}),this.sendRequest(n,"wc_sessionDelete",tr("USER_DISCONNECTED"),void 0,o)]),await this.deleteSession(n)}else await this.client.core.pairing.disconnect({topic:n})},this.find=i=>(this.isInitialized(),this.client.session.getAll().filter(n=>j1(n,i))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async i=>{if(i.pairingTopic)try{const n=this.client.core.pairing.pairings.get(i.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(l=>{var d,v;return((d=l.peerMetadata)==null?void 0:d.url)&&((v=l.peerMetadata)==null?void 0:v.url)===i.peer.metadata.url&&l.topic&&l.topic!==n.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(l=>this.client.core.pairing.disconnect({topic:l.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}},this.deleteSession=async(i,n)=>{const{self:o}=this.client.session.get(i);await this.client.core.relayer.unsubscribe(i),this.client.session.delete(i,tr("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(i)&&await this.client.core.crypto.deleteSymKey(i),n||this.client.core.expirer.del(i)},this.deleteProposal=async(i,n)=>{await Promise.all([this.client.proposal.delete(i,tr("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(i)])},this.deletePendingSessionRequest=async(i,n,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(i,n),o?Promise.resolve():this.client.core.expirer.del(i)])},this.setExpiry=async(i,n)=>{this.client.session.keys.includes(i)&&await this.client.session.update(i,{expiry:n}),this.client.core.expirer.set(i,n)},this.setProposal=async(i,n)=>{await this.client.proposal.set(i,n),this.client.core.expirer.set(i,n.expiry)},this.setPendingSessionRequest=async i=>{const n=ks.wc_sessionRequest.req.ttl,{id:o,topic:l,params:d}=i;await this.client.pendingRequest.set(o,{id:o,topic:l,params:d}),n&&this.client.core.expirer.set(o,Dr(n))},this.sendRequest=async(i,n,o,l,d)=>{const v=go(n,o);if(Ul()&&Jb.includes(n)){const F=ls(JSON.stringify(v));await this.client.core.verify.register({attestationId:F})}const _=await this.client.core.crypto.encode(i,v),S=ks[n].req;return l&&(S.ttl=l),d&&(S.id=d),this.client.core.history.set(i,v),this.client.core.relayer.publish(i,_,S),v.id},this.sendResult=async(i,n,o)=>{const l=Ec(i,o),d=await this.client.core.crypto.encode(n,l),v=await this.client.core.history.get(n,i),_=ks[v.request.method].res;this.client.core.relayer.publish(n,d,_),await this.client.core.history.resolve(l)},this.sendError=async(i,n,o)=>{const l=vo(i,o),d=await this.client.core.crypto.encode(n,l),v=await this.client.core.history.get(n,i),_=ks[v.request.method].res;this.client.core.relayer.publish(n,d,_),await this.client.core.history.resolve(l)},this.cleanup=async()=>{const i=[],n=[];this.client.session.getAll().forEach(o=>{mi(o.expiry)&&i.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{mi(o.expiry)&&n.push(o.id)}),await Promise.all([...i.map(o=>this.deleteSession(o)),...n.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=i=>{const{topic:n,payload:o}=i,l=o.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeRequest(n,o);case"wc_sessionSettle":return this.onSessionSettleRequest(n,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,o);case"wc_sessionExtend":return this.onSessionExtendRequest(n,o);case"wc_sessionPing":return this.onSessionPingRequest(n,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,o);case"wc_sessionRequest":return this.onSessionRequest(n,o);case"wc_sessionEvent":return this.onSessionEventRequest(n,o);default:return this.client.logger.info(`Unsupported request method ${l}`)}},this.onRelayEventResponse=async i=>{const{topic:n,payload:o}=i,l=(await this.client.core.history.get(n,o.id)).request.method;switch(l){case"wc_sessionPropose":return this.onSessionProposeResponse(n,o);case"wc_sessionSettle":return this.onSessionSettleResponse(n,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,o);case"wc_sessionExtend":return this.onSessionExtendResponse(n,o);case"wc_sessionPing":return this.onSessionPingResponse(n,o);case"wc_sessionRequest":return this.onSessionRequestResponse(n,o);default:return this.client.logger.info(`Unsupported response method ${l}`)}},this.onRelayEventUnknownPayload=i=>{const{topic:n}=i,{message:o}=Z("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(i,n)=>{const{params:o,id:l}=n;try{this.isValidConnect(Pr({},n.params));const d=Dr(ie.FIVE_MINUTES),v=Pr({id:l,pairingTopic:i,expiry:d},o);await this.setProposal(l,v);const _=ls(JSON.stringify(n)),S=await this.getVerifyContext(_,v.proposer.metadata);this.client.events.emit("session_proposal",{id:l,params:v,verifyContext:S})}catch(d){await this.sendError(l,i,d),this.client.logger.error(d)}},this.onSessionProposeResponse=async(i,n)=>{const{id:o}=n;if(oi(n)){const{result:l}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:l});const d=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:d});const v=d.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:v});const _=l.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:_});const S=await this.client.core.crypto.generateSharedKey(v,_);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:S});const F=await this.client.core.relayer.subscribe(S);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:F}),await this.client.core.pairing.activate({topic:i})}else $r(n)&&(await this.client.proposal.delete(o,tr("USER_DISCONNECTED")),this.events.emit(Dt("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(i,n)=>{const{id:o,params:l}=n;try{this.isValidSessionSettleRequest(l);const{relay:d,controller:v,expiry:_,namespaces:S,requiredNamespaces:F,optionalNamespaces:G,sessionProperties:W,pairingTopic:V}=n.params,q=Pr({topic:i,relay:d,expiry:_,namespaces:S,acknowledged:!0,pairingTopic:V,requiredNamespaces:F,optionalNamespaces:G,controller:v.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:v.publicKey,metadata:v.metadata}},W&&{sessionProperties:W});await this.sendResult(n.id,i,!0),this.events.emit(Dt("session_connect"),{session:q}),this.cleanupDuplicatePairings(q)}catch(d){await this.sendError(o,i,d),this.client.logger.error(d)}},this.onSessionSettleResponse=async(i,n)=>{const{id:o}=n;oi(n)?(await this.client.session.update(i,{acknowledged:!0}),this.events.emit(Dt("session_approve",o),{})):$r(n)&&(await this.client.session.delete(i,tr("USER_DISCONNECTED")),this.events.emit(Dt("session_approve",o),{error:n.error}))},this.onSessionUpdateRequest=async(i,n)=>{const{params:o,id:l}=n;try{this.isValidUpdate(Pr({topic:i},o)),await this.client.session.update(i,{namespaces:o.namespaces}),await this.sendResult(l,i,!0),this.client.events.emit("session_update",{id:l,topic:i,params:o})}catch(d){await this.sendError(l,i,d),this.client.logger.error(d)}},this.onSessionUpdateResponse=(i,n)=>{const{id:o}=n;oi(n)?this.events.emit(Dt("session_update",o),{}):$r(n)&&this.events.emit(Dt("session_update",o),{error:n.error})},this.onSessionExtendRequest=async(i,n)=>{const{id:o}=n;try{this.isValidExtend({topic:i}),await this.setExpiry(i,Dr(eo)),await this.sendResult(o,i,!0),this.client.events.emit("session_extend",{id:o,topic:i})}catch(l){await this.sendError(o,i,l),this.client.logger.error(l)}},this.onSessionExtendResponse=(i,n)=>{const{id:o}=n;oi(n)?this.events.emit(Dt("session_extend",o),{}):$r(n)&&this.events.emit(Dt("session_extend",o),{error:n.error})},this.onSessionPingRequest=async(i,n)=>{const{id:o}=n;try{this.isValidPing({topic:i}),await this.sendResult(o,i,!0),this.client.events.emit("session_ping",{id:o,topic:i})}catch(l){await this.sendError(o,i,l),this.client.logger.error(l)}},this.onSessionPingResponse=(i,n)=>{const{id:o}=n;setTimeout(()=>{oi(n)?this.events.emit(Dt("session_ping",o),{}):$r(n)&&this.events.emit(Dt("session_ping",o),{error:n.error})},500)},this.onSessionDeleteRequest=async(i,n)=>{const{id:o}=n;try{this.isValidDisconnect({topic:i,reason:n.params}),await Promise.all([new Promise(l=>{this.client.core.relayer.once(mt.publish,async()=>{l(await this.deleteSession(i))})}),this.sendResult(o,i,!0)]),this.client.events.emit("session_delete",{id:o,topic:i})}catch(l){this.client.logger.error(l)}},this.onSessionRequest=async(i,n)=>{const{id:o,params:l}=n;try{this.isValidRequest(Pr({topic:i},l)),await this.setPendingSessionRequest({id:o,topic:i,params:l});const d=ls(JSON.stringify(n)),v=this.client.session.get(i),_=await this.getVerifyContext(d,v.peer.metadata);this.client.events.emit("session_request",{id:o,topic:i,params:l,verifyContext:_})}catch(d){await this.sendError(o,i,d),this.client.logger.error(d)}},this.onSessionRequestResponse=(i,n)=>{const{id:o}=n;oi(n)?this.events.emit(Dt("session_request",o),{result:n.result}):$r(n)&&this.events.emit(Dt("session_request",o),{error:n.error})},this.onSessionEventRequest=async(i,n)=>{const{id:o,params:l}=n;try{this.isValidEmit(Pr({topic:i},l)),this.client.events.emit("session_event",{id:o,topic:i,params:l})}catch(d){await this.sendError(o,i,d),this.client.logger.error(d)}},this.isValidConnect=async i=>{if(!cr(i)){const{message:_}=Z("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(i)}`);throw new Error(_)}const{pairingTopic:n,requiredNamespaces:o,optionalNamespaces:l,sessionProperties:d,relays:v}=i;if(_i(n)||await this.isValidPairingTopic(n),!z1(v,!0)){const{message:_}=Z("MISSING_OR_INVALID",`connect() relays: ${v}`);throw new Error(_)}!_i(o)&&so(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!_i(l)&&so(l)!==0&&this.validateNamespaces(l,"optionalNamespaces"),_i(d)||this.validateSessionProps(d,"sessionProperties")},this.validateNamespaces=(i,n)=>{const o=q1(i,"connect()",n);if(o)throw new Error(o.message)},this.isValidApprove=async i=>{if(!cr(i))throw new Error(Z("MISSING_OR_INVALID",`approve() params: ${i}`).message);const{id:n,namespaces:o,relayProtocol:l,sessionProperties:d}=i;await this.isValidProposalId(n);const v=this.client.proposal.get(n),_=Ka(o,"approve()");if(_)throw new Error(_.message);const S=Rh(v.requiredNamespaces,o,"approve()");if(S)throw new Error(S.message);if(!us(l,!0)){const{message:F}=Z("MISSING_OR_INVALID",`approve() relayProtocol: ${l}`);throw new Error(F)}_i(d)||this.validateSessionProps(d,"sessionProperties")},this.isValidReject=async i=>{if(!cr(i)){const{message:l}=Z("MISSING_OR_INVALID",`reject() params: ${i}`);throw new Error(l)}const{id:n,reason:o}=i;if(await this.isValidProposalId(n),!U1(o)){const{message:l}=Z("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(l)}},this.isValidSessionSettleRequest=i=>{if(!cr(i)){const{message:S}=Z("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${i}`);throw new Error(S)}const{relay:n,controller:o,namespaces:l,expiry:d}=i;if(!k1(n)){const{message:S}=Z("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(S)}const v=H1(o,"onSessionSettleRequest()");if(v)throw new Error(v.message);const _=Ka(l,"onSessionSettleRequest()");if(_)throw new Error(_.message);if(mi(d)){const{message:S}=Z("EXPIRED","onSessionSettleRequest()");throw new Error(S)}},this.isValidUpdate=async i=>{if(!cr(i)){const{message:_}=Z("MISSING_OR_INVALID",`update() params: ${i}`);throw new Error(_)}const{topic:n,namespaces:o}=i;await this.isValidSessionTopic(n);const l=this.client.session.get(n),d=Ka(o,"update()");if(d)throw new Error(d.message);const v=Rh(l.requiredNamespaces,o,"update()");if(v)throw new Error(v.message)},this.isValidExtend=async i=>{if(!cr(i)){const{message:o}=Z("MISSING_OR_INVALID",`extend() params: ${i}`);throw new Error(o)}const{topic:n}=i;await this.isValidSessionTopic(n)},this.isValidRequest=async i=>{if(!cr(i)){const{message:_}=Z("MISSING_OR_INVALID",`request() params: ${i}`);throw new Error(_)}const{topic:n,request:o,chainId:l,expiry:d}=i;await this.isValidSessionTopic(n);const{namespaces:v}=this.client.session.get(n);if(!Th(v,l)){const{message:_}=Z("MISSING_OR_INVALID",`request() chainId: ${l}`);throw new Error(_)}if(!K1(o)){const{message:_}=Z("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(_)}if(!V1(v,l,o.method)){const{message:_}=Z("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(_)}if(d&&!B1(d,tc)){const{message:_}=Z("MISSING_OR_INVALID",`request() expiry: ${d}. Expiry must be a number (in seconds) between ${tc.min} and ${tc.max}`);throw new Error(_)}},this.isValidRespond=async i=>{if(!cr(i)){const{message:l}=Z("MISSING_OR_INVALID",`respond() params: ${i}`);throw new Error(l)}const{topic:n,response:o}=i;if(await this.isValidSessionTopic(n),!G1(o)){const{message:l}=Z("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(o)}`);throw new Error(l)}},this.isValidPing=async i=>{if(!cr(i)){const{message:o}=Z("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(o)}const{topic:n}=i;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async i=>{if(!cr(i)){const{message:v}=Z("MISSING_OR_INVALID",`emit() params: ${i}`);throw new Error(v)}const{topic:n,event:o,chainId:l}=i;await this.isValidSessionTopic(n);const{namespaces:d}=this.client.session.get(n);if(!Th(d,l)){const{message:v}=Z("MISSING_OR_INVALID",`emit() chainId: ${l}`);throw new Error(v)}if(!W1(o)){const{message:v}=Z("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(v)}if(!J1(d,l,o.name)){const{message:v}=Z("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(v)}},this.isValidDisconnect=async i=>{if(!cr(i)){const{message:o}=Z("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(o)}const{topic:n}=i;await this.isValidSessionOrPairingTopic(n)},this.getVerifyContext=async(i,n)=>{const o={verified:{verifyUrl:n.verifyUrl||"",validation:"UNKNOWN",origin:n.url||""}};try{const l=await this.client.core.verify.resolve({attestationId:i,verifyUrl:n.verifyUrl});l&&(o.verified.origin=l,o.verified.validation=l===n.url?"VALID":"INVALID")}catch(l){this.client.logger.error(l)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(i,n)=>{Object.values(i).forEach(o=>{if(!us(o,!1)){const{message:l}=Z("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(l)}})}}isInitialized(){if(!this.initialized){const{message:r}=Z("NOT_INITIALIZED",this.name);throw new Error(r)}}registerRelayerEvents(){this.client.core.relayer.on(mt.message,async r=>{const{topic:i,message:n}=r;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const o=await this.client.core.crypto.decode(i,n);xc(o)?(this.client.core.history.set(i,o),this.onRelayEventRequest({topic:i,payload:o})):yo(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:i,payload:o}),this.client.core.history.delete(i,o.id)):this.onRelayEventUnknownPayload({topic:i,payload:o})})}registerExpirerEvents(){this.client.core.expirer.on(Cr.expired,async r=>{const{topic:i,id:n}=ql(r.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,Z("EXPIRED"),!0);i?this.client.session.keys.includes(i)&&(await this.deleteSession(i,!0),this.client.events.emit("session_expire",{topic:i})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}isValidPairingTopic(r){if(!us(r,!1)){const{message:i}=Z("MISSING_OR_INVALID",`pairing topic should be a string: ${r}`);throw new Error(i)}if(!this.client.core.pairing.pairings.keys.includes(r)){const{message:i}=Z("NO_MATCHING_KEY",`pairing topic doesn't exist: ${r}`);throw new Error(i)}if(mi(this.client.core.pairing.pairings.get(r).expiry)){const{message:i}=Z("EXPIRED",`pairing topic: ${r}`);throw new Error(i)}}async isValidSessionTopic(r){if(!us(r,!1)){const{message:i}=Z("MISSING_OR_INVALID",`session topic should be a string: ${r}`);throw new Error(i)}if(!this.client.session.keys.includes(r)){const{message:i}=Z("NO_MATCHING_KEY",`session topic doesn't exist: ${r}`);throw new Error(i)}if(mi(this.client.session.get(r).expiry)){await this.deleteSession(r);const{message:i}=Z("EXPIRED",`session topic: ${r}`);throw new Error(i)}}async isValidSessionOrPairingTopic(r){if(this.client.session.keys.includes(r))await this.isValidSessionTopic(r);else if(this.client.core.pairing.pairings.keys.includes(r))this.isValidPairingTopic(r);else if(us(r,!1)){const{message:i}=Z("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${r}`);throw new Error(i)}else{const{message:i}=Z("MISSING_OR_INVALID",`session or pairing topic should be a string: ${r}`);throw new Error(i)}}async isValidProposalId(r){if(!Y1(r)){const{message:i}=Z("MISSING_OR_INVALID",`proposal id should be a number: ${r}`);throw new Error(i)}if(!this.client.proposal.keys.includes(r)){const{message:i}=Z("NO_MATCHING_KEY",`proposal id doesn't exist: ${r}`);throw new Error(i)}if(mi(this.client.proposal.get(r).expiry)){await this.deleteProposal(r);const{message:i}=Z("EXPIRED",`proposal id: ${r}`);throw new Error(i)}}}class rE extends _o{constructor(r,i){super(r,i,Vb,Pc),this.core=r,this.logger=i}}class iE extends _o{constructor(r,i){super(r,i,Bb,Pc),this.core=r,this.logger=i}}class sE extends _o{constructor(r,i){super(r,i,Wb,Pc,n=>n.id),this.core=r,this.logger=i}}let nE=class Lf extends Nm{constructor(r){super(r),this.protocol=Of,this.version=Rf,this.name=ec.name,this.events=new vr.EventEmitter,this.on=(n,o)=>this.events.on(n,o),this.once=(n,o)=>this.events.once(n,o),this.off=(n,o)=>this.events.off(n,o),this.removeListener=(n,o)=>this.events.removeListener(n,o),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(o){throw this.logger.error(o.message),o}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(o){throw this.logger.error(o.message),o}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(o){throw this.logger.error(o.message),o}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(o){throw this.logger.error(o.message),o}},this.update=async n=>{try{return await this.engine.update(n)}catch(o){throw this.logger.error(o.message),o}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(o){throw this.logger.error(o.message),o}},this.request=async n=>{try{return await this.engine.request(n)}catch(o){throw this.logger.error(o.message),o}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(o){throw this.logger.error(o.message),o}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(o){throw this.logger.error(o.message),o}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(o){throw this.logger.error(o.message),o}},this.find=n=>{try{return this.engine.find(n)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=(r==null?void 0:r.name)||ec.name,this.metadata=(r==null?void 0:r.metadata)||D1();const i=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:Ae.pino(Ae.getDefaultLoggerOptions({level:(r==null?void 0:r.logger)||ec.logger}));this.core=(r==null?void 0:r.core)||new Hb(r),this.logger=Ae.generateChildLogger(i,this.name),this.session=new iE(this.core,this.logger),this.proposal=new rE(this.core,this.logger),this.pendingRequest=new sE(this.core,this.logger),this.engine=new tE(this)}static async init(r){const i=new Lf(r);return await i.initialize(),i}get context(){return Ae.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(r){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(r.message),r}}};var oE=X1();const Il=dc(oE),aE={Accept:"application/json","Content-Type":"application/json"},cE="POST",Sl={headers:aE,method:cE},Pl=10;class Ui{constructor(r,i=!1){if(this.url=r,this.disableProviderPing=i,this.events=new vr.EventEmitter,this.isAvailable=!1,this.registering=!1,!Qh(r))throw new Error(`Provided URL is not compatible with HTTP connection: ${r}`);this.url=r,this.disableProviderPing=i}get connected(){return this.isAvailable}get connecting(){return this.registering}on(r,i){this.events.on(r,i)}once(r,i){this.events.once(r,i)}off(r,i){this.events.off(r,i)}removeListener(r,i){this.events.removeListener(r,i)}async open(r=this.url){await this.register(r)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(r,i){this.isAvailable||await this.register();try{const n=Bs(r),l=await(await Il(this.url,Object.assign(Object.assign({},Sl),{body:n}))).json();this.onPayload({data:l})}catch(n){this.onError(r.id,n)}}async register(r=this.url){if(!Qh(r))throw new Error(`Provided URL is not compatible with HTTP connection: ${r}`);if(this.registering){const i=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=i||this.events.listenerCount("open")>=i)&&this.events.setMaxListeners(i+1),new Promise((n,o)=>{this.events.once("register_error",l=>{this.resetMaxListeners(),o(l)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));n()})})}this.url=r,this.registering=!0;try{if(!this.disableProviderPing){const i=Bs({id:1,jsonrpc:"2.0",method:"test",params:[]});await Il(r,Object.assign(Object.assign({},Sl),{body:i}))}this.onOpen()}catch(i){const n=this.parseError(i);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(r){if(typeof r.data>"u")return;const i=typeof r.data=="string"?mc(r.data):r.data;this.events.emit("payload",i)}onError(r,i){const n=this.parseError(i),o=n.message||n.toString(),l=vo(r,o);this.events.emit("payload",l)}parseError(r,i=this.url){return hf(r,i,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Pl&&this.events.setMaxListeners(Pl)}}const Cl="error",uE="wss://relay.walletconnect.com",hE="wc",lE="universal_provider",Al=`${hE}@2:${lE}:`,fE="https://rpc.walletconnect.com/v1",xi={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Hs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},hc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(c,r){(function(){var i,n="4.17.21",o=200,l="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",d="Expected a function",v="Invalid `variable` option passed into `_.template`",_="__lodash_hash_undefined__",S=500,F="__lodash_placeholder__",G=1,W=2,V=4,q=1,K=2,oe=1,be=2,de=4,pe=8,ue=16,he=32,R=64,j=128,B=256,ge=512,te=30,Ee="...",Oe=800,tt=16,C=1,D=2,ze=3,Re=1/0,J=9007199254740991,U=17976931348623157e292,z=0/0,k=4294967295,ut=k-1,He=k>>>1,Mr=[["ary",j],["bind",oe],["bindKey",be],["curry",pe],["curryRight",ue],["flip",ge],["partial",he],["partialRight",R],["rearg",B]],_e="[object Arguments]",St="[object Array]",O="[object AsyncFunction]",A="[object Boolean]",I="[object Date]",u="[object DOMException]",w="[object Error]",Q="[object Function]",ae="[object GeneratorFunction]",ye="[object Map]",Te="[object Number]",Le="[object Null]",Ie="[object Object]",Pt="[object Promise]",_t="[object Proxy]",nt="[object RegExp]",De="[object Set]",Ye="[object String]",Xe="[object Symbol]",ot="[object Undefined]",qe="[object WeakMap]",Ze="[object WeakSet]",Ne="[object ArrayBuffer]",Ke="[object DataView]",ht="[object Float32Array]",Me="[object Float64Array]",Ct="[object Int8Array]",$t="[object Int16Array]",kt="[object Int32Array]",Ht="[object Uint8Array]",zt="[object Uint8ClampedArray]",Wt="[object Uint16Array]",rr="[object Uint32Array]",jr=/\b__p \+= '';/g,Jt=/\b(__p \+=) '' \+/g,Br=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ai=/&(?:amp|lt|gt|quot|#39);/g,Ii=/[&<>"']/g,lt=RegExp(ai.source),rt=RegExp(Ii.source),ft=/<%-([\s\S]+?)%>/g,pt=/<%([\s\S]+?)%>/g,at=/<%=([\s\S]+?)%>/g,it=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,At=/^\w*$/,Ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,dt=/[\\^$.*+?()[\]{}|]/g,Rt=RegExp(dt.source),gt=/^\s+/,wt=/\s/,vt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Je=/\{\n\/\* \[wrapped with (.+)\] \*/,Tt=/,? & /,Nt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,wo=/[()=,{}\[\]\/\s]/,bo=/\\(\\)?/g,Eo=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,yr=/\w*$/,xo=/^[-+]0x[0-9a-f]+$/i,Io=/^0b[01]+$/i,So=/^\[object .+?Constructor\]$/,Po=/^0o[0-7]+$/i,Co=/^(?:0|[1-9]\d*)$/,Gr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ki=/($^)/,Ao=/['\n\r\u2028\u2029\\]/g,Hi="\\ud800-\\udfff",Oo="\\u0300-\\u036f",Ro="\\ufe20-\\ufe2f",Ki="\\u20d0-\\u20ff",Js=Oo+Ro+Ki,Ys="\\u2700-\\u27bf",Or="a-z\\xdf-\\xf6\\xf8-\\xff",To="\\xac\\xb1\\xd7\\xf7",No="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Lo="\\u2000-\\u206f",Fo=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Xs="A-Z\\xc0-\\xd6\\xd8-\\xde",Zs="\\ufe0e\\ufe0f",Si=To+No+Lo+Fo,gs="[']",Pi="["+Hi+"]",vs="["+Si+"]",Ci="["+Js+"]",Qs="\\d+",Do="["+Ys+"]",en="["+Or+"]",tn="[^"+Hi+Si+Qs+Ys+Or+Xs+"]",Vi="\\ud83c[\\udffb-\\udfff]",$o="(?:"+Ci+"|"+Vi+")",rn="[^"+Hi+"]",Bi="(?:\\ud83c[\\udde6-\\uddff]){2}",ci="[\\ud800-\\udbff][\\udc00-\\udfff]",ur="["+Xs+"]",sn="\\u200d",nn="(?:"+en+"|"+tn+")",zr="(?:"+ur+"|"+tn+")",on="(?:"+gs+"(?:d|ll|m|re|s|t|ve))?",an="(?:"+gs+"(?:D|LL|M|RE|S|T|VE))?",cn=$o+"?",un="["+Zs+"]?",Mo="(?:"+sn+"(?:"+[rn,Bi,ci].join("|")+")"+un+cn+")*",Wr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",hn="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",ln=un+cn+Mo,Gi="(?:"+[Do,Bi,ci].join("|")+")"+ln,jo="(?:"+[rn+Ci+"?",Ci,Bi,ci,Pi].join("|")+")",ys=RegExp(gs,"g"),zo=RegExp(Ci,"g"),Wi=RegExp(Vi+"(?="+Vi+")|"+jo+ln,"g"),fn=RegExp([ur+"?"+en+"+"+on+"(?="+[vs,ur,"$"].join("|")+")",zr+"+"+an+"(?="+[vs,ur+nn,"$"].join("|")+")",ur+"?"+nn+"+"+on,ur+"+"+an,hn,Wr,Qs,Gi].join("|"),"g"),pn=RegExp("["+sn+Hi+Js+Zs+"]"),Ai=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,dn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],qo=-1,Ve={};Ve[ht]=Ve[Me]=Ve[Ct]=Ve[$t]=Ve[kt]=Ve[Ht]=Ve[zt]=Ve[Wt]=Ve[rr]=!0,Ve[_e]=Ve[St]=Ve[Ne]=Ve[A]=Ve[Ke]=Ve[I]=Ve[w]=Ve[Q]=Ve[ye]=Ve[Te]=Ve[Ie]=Ve[nt]=Ve[De]=Ve[Ye]=Ve[qe]=!1;var Ue={};Ue[_e]=Ue[St]=Ue[Ne]=Ue[Ke]=Ue[A]=Ue[I]=Ue[ht]=Ue[Me]=Ue[Ct]=Ue[$t]=Ue[kt]=Ue[ye]=Ue[Te]=Ue[Ie]=Ue[nt]=Ue[De]=Ue[Ye]=Ue[Xe]=Ue[Ht]=Ue[zt]=Ue[Wt]=Ue[rr]=!0,Ue[w]=Ue[Q]=Ue[qe]=!1;var g={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},$={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Y={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Be=parseFloat,le=parseInt,Qe=typeof Hs=="object"&&Hs&&Hs.Object===Object&&Hs,Lt=typeof self=="object"&&self&&self.Object===Object&&self,Pe=Qe||Lt||Function("return this")(),Ge=r&&!r.nodeType&&r,bt=Ge&&!0&&c&&!c.nodeType&&c,ir=bt&&bt.exports===Ge,Ft=ir&&Qe.process,et=function(){try{var E=bt&&bt.require&&bt.require("util").types;return E||Ft&&Ft.binding&&Ft.binding("util")}catch{}}(),Yt=et&&et.isArrayBuffer,Rr=et&&et.isDate,mr=et&&et.isMap,qr=et&&et.isRegExp,ms=et&&et.isSet,Oi=et&&et.isTypedArray;function qt(E,T,P){switch(P.length){case 0:return E.call(T);case 1:return E.call(T,P[0]);case 2:return E.call(T,P[0],P[1]);case 3:return E.call(T,P[0],P[1],P[2])}return E.apply(T,P)}function $f(E,T,P,X){for(var ce=-1,Fe=E==null?0:E.length;++ce<Fe;){var Mt=E[ce];T(X,Mt,P(Mt),E)}return X}function _r(E,T){for(var P=-1,X=E==null?0:E.length;++P<X&&T(E[P],P,E)!==!1;);return E}function Mf(E,T){for(var P=E==null?0:E.length;P--&&T(E[P],P,E)!==!1;);return E}function Oc(E,T){for(var P=-1,X=E==null?0:E.length;++P<X;)if(!T(E[P],P,E))return!1;return!0}function ui(E,T){for(var P=-1,X=E==null?0:E.length,ce=0,Fe=[];++P<X;){var Mt=E[P];T(Mt,P,E)&&(Fe[ce++]=Mt)}return Fe}function gn(E,T){var P=E==null?0:E.length;return!!P&&Ji(E,T,0)>-1}function Uo(E,T,P){for(var X=-1,ce=E==null?0:E.length;++X<ce;)if(P(T,E[X]))return!0;return!1}function st(E,T){for(var P=-1,X=E==null?0:E.length,ce=Array(X);++P<X;)ce[P]=T(E[P],P,E);return ce}function hi(E,T){for(var P=-1,X=T.length,ce=E.length;++P<X;)E[ce+P]=T[P];return E}function ko(E,T,P,X){var ce=-1,Fe=E==null?0:E.length;for(X&&Fe&&(P=E[++ce]);++ce<Fe;)P=T(P,E[ce],ce,E);return P}function jf(E,T,P,X){var ce=E==null?0:E.length;for(X&&ce&&(P=E[--ce]);ce--;)P=T(P,E[ce],ce,E);return P}function Ho(E,T){for(var P=-1,X=E==null?0:E.length;++P<X;)if(T(E[P],P,E))return!0;return!1}var zf=Ko("length");function qf(E){return E.split("")}function Uf(E){return E.match(Nt)||[]}function Rc(E,T,P){var X;return P(E,function(ce,Fe,Mt){if(T(ce,Fe,Mt))return X=Fe,!1}),X}function vn(E,T,P,X){for(var ce=E.length,Fe=P+(X?1:-1);X?Fe--:++Fe<ce;)if(T(E[Fe],Fe,E))return Fe;return-1}function Ji(E,T,P){return T===T?Qf(E,T,P):vn(E,Tc,P)}function kf(E,T,P,X){for(var ce=P-1,Fe=E.length;++ce<Fe;)if(X(E[ce],T))return ce;return-1}function Tc(E){return E!==E}function Nc(E,T){var P=E==null?0:E.length;return P?Bo(E,T)/P:z}function Ko(E){return function(T){return T==null?i:T[E]}}function Vo(E){return function(T){return E==null?i:E[T]}}function Lc(E,T,P,X,ce){return ce(E,function(Fe,Mt,We){P=X?(X=!1,Fe):T(P,Fe,Mt,We)}),P}function Hf(E,T){var P=E.length;for(E.sort(T);P--;)E[P]=E[P].value;return E}function Bo(E,T){for(var P,X=-1,ce=E.length;++X<ce;){var Fe=T(E[X]);Fe!==i&&(P=P===i?Fe:P+Fe)}return P}function Go(E,T){for(var P=-1,X=Array(E);++P<E;)X[P]=T(P);return X}function Kf(E,T){return st(T,function(P){return[P,E[P]]})}function Fc(E){return E&&E.slice(0,jc(E)+1).replace(gt,"")}function hr(E){return function(T){return E(T)}}function Wo(E,T){return st(T,function(P){return E[P]})}function _s(E,T){return E.has(T)}function Dc(E,T){for(var P=-1,X=E.length;++P<X&&Ji(T,E[P],0)>-1;);return P}function $c(E,T){for(var P=E.length;P--&&Ji(T,E[P],0)>-1;);return P}function Vf(E,T){for(var P=E.length,X=0;P--;)E[P]===T&&++X;return X}var Bf=Vo(g),Gf=Vo(b);function Wf(E){return"\\"+Y[E]}function Jf(E,T){return E==null?i:E[T]}function Yi(E){return pn.test(E)}function Yf(E){return Ai.test(E)}function Xf(E){for(var T,P=[];!(T=E.next()).done;)P.push(T.value);return P}function Jo(E){var T=-1,P=Array(E.size);return E.forEach(function(X,ce){P[++T]=[ce,X]}),P}function Mc(E,T){return function(P){return E(T(P))}}function li(E,T){for(var P=-1,X=E.length,ce=0,Fe=[];++P<X;){var Mt=E[P];(Mt===T||Mt===F)&&(E[P]=F,Fe[ce++]=P)}return Fe}function yn(E){var T=-1,P=Array(E.size);return E.forEach(function(X){P[++T]=X}),P}function Zf(E){var T=-1,P=Array(E.size);return E.forEach(function(X){P[++T]=[X,X]}),P}function Qf(E,T,P){for(var X=P-1,ce=E.length;++X<ce;)if(E[X]===T)return X;return-1}function ep(E,T,P){for(var X=P+1;X--;)if(E[X]===T)return X;return X}function Xi(E){return Yi(E)?rp(E):zf(E)}function Tr(E){return Yi(E)?ip(E):qf(E)}function jc(E){for(var T=E.length;T--&&wt.test(E.charAt(T)););return T}var tp=Vo($);function rp(E){for(var T=Wi.lastIndex=0;Wi.test(E);)++T;return T}function ip(E){return E.match(Wi)||[]}function sp(E){return E.match(fn)||[]}var np=function E(T){T=T==null?Pe:Zi.defaults(Pe.Object(),T,Zi.pick(Pe,dn));var P=T.Array,X=T.Date,ce=T.Error,Fe=T.Function,Mt=T.Math,We=T.Object,Yo=T.RegExp,op=T.String,wr=T.TypeError,mn=P.prototype,ap=Fe.prototype,Qi=We.prototype,_n=T["__core-js_shared__"],wn=ap.toString,je=Qi.hasOwnProperty,cp=0,zc=function(){var e=/[^.]+$/.exec(_n&&_n.keys&&_n.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),bn=Qi.toString,up=wn.call(We),hp=Pe._,lp=Yo("^"+wn.call(je).replace(dt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),En=ir?T.Buffer:i,fi=T.Symbol,xn=T.Uint8Array,qc=En?En.allocUnsafe:i,In=Mc(We.getPrototypeOf,We),Uc=We.create,kc=Qi.propertyIsEnumerable,Sn=mn.splice,Hc=fi?fi.isConcatSpreadable:i,ws=fi?fi.iterator:i,Ri=fi?fi.toStringTag:i,Pn=function(){try{var e=Di(We,"defineProperty");return e({},"",{}),e}catch{}}(),fp=T.clearTimeout!==Pe.clearTimeout&&T.clearTimeout,pp=X&&X.now!==Pe.Date.now&&X.now,dp=T.setTimeout!==Pe.setTimeout&&T.setTimeout,Cn=Mt.ceil,An=Mt.floor,Xo=We.getOwnPropertySymbols,gp=En?En.isBuffer:i,Kc=T.isFinite,vp=mn.join,yp=Mc(We.keys,We),jt=Mt.max,Bt=Mt.min,mp=X.now,_p=T.parseInt,Vc=Mt.random,wp=mn.reverse,Zo=Di(T,"DataView"),bs=Di(T,"Map"),Qo=Di(T,"Promise"),es=Di(T,"Set"),Es=Di(T,"WeakMap"),xs=Di(We,"create"),On=Es&&new Es,ts={},bp=$i(Zo),Ep=$i(bs),xp=$i(Qo),Ip=$i(es),Sp=$i(Es),Rn=fi?fi.prototype:i,Is=Rn?Rn.valueOf:i,Bc=Rn?Rn.toString:i;function f(e){if(yt(e)&&!fe(e)&&!(e instanceof Se)){if(e instanceof br)return e;if(je.call(e,"__wrapped__"))return Gu(e)}return new br(e)}var rs=function(){function e(){}return function(t){if(!ct(t))return{};if(Uc)return Uc(t);e.prototype=t;var s=new e;return e.prototype=i,s}}();function Tn(){}function br(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=i}f.templateSettings={escape:ft,evaluate:pt,interpolate:at,variable:"",imports:{_:f}},f.prototype=Tn.prototype,f.prototype.constructor=f,br.prototype=rs(Tn.prototype),br.prototype.constructor=br;function Se(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=k,this.__views__=[]}function Pp(){var e=new Se(this.__wrapped__);return e.__actions__=sr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=sr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=sr(this.__views__),e}function Cp(){if(this.__filtered__){var e=new Se(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function Ap(){var e=this.__wrapped__.value(),t=this.__dir__,s=fe(e),a=t<0,h=s?e.length:0,p=qd(0,h,this.__views__),y=p.start,m=p.end,x=m-y,N=a?m:y-1,L=this.__iteratees__,M=L.length,H=0,ee=Bt(x,this.__takeCount__);if(!s||!a&&h==x&&ee==x)return vu(e,this.__actions__);var se=[];e:for(;x--&&H<ee;){N+=t;for(var me=-1,ne=e[N];++me<M;){var xe=L[me],Ce=xe.iteratee,pr=xe.type,Qt=Ce(ne);if(pr==D)ne=Qt;else if(!Qt){if(pr==C)continue e;break e}}se[H++]=ne}return se}Se.prototype=rs(Tn.prototype),Se.prototype.constructor=Se;function Ti(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var a=e[t];this.set(a[0],a[1])}}function Op(){this.__data__=xs?xs(null):{},this.size=0}function Rp(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function Tp(e){var t=this.__data__;if(xs){var s=t[e];return s===_?i:s}return je.call(t,e)?t[e]:i}function Np(e){var t=this.__data__;return xs?t[e]!==i:je.call(t,e)}function Lp(e,t){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=xs&&t===i?_:t,this}Ti.prototype.clear=Op,Ti.prototype.delete=Rp,Ti.prototype.get=Tp,Ti.prototype.has=Np,Ti.prototype.set=Lp;function Jr(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var a=e[t];this.set(a[0],a[1])}}function Fp(){this.__data__=[],this.size=0}function Dp(e){var t=this.__data__,s=Nn(t,e);if(s<0)return!1;var a=t.length-1;return s==a?t.pop():Sn.call(t,s,1),--this.size,!0}function $p(e){var t=this.__data__,s=Nn(t,e);return s<0?i:t[s][1]}function Mp(e){return Nn(this.__data__,e)>-1}function jp(e,t){var s=this.__data__,a=Nn(s,e);return a<0?(++this.size,s.push([e,t])):s[a][1]=t,this}Jr.prototype.clear=Fp,Jr.prototype.delete=Dp,Jr.prototype.get=$p,Jr.prototype.has=Mp,Jr.prototype.set=jp;function Yr(e){var t=-1,s=e==null?0:e.length;for(this.clear();++t<s;){var a=e[t];this.set(a[0],a[1])}}function zp(){this.size=0,this.__data__={hash:new Ti,map:new(bs||Jr),string:new Ti}}function qp(e){var t=Kn(this,e).delete(e);return this.size-=t?1:0,t}function Up(e){return Kn(this,e).get(e)}function kp(e){return Kn(this,e).has(e)}function Hp(e,t){var s=Kn(this,e),a=s.size;return s.set(e,t),this.size+=s.size==a?0:1,this}Yr.prototype.clear=zp,Yr.prototype.delete=qp,Yr.prototype.get=Up,Yr.prototype.has=kp,Yr.prototype.set=Hp;function Ni(e){var t=-1,s=e==null?0:e.length;for(this.__data__=new Yr;++t<s;)this.add(e[t])}function Kp(e){return this.__data__.set(e,_),this}function Vp(e){return this.__data__.has(e)}Ni.prototype.add=Ni.prototype.push=Kp,Ni.prototype.has=Vp;function Nr(e){var t=this.__data__=new Jr(e);this.size=t.size}function Bp(){this.__data__=new Jr,this.size=0}function Gp(e){var t=this.__data__,s=t.delete(e);return this.size=t.size,s}function Wp(e){return this.__data__.get(e)}function Jp(e){return this.__data__.has(e)}function Yp(e,t){var s=this.__data__;if(s instanceof Jr){var a=s.__data__;if(!bs||a.length<o-1)return a.push([e,t]),this.size=++s.size,this;s=this.__data__=new Yr(a)}return s.set(e,t),this.size=s.size,this}Nr.prototype.clear=Bp,Nr.prototype.delete=Gp,Nr.prototype.get=Wp,Nr.prototype.has=Jp,Nr.prototype.set=Yp;function Gc(e,t){var s=fe(e),a=!s&&Mi(e),h=!s&&!a&&yi(e),p=!s&&!a&&!h&&os(e),y=s||a||h||p,m=y?Go(e.length,op):[],x=m.length;for(var N in e)(t||je.call(e,N))&&!(y&&(N=="length"||h&&(N=="offset"||N=="parent")||p&&(N=="buffer"||N=="byteLength"||N=="byteOffset")||ei(N,x)))&&m.push(N);return m}function Wc(e){var t=e.length;return t?e[ha(0,t-1)]:i}function Xp(e,t){return Vn(sr(e),Li(t,0,e.length))}function Zp(e){return Vn(sr(e))}function ea(e,t,s){(s!==i&&!Lr(e[t],s)||s===i&&!(t in e))&&Xr(e,t,s)}function Ss(e,t,s){var a=e[t];(!(je.call(e,t)&&Lr(a,s))||s===i&&!(t in e))&&Xr(e,t,s)}function Nn(e,t){for(var s=e.length;s--;)if(Lr(e[s][0],t))return s;return-1}function Qp(e,t,s,a){return pi(e,function(h,p,y){t(a,h,s(h),y)}),a}function Jc(e,t){return e&&kr(t,Ut(t),e)}function ed(e,t){return e&&kr(t,or(t),e)}function Xr(e,t,s){t=="__proto__"&&Pn?Pn(e,t,{configurable:!0,enumerable:!0,value:s,writable:!0}):e[t]=s}function ta(e,t){for(var s=-1,a=t.length,h=P(a),p=e==null;++s<a;)h[s]=p?i:Da(e,t[s]);return h}function Li(e,t,s){return e===e&&(s!==i&&(e=e<=s?e:s),t!==i&&(e=e>=t?e:t)),e}function Er(e,t,s,a,h,p){var y,m=t&G,x=t&W,N=t&V;if(s&&(y=h?s(e,a,h,p):s(e)),y!==i)return y;if(!ct(e))return e;var L=fe(e);if(L){if(y=kd(e),!m)return sr(e,y)}else{var M=Gt(e),H=M==Q||M==ae;if(yi(e))return _u(e,m);if(M==Ie||M==_e||H&&!h){if(y=x||H?{}:ju(e),!m)return x?Td(e,ed(y,e)):Rd(e,Jc(y,e))}else{if(!Ue[M])return h?e:{};y=Hd(e,M,m)}}p||(p=new Nr);var ee=p.get(e);if(ee)return ee;p.set(e,y),ph(e)?e.forEach(function(ne){y.add(Er(ne,t,s,ne,e,p))}):lh(e)&&e.forEach(function(ne,xe){y.set(xe,Er(ne,t,s,xe,e,p))});var se=N?x?ba:wa:x?or:Ut,me=L?i:se(e);return _r(me||e,function(ne,xe){me&&(xe=ne,ne=e[xe]),Ss(y,xe,Er(ne,t,s,xe,e,p))}),y}function td(e){var t=Ut(e);return function(s){return Yc(s,e,t)}}function Yc(e,t,s){var a=s.length;if(e==null)return!a;for(e=We(e);a--;){var h=s[a],p=t[h],y=e[h];if(y===i&&!(h in e)||!p(y))return!1}return!0}function Xc(e,t,s){if(typeof e!="function")throw new wr(d);return Ns(function(){e.apply(i,s)},t)}function Ps(e,t,s,a){var h=-1,p=gn,y=!0,m=e.length,x=[],N=t.length;if(!m)return x;s&&(t=st(t,hr(s))),a?(p=Uo,y=!1):t.length>=o&&(p=_s,y=!1,t=new Ni(t));e:for(;++h<m;){var L=e[h],M=s==null?L:s(L);if(L=a||L!==0?L:0,y&&M===M){for(var H=N;H--;)if(t[H]===M)continue e;x.push(L)}else p(t,M,a)||x.push(L)}return x}var pi=Iu(Ur),Zc=Iu(ia,!0);function rd(e,t){var s=!0;return pi(e,function(a,h,p){return s=!!t(a,h,p),s}),s}function Ln(e,t,s){for(var a=-1,h=e.length;++a<h;){var p=e[a],y=t(p);if(y!=null&&(m===i?y===y&&!fr(y):s(y,m)))var m=y,x=p}return x}function id(e,t,s,a){var h=e.length;for(s=ve(s),s<0&&(s=-s>h?0:h+s),a=a===i||a>h?h:ve(a),a<0&&(a+=h),a=s>a?0:gh(a);s<a;)e[s++]=t;return e}function Qc(e,t){var s=[];return pi(e,function(a,h,p){t(a,h,p)&&s.push(a)}),s}function Kt(e,t,s,a,h){var p=-1,y=e.length;for(s||(s=Vd),h||(h=[]);++p<y;){var m=e[p];t>0&&s(m)?t>1?Kt(m,t-1,s,a,h):hi(h,m):a||(h[h.length]=m)}return h}var ra=Su(),eu=Su(!0);function Ur(e,t){return e&&ra(e,t,Ut)}function ia(e,t){return e&&eu(e,t,Ut)}function Fn(e,t){return ui(t,function(s){return ti(e[s])})}function Fi(e,t){t=gi(t,e);for(var s=0,a=t.length;e!=null&&s<a;)e=e[Hr(t[s++])];return s&&s==a?e:i}function tu(e,t,s){var a=t(e);return fe(e)?a:hi(a,s(e))}function Xt(e){return e==null?e===i?ot:Le:Ri&&Ri in We(e)?zd(e):Zd(e)}function sa(e,t){return e>t}function sd(e,t){return e!=null&&je.call(e,t)}function nd(e,t){return e!=null&&t in We(e)}function od(e,t,s){return e>=Bt(t,s)&&e<jt(t,s)}function na(e,t,s){for(var a=s?Uo:gn,h=e[0].length,p=e.length,y=p,m=P(p),x=1/0,N=[];y--;){var L=e[y];y&&t&&(L=st(L,hr(t))),x=Bt(L.length,x),m[y]=!s&&(t||h>=120&&L.length>=120)?new Ni(y&&L):i}L=e[0];var M=-1,H=m[0];e:for(;++M<h&&N.length<x;){var ee=L[M],se=t?t(ee):ee;if(ee=s||ee!==0?ee:0,!(H?_s(H,se):a(N,se,s))){for(y=p;--y;){var me=m[y];if(!(me?_s(me,se):a(e[y],se,s)))continue e}H&&H.push(se),N.push(ee)}}return N}function ad(e,t,s,a){return Ur(e,function(h,p,y){t(a,s(h),p,y)}),a}function Cs(e,t,s){t=gi(t,e),e=ku(e,t);var a=e==null?e:e[Hr(Ir(t))];return a==null?i:qt(a,e,s)}function ru(e){return yt(e)&&Xt(e)==_e}function cd(e){return yt(e)&&Xt(e)==Ne}function ud(e){return yt(e)&&Xt(e)==I}function As(e,t,s,a,h){return e===t?!0:e==null||t==null||!yt(e)&&!yt(t)?e!==e&&t!==t:hd(e,t,s,a,As,h)}function hd(e,t,s,a,h,p){var y=fe(e),m=fe(t),x=y?St:Gt(e),N=m?St:Gt(t);x=x==_e?Ie:x,N=N==_e?Ie:N;var L=x==Ie,M=N==Ie,H=x==N;if(H&&yi(e)){if(!yi(t))return!1;y=!0,L=!1}if(H&&!L)return p||(p=new Nr),y||os(e)?Du(e,t,s,a,h,p):Md(e,t,x,s,a,h,p);if(!(s&q)){var ee=L&&je.call(e,"__wrapped__"),se=M&&je.call(t,"__wrapped__");if(ee||se){var me=ee?e.value():e,ne=se?t.value():t;return p||(p=new Nr),h(me,ne,s,a,p)}}return H?(p||(p=new Nr),jd(e,t,s,a,h,p)):!1}function ld(e){return yt(e)&&Gt(e)==ye}function oa(e,t,s,a){var h=s.length,p=h,y=!a;if(e==null)return!p;for(e=We(e);h--;){var m=s[h];if(y&&m[2]?m[1]!==e[m[0]]:!(m[0]in e))return!1}for(;++h<p;){m=s[h];var x=m[0],N=e[x],L=m[1];if(y&&m[2]){if(N===i&&!(x in e))return!1}else{var M=new Nr;if(a)var H=a(N,L,x,e,t,M);if(!(H===i?As(L,N,q|K,a,M):H))return!1}}return!0}function iu(e){if(!ct(e)||Gd(e))return!1;var t=ti(e)?lp:So;return t.test($i(e))}function fd(e){return yt(e)&&Xt(e)==nt}function pd(e){return yt(e)&&Gt(e)==De}function dd(e){return yt(e)&&Xn(e.length)&&!!Ve[Xt(e)]}function su(e){return typeof e=="function"?e:e==null?ar:typeof e=="object"?fe(e)?au(e[0],e[1]):ou(e):Ph(e)}function aa(e){if(!Ts(e))return yp(e);var t=[];for(var s in We(e))je.call(e,s)&&s!="constructor"&&t.push(s);return t}function gd(e){if(!ct(e))return Xd(e);var t=Ts(e),s=[];for(var a in e)a=="constructor"&&(t||!je.call(e,a))||s.push(a);return s}function ca(e,t){return e<t}function nu(e,t){var s=-1,a=nr(e)?P(e.length):[];return pi(e,function(h,p,y){a[++s]=t(h,p,y)}),a}function ou(e){var t=xa(e);return t.length==1&&t[0][2]?qu(t[0][0],t[0][1]):function(s){return s===e||oa(s,e,t)}}function au(e,t){return Sa(e)&&zu(t)?qu(Hr(e),t):function(s){var a=Da(s,e);return a===i&&a===t?$a(s,e):As(t,a,q|K)}}function Dn(e,t,s,a,h){e!==t&&ra(t,function(p,y){if(h||(h=new Nr),ct(p))vd(e,t,y,s,Dn,a,h);else{var m=a?a(Ca(e,y),p,y+"",e,t,h):i;m===i&&(m=p),ea(e,y,m)}},or)}function vd(e,t,s,a,h,p,y){var m=Ca(e,s),x=Ca(t,s),N=y.get(x);if(N){ea(e,s,N);return}var L=p?p(m,x,s+"",e,t,y):i,M=L===i;if(M){var H=fe(x),ee=!H&&yi(x),se=!H&&!ee&&os(x);L=x,H||ee||se?fe(m)?L=m:Et(m)?L=sr(m):ee?(M=!1,L=_u(x,!0)):se?(M=!1,L=wu(x,!0)):L=[]:Ls(x)||Mi(x)?(L=m,Mi(m)?L=vh(m):(!ct(m)||ti(m))&&(L=ju(x))):M=!1}M&&(y.set(x,L),h(L,x,a,p,y),y.delete(x)),ea(e,s,L)}function cu(e,t){var s=e.length;if(s)return t+=t<0?s:0,ei(t,s)?e[t]:i}function uu(e,t,s){t.length?t=st(t,function(p){return fe(p)?function(y){return Fi(y,p.length===1?p[0]:p)}:p}):t=[ar];var a=-1;t=st(t,hr(re()));var h=nu(e,function(p,y,m){var x=st(t,function(N){return N(p)});return{criteria:x,index:++a,value:p}});return Hf(h,function(p,y){return Od(p,y,s)})}function yd(e,t){return hu(e,t,function(s,a){return $a(e,a)})}function hu(e,t,s){for(var a=-1,h=t.length,p={};++a<h;){var y=t[a],m=Fi(e,y);s(m,y)&&Os(p,gi(y,e),m)}return p}function md(e){return function(t){return Fi(t,e)}}function ua(e,t,s,a){var h=a?kf:Ji,p=-1,y=t.length,m=e;for(e===t&&(t=sr(t)),s&&(m=st(e,hr(s)));++p<y;)for(var x=0,N=t[p],L=s?s(N):N;(x=h(m,L,x,a))>-1;)m!==e&&Sn.call(m,x,1),Sn.call(e,x,1);return e}function lu(e,t){for(var s=e?t.length:0,a=s-1;s--;){var h=t[s];if(s==a||h!==p){var p=h;ei(h)?Sn.call(e,h,1):pa(e,h)}}return e}function ha(e,t){return e+An(Vc()*(t-e+1))}function _d(e,t,s,a){for(var h=-1,p=jt(Cn((t-e)/(s||1)),0),y=P(p);p--;)y[a?p:++h]=e,e+=s;return y}function la(e,t){var s="";if(!e||t<1||t>J)return s;do t%2&&(s+=e),t=An(t/2),t&&(e+=e);while(t);return s}function we(e,t){return Aa(Uu(e,t,ar),e+"")}function wd(e){return Wc(as(e))}function bd(e,t){var s=as(e);return Vn(s,Li(t,0,s.length))}function Os(e,t,s,a){if(!ct(e))return e;t=gi(t,e);for(var h=-1,p=t.length,y=p-1,m=e;m!=null&&++h<p;){var x=Hr(t[h]),N=s;if(x==="__proto__"||x==="constructor"||x==="prototype")return e;if(h!=y){var L=m[x];N=a?a(L,x,m):i,N===i&&(N=ct(L)?L:ei(t[h+1])?[]:{})}Ss(m,x,N),m=m[x]}return e}var fu=On?function(e,t){return On.set(e,t),e}:ar,Ed=Pn?function(e,t){return Pn(e,"toString",{configurable:!0,enumerable:!1,value:ja(t),writable:!0})}:ar;function xd(e){return Vn(as(e))}function xr(e,t,s){var a=-1,h=e.length;t<0&&(t=-t>h?0:h+t),s=s>h?h:s,s<0&&(s+=h),h=t>s?0:s-t>>>0,t>>>=0;for(var p=P(h);++a<h;)p[a]=e[a+t];return p}function Id(e,t){var s;return pi(e,function(a,h,p){return s=t(a,h,p),!s}),!!s}function $n(e,t,s){var a=0,h=e==null?a:e.length;if(typeof t=="number"&&t===t&&h<=He){for(;a<h;){var p=a+h>>>1,y=e[p];y!==null&&!fr(y)&&(s?y<=t:y<t)?a=p+1:h=p}return h}return fa(e,t,ar,s)}function fa(e,t,s,a){var h=0,p=e==null?0:e.length;if(p===0)return 0;t=s(t);for(var y=t!==t,m=t===null,x=fr(t),N=t===i;h<p;){var L=An((h+p)/2),M=s(e[L]),H=M!==i,ee=M===null,se=M===M,me=fr(M);if(y)var ne=a||se;else N?ne=se&&(a||H):m?ne=se&&H&&(a||!ee):x?ne=se&&H&&!ee&&(a||!me):ee||me?ne=!1:ne=a?M<=t:M<t;ne?h=L+1:p=L}return Bt(p,ut)}function pu(e,t){for(var s=-1,a=e.length,h=0,p=[];++s<a;){var y=e[s],m=t?t(y):y;if(!s||!Lr(m,x)){var x=m;p[h++]=y===0?0:y}}return p}function du(e){return typeof e=="number"?e:fr(e)?z:+e}function lr(e){if(typeof e=="string")return e;if(fe(e))return st(e,lr)+"";if(fr(e))return Bc?Bc.call(e):"";var t=e+"";return t=="0"&&1/e==-Re?"-0":t}function di(e,t,s){var a=-1,h=gn,p=e.length,y=!0,m=[],x=m;if(s)y=!1,h=Uo;else if(p>=o){var N=t?null:Dd(e);if(N)return yn(N);y=!1,h=_s,x=new Ni}else x=t?[]:m;e:for(;++a<p;){var L=e[a],M=t?t(L):L;if(L=s||L!==0?L:0,y&&M===M){for(var H=x.length;H--;)if(x[H]===M)continue e;t&&x.push(M),m.push(L)}else h(x,M,s)||(x!==m&&x.push(M),m.push(L))}return m}function pa(e,t){return t=gi(t,e),e=ku(e,t),e==null||delete e[Hr(Ir(t))]}function gu(e,t,s,a){return Os(e,t,s(Fi(e,t)),a)}function Mn(e,t,s,a){for(var h=e.length,p=a?h:-1;(a?p--:++p<h)&&t(e[p],p,e););return s?xr(e,a?0:p,a?p+1:h):xr(e,a?p+1:0,a?h:p)}function vu(e,t){var s=e;return s instanceof Se&&(s=s.value()),ko(t,function(a,h){return h.func.apply(h.thisArg,hi([a],h.args))},s)}function da(e,t,s){var a=e.length;if(a<2)return a?di(e[0]):[];for(var h=-1,p=P(a);++h<a;)for(var y=e[h],m=-1;++m<a;)m!=h&&(p[h]=Ps(p[h]||y,e[m],t,s));return di(Kt(p,1),t,s)}function yu(e,t,s){for(var a=-1,h=e.length,p=t.length,y={};++a<h;){var m=a<p?t[a]:i;s(y,e[a],m)}return y}function ga(e){return Et(e)?e:[]}function va(e){return typeof e=="function"?e:ar}function gi(e,t){return fe(e)?e:Sa(e,t)?[e]:Bu($e(e))}var Sd=we;function vi(e,t,s){var a=e.length;return s=s===i?a:s,!t&&s>=a?e:xr(e,t,s)}var mu=fp||function(e){return Pe.clearTimeout(e)};function _u(e,t){if(t)return e.slice();var s=e.length,a=qc?qc(s):new e.constructor(s);return e.copy(a),a}function ya(e){var t=new e.constructor(e.byteLength);return new xn(t).set(new xn(e)),t}function Pd(e,t){var s=t?ya(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.byteLength)}function Cd(e){var t=new e.constructor(e.source,yr.exec(e));return t.lastIndex=e.lastIndex,t}function Ad(e){return Is?We(Is.call(e)):{}}function wu(e,t){var s=t?ya(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.length)}function bu(e,t){if(e!==t){var s=e!==i,a=e===null,h=e===e,p=fr(e),y=t!==i,m=t===null,x=t===t,N=fr(t);if(!m&&!N&&!p&&e>t||p&&y&&x&&!m&&!N||a&&y&&x||!s&&x||!h)return 1;if(!a&&!p&&!N&&e<t||N&&s&&h&&!a&&!p||m&&s&&h||!y&&h||!x)return-1}return 0}function Od(e,t,s){for(var a=-1,h=e.criteria,p=t.criteria,y=h.length,m=s.length;++a<y;){var x=bu(h[a],p[a]);if(x){if(a>=m)return x;var N=s[a];return x*(N=="desc"?-1:1)}}return e.index-t.index}function Eu(e,t,s,a){for(var h=-1,p=e.length,y=s.length,m=-1,x=t.length,N=jt(p-y,0),L=P(x+N),M=!a;++m<x;)L[m]=t[m];for(;++h<y;)(M||h<p)&&(L[s[h]]=e[h]);for(;N--;)L[m++]=e[h++];return L}function xu(e,t,s,a){for(var h=-1,p=e.length,y=-1,m=s.length,x=-1,N=t.length,L=jt(p-m,0),M=P(L+N),H=!a;++h<L;)M[h]=e[h];for(var ee=h;++x<N;)M[ee+x]=t[x];for(;++y<m;)(H||h<p)&&(M[ee+s[y]]=e[h++]);return M}function sr(e,t){var s=-1,a=e.length;for(t||(t=P(a));++s<a;)t[s]=e[s];return t}function kr(e,t,s,a){var h=!s;s||(s={});for(var p=-1,y=t.length;++p<y;){var m=t[p],x=a?a(s[m],e[m],m,s,e):i;x===i&&(x=e[m]),h?Xr(s,m,x):Ss(s,m,x)}return s}function Rd(e,t){return kr(e,Ia(e),t)}function Td(e,t){return kr(e,$u(e),t)}function jn(e,t){return function(s,a){var h=fe(s)?$f:Qp,p=t?t():{};return h(s,e,re(a,2),p)}}function is(e){return we(function(t,s){var a=-1,h=s.length,p=h>1?s[h-1]:i,y=h>2?s[2]:i;for(p=e.length>3&&typeof p=="function"?(h--,p):i,y&&Zt(s[0],s[1],y)&&(p=h<3?i:p,h=1),t=We(t);++a<h;){var m=s[a];m&&e(t,m,a,p)}return t})}function Iu(e,t){return function(s,a){if(s==null)return s;if(!nr(s))return e(s,a);for(var h=s.length,p=t?h:-1,y=We(s);(t?p--:++p<h)&&a(y[p],p,y)!==!1;);return s}}function Su(e){return function(t,s,a){for(var h=-1,p=We(t),y=a(t),m=y.length;m--;){var x=y[e?m:++h];if(s(p[x],x,p)===!1)break}return t}}function Nd(e,t,s){var a=t&oe,h=Rs(e);function p(){var y=this&&this!==Pe&&this instanceof p?h:e;return y.apply(a?s:this,arguments)}return p}function Pu(e){return function(t){t=$e(t);var s=Yi(t)?Tr(t):i,a=s?s[0]:t.charAt(0),h=s?vi(s,1).join(""):t.slice(1);return a[e]()+h}}function ss(e){return function(t){return ko(Ih(xh(t).replace(ys,"")),e,"")}}function Rs(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var s=rs(e.prototype),a=e.apply(s,t);return ct(a)?a:s}}function Ld(e,t,s){var a=Rs(e);function h(){for(var p=arguments.length,y=P(p),m=p,x=ns(h);m--;)y[m]=arguments[m];var N=p<3&&y[0]!==x&&y[p-1]!==x?[]:li(y,x);if(p-=N.length,p<s)return Tu(e,t,zn,h.placeholder,i,y,N,i,i,s-p);var L=this&&this!==Pe&&this instanceof h?a:e;return qt(L,this,y)}return h}function Cu(e){return function(t,s,a){var h=We(t);if(!nr(t)){var p=re(s,3);t=Ut(t),s=function(m){return p(h[m],m,h)}}var y=e(t,s,a);return y>-1?h[p?t[y]:y]:i}}function Au(e){return Qr(function(t){var s=t.length,a=s,h=br.prototype.thru;for(e&&t.reverse();a--;){var p=t[a];if(typeof p!="function")throw new wr(d);if(h&&!y&&Hn(p)=="wrapper")var y=new br([],!0)}for(a=y?a:s;++a<s;){p=t[a];var m=Hn(p),x=m=="wrapper"?Ea(p):i;x&&Pa(x[0])&&x[1]==(j|pe|he|B)&&!x[4].length&&x[9]==1?y=y[Hn(x[0])].apply(y,x[3]):y=p.length==1&&Pa(p)?y[m]():y.thru(p)}return function(){var N=arguments,L=N[0];if(y&&N.length==1&&fe(L))return y.plant(L).value();for(var M=0,H=s?t[M].apply(this,N):L;++M<s;)H=t[M].call(this,H);return H}})}function zn(e,t,s,a,h,p,y,m,x,N){var L=t&j,M=t&oe,H=t&be,ee=t&(pe|ue),se=t&ge,me=H?i:Rs(e);function ne(){for(var xe=arguments.length,Ce=P(xe),pr=xe;pr--;)Ce[pr]=arguments[pr];if(ee)var Qt=ns(ne),dr=Vf(Ce,Qt);if(a&&(Ce=Eu(Ce,a,h,ee)),p&&(Ce=xu(Ce,p,y,ee)),xe-=dr,ee&&xe<N){var xt=li(Ce,Qt);return Tu(e,t,zn,ne.placeholder,s,Ce,xt,m,x,N-xe)}var Fr=M?s:this,ii=H?Fr[e]:e;return xe=Ce.length,m?Ce=Qd(Ce,m):se&&xe>1&&Ce.reverse(),L&&x<xe&&(Ce.length=x),this&&this!==Pe&&this instanceof ne&&(ii=me||Rs(ii)),ii.apply(Fr,Ce)}return ne}function Ou(e,t){return function(s,a){return ad(s,e,t(a),{})}}function qn(e,t){return function(s,a){var h;if(s===i&&a===i)return t;if(s!==i&&(h=s),a!==i){if(h===i)return a;typeof s=="string"||typeof a=="string"?(s=lr(s),a=lr(a)):(s=du(s),a=du(a)),h=e(s,a)}return h}}function ma(e){return Qr(function(t){return t=st(t,hr(re())),we(function(s){var a=this;return e(t,function(h){return qt(h,a,s)})})})}function Un(e,t){t=t===i?" ":lr(t);var s=t.length;if(s<2)return s?la(t,e):t;var a=la(t,Cn(e/Xi(t)));return Yi(t)?vi(Tr(a),0,e).join(""):a.slice(0,e)}function Fd(e,t,s,a){var h=t&oe,p=Rs(e);function y(){for(var m=-1,x=arguments.length,N=-1,L=a.length,M=P(L+x),H=this&&this!==Pe&&this instanceof y?p:e;++N<L;)M[N]=a[N];for(;x--;)M[N++]=arguments[++m];return qt(H,h?s:this,M)}return y}function Ru(e){return function(t,s,a){return a&&typeof a!="number"&&Zt(t,s,a)&&(s=a=i),t=ri(t),s===i?(s=t,t=0):s=ri(s),a=a===i?t<s?1:-1:ri(a),_d(t,s,a,e)}}function kn(e){return function(t,s){return typeof t=="string"&&typeof s=="string"||(t=Sr(t),s=Sr(s)),e(t,s)}}function Tu(e,t,s,a,h,p,y,m,x,N){var L=t&pe,M=L?y:i,H=L?i:y,ee=L?p:i,se=L?i:p;t|=L?he:R,t&=~(L?R:he),t&de||(t&=~(oe|be));var me=[e,t,h,ee,M,se,H,m,x,N],ne=s.apply(i,me);return Pa(e)&&Hu(ne,me),ne.placeholder=a,Ku(ne,e,t)}function _a(e){var t=Mt[e];return function(s,a){if(s=Sr(s),a=a==null?0:Bt(ve(a),292),a&&Kc(s)){var h=($e(s)+"e").split("e"),p=t(h[0]+"e"+(+h[1]+a));return h=($e(p)+"e").split("e"),+(h[0]+"e"+(+h[1]-a))}return t(s)}}var Dd=es&&1/yn(new es([,-0]))[1]==Re?function(e){return new es(e)}:Ua;function Nu(e){return function(t){var s=Gt(t);return s==ye?Jo(t):s==De?Zf(t):Kf(t,e(t))}}function Zr(e,t,s,a,h,p,y,m){var x=t&be;if(!x&&typeof e!="function")throw new wr(d);var N=a?a.length:0;if(N||(t&=~(he|R),a=h=i),y=y===i?y:jt(ve(y),0),m=m===i?m:ve(m),N-=h?h.length:0,t&R){var L=a,M=h;a=h=i}var H=x?i:Ea(e),ee=[e,t,s,a,h,L,M,p,y,m];if(H&&Yd(ee,H),e=ee[0],t=ee[1],s=ee[2],a=ee[3],h=ee[4],m=ee[9]=ee[9]===i?x?0:e.length:jt(ee[9]-N,0),!m&&t&(pe|ue)&&(t&=~(pe|ue)),!t||t==oe)var se=Nd(e,t,s);else t==pe||t==ue?se=Ld(e,t,m):(t==he||t==(oe|he))&&!h.length?se=Fd(e,t,s,a):se=zn.apply(i,ee);var me=H?fu:Hu;return Ku(me(se,ee),e,t)}function Lu(e,t,s,a){return e===i||Lr(e,Qi[s])&&!je.call(a,s)?t:e}function Fu(e,t,s,a,h,p){return ct(e)&&ct(t)&&(p.set(t,e),Dn(e,t,i,Fu,p),p.delete(t)),e}function $d(e){return Ls(e)?i:e}function Du(e,t,s,a,h,p){var y=s&q,m=e.length,x=t.length;if(m!=x&&!(y&&x>m))return!1;var N=p.get(e),L=p.get(t);if(N&&L)return N==t&&L==e;var M=-1,H=!0,ee=s&K?new Ni:i;for(p.set(e,t),p.set(t,e);++M<m;){var se=e[M],me=t[M];if(a)var ne=y?a(me,se,M,t,e,p):a(se,me,M,e,t,p);if(ne!==i){if(ne)continue;H=!1;break}if(ee){if(!Ho(t,function(xe,Ce){if(!_s(ee,Ce)&&(se===xe||h(se,xe,s,a,p)))return ee.push(Ce)})){H=!1;break}}else if(!(se===me||h(se,me,s,a,p))){H=!1;break}}return p.delete(e),p.delete(t),H}function Md(e,t,s,a,h,p,y){switch(s){case Ke:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Ne:return!(e.byteLength!=t.byteLength||!p(new xn(e),new xn(t)));case A:case I:case Te:return Lr(+e,+t);case w:return e.name==t.name&&e.message==t.message;case nt:case Ye:return e==t+"";case ye:var m=Jo;case De:var x=a&q;if(m||(m=yn),e.size!=t.size&&!x)return!1;var N=y.get(e);if(N)return N==t;a|=K,y.set(e,t);var L=Du(m(e),m(t),a,h,p,y);return y.delete(e),L;case Xe:if(Is)return Is.call(e)==Is.call(t)}return!1}function jd(e,t,s,a,h,p){var y=s&q,m=wa(e),x=m.length,N=wa(t),L=N.length;if(x!=L&&!y)return!1;for(var M=x;M--;){var H=m[M];if(!(y?H in t:je.call(t,H)))return!1}var ee=p.get(e),se=p.get(t);if(ee&&se)return ee==t&&se==e;var me=!0;p.set(e,t),p.set(t,e);for(var ne=y;++M<x;){H=m[M];var xe=e[H],Ce=t[H];if(a)var pr=y?a(Ce,xe,H,t,e,p):a(xe,Ce,H,e,t,p);if(!(pr===i?xe===Ce||h(xe,Ce,s,a,p):pr)){me=!1;break}ne||(ne=H=="constructor")}if(me&&!ne){var Qt=e.constructor,dr=t.constructor;Qt!=dr&&"constructor"in e&&"constructor"in t&&!(typeof Qt=="function"&&Qt instanceof Qt&&typeof dr=="function"&&dr instanceof dr)&&(me=!1)}return p.delete(e),p.delete(t),me}function Qr(e){return Aa(Uu(e,i,Yu),e+"")}function wa(e){return tu(e,Ut,Ia)}function ba(e){return tu(e,or,$u)}var Ea=On?function(e){return On.get(e)}:Ua;function Hn(e){for(var t=e.name+"",s=ts[t],a=je.call(ts,t)?s.length:0;a--;){var h=s[a],p=h.func;if(p==null||p==e)return h.name}return t}function ns(e){var t=je.call(f,"placeholder")?f:e;return t.placeholder}function re(){var e=f.iteratee||za;return e=e===za?su:e,arguments.length?e(arguments[0],arguments[1]):e}function Kn(e,t){var s=e.__data__;return Bd(t)?s[typeof t=="string"?"string":"hash"]:s.map}function xa(e){for(var t=Ut(e),s=t.length;s--;){var a=t[s],h=e[a];t[s]=[a,h,zu(h)]}return t}function Di(e,t){var s=Jf(e,t);return iu(s)?s:i}function zd(e){var t=je.call(e,Ri),s=e[Ri];try{e[Ri]=i;var a=!0}catch{}var h=bn.call(e);return a&&(t?e[Ri]=s:delete e[Ri]),h}var Ia=Xo?function(e){return e==null?[]:(e=We(e),ui(Xo(e),function(t){return kc.call(e,t)}))}:ka,$u=Xo?function(e){for(var t=[];e;)hi(t,Ia(e)),e=In(e);return t}:ka,Gt=Xt;(Zo&&Gt(new Zo(new ArrayBuffer(1)))!=Ke||bs&&Gt(new bs)!=ye||Qo&&Gt(Qo.resolve())!=Pt||es&&Gt(new es)!=De||Es&&Gt(new Es)!=qe)&&(Gt=function(e){var t=Xt(e),s=t==Ie?e.constructor:i,a=s?$i(s):"";if(a)switch(a){case bp:return Ke;case Ep:return ye;case xp:return Pt;case Ip:return De;case Sp:return qe}return t});function qd(e,t,s){for(var a=-1,h=s.length;++a<h;){var p=s[a],y=p.size;switch(p.type){case"drop":e+=y;break;case"dropRight":t-=y;break;case"take":t=Bt(t,e+y);break;case"takeRight":e=jt(e,t-y);break}}return{start:e,end:t}}function Ud(e){var t=e.match(Je);return t?t[1].split(Tt):[]}function Mu(e,t,s){t=gi(t,e);for(var a=-1,h=t.length,p=!1;++a<h;){var y=Hr(t[a]);if(!(p=e!=null&&s(e,y)))break;e=e[y]}return p||++a!=h?p:(h=e==null?0:e.length,!!h&&Xn(h)&&ei(y,h)&&(fe(e)||Mi(e)))}function kd(e){var t=e.length,s=new e.constructor(t);return t&&typeof e[0]=="string"&&je.call(e,"index")&&(s.index=e.index,s.input=e.input),s}function ju(e){return typeof e.constructor=="function"&&!Ts(e)?rs(In(e)):{}}function Hd(e,t,s){var a=e.constructor;switch(t){case Ne:return ya(e);case A:case I:return new a(+e);case Ke:return Pd(e,s);case ht:case Me:case Ct:case $t:case kt:case Ht:case zt:case Wt:case rr:return wu(e,s);case ye:return new a;case Te:case Ye:return new a(e);case nt:return Cd(e);case De:return new a;case Xe:return Ad(e)}}function Kd(e,t){var s=t.length;if(!s)return e;var a=s-1;return t[a]=(s>1?"& ":"")+t[a],t=t.join(s>2?", ":" "),e.replace(vt,`{
/* [wrapped with `+t+`] */
`)}function Vd(e){return fe(e)||Mi(e)||!!(Hc&&e&&e[Hc])}function ei(e,t){var s=typeof e;return t=t??J,!!t&&(s=="number"||s!="symbol"&&Co.test(e))&&e>-1&&e%1==0&&e<t}function Zt(e,t,s){if(!ct(s))return!1;var a=typeof t;return(a=="number"?nr(s)&&ei(t,s.length):a=="string"&&t in s)?Lr(s[t],e):!1}function Sa(e,t){if(fe(e))return!1;var s=typeof e;return s=="number"||s=="symbol"||s=="boolean"||e==null||fr(e)?!0:At.test(e)||!it.test(e)||t!=null&&e in We(t)}function Bd(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function Pa(e){var t=Hn(e),s=f[t];if(typeof s!="function"||!(t in Se.prototype))return!1;if(e===s)return!0;var a=Ea(s);return!!a&&e===a[0]}function Gd(e){return!!zc&&zc in e}var Wd=_n?ti:Ha;function Ts(e){var t=e&&e.constructor,s=typeof t=="function"&&t.prototype||Qi;return e===s}function zu(e){return e===e&&!ct(e)}function qu(e,t){return function(s){return s==null?!1:s[e]===t&&(t!==i||e in We(s))}}function Jd(e){var t=Jn(e,function(a){return s.size===S&&s.clear(),a}),s=t.cache;return t}function Yd(e,t){var s=e[1],a=t[1],h=s|a,p=h<(oe|be|j),y=a==j&&s==pe||a==j&&s==B&&e[7].length<=t[8]||a==(j|B)&&t[7].length<=t[8]&&s==pe;if(!(p||y))return e;a&oe&&(e[2]=t[2],h|=s&oe?0:de);var m=t[3];if(m){var x=e[3];e[3]=x?Eu(x,m,t[4]):m,e[4]=x?li(e[3],F):t[4]}return m=t[5],m&&(x=e[5],e[5]=x?xu(x,m,t[6]):m,e[6]=x?li(e[5],F):t[6]),m=t[7],m&&(e[7]=m),a&j&&(e[8]=e[8]==null?t[8]:Bt(e[8],t[8])),e[9]==null&&(e[9]=t[9]),e[0]=t[0],e[1]=h,e}function Xd(e){var t=[];if(e!=null)for(var s in We(e))t.push(s);return t}function Zd(e){return bn.call(e)}function Uu(e,t,s){return t=jt(t===i?e.length-1:t,0),function(){for(var a=arguments,h=-1,p=jt(a.length-t,0),y=P(p);++h<p;)y[h]=a[t+h];h=-1;for(var m=P(t+1);++h<t;)m[h]=a[h];return m[t]=s(y),qt(e,this,m)}}function ku(e,t){return t.length<2?e:Fi(e,xr(t,0,-1))}function Qd(e,t){for(var s=e.length,a=Bt(t.length,s),h=sr(e);a--;){var p=t[a];e[a]=ei(p,s)?h[p]:i}return e}function Ca(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var Hu=Vu(fu),Ns=dp||function(e,t){return Pe.setTimeout(e,t)},Aa=Vu(Ed);function Ku(e,t,s){var a=t+"";return Aa(e,Kd(a,eg(Ud(a),s)))}function Vu(e){var t=0,s=0;return function(){var a=mp(),h=tt-(a-s);if(s=a,h>0){if(++t>=Oe)return arguments[0]}else t=0;return e.apply(i,arguments)}}function Vn(e,t){var s=-1,a=e.length,h=a-1;for(t=t===i?a:t;++s<t;){var p=ha(s,h),y=e[p];e[p]=e[s],e[s]=y}return e.length=t,e}var Bu=Jd(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Ot,function(s,a,h,p){t.push(h?p.replace(bo,"$1"):a||s)}),t});function Hr(e){if(typeof e=="string"||fr(e))return e;var t=e+"";return t=="0"&&1/e==-Re?"-0":t}function $i(e){if(e!=null){try{return wn.call(e)}catch{}try{return e+""}catch{}}return""}function eg(e,t){return _r(Mr,function(s){var a="_."+s[0];t&s[1]&&!gn(e,a)&&e.push(a)}),e.sort()}function Gu(e){if(e instanceof Se)return e.clone();var t=new br(e.__wrapped__,e.__chain__);return t.__actions__=sr(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function tg(e,t,s){(s?Zt(e,t,s):t===i)?t=1:t=jt(ve(t),0);var a=e==null?0:e.length;if(!a||t<1)return[];for(var h=0,p=0,y=P(Cn(a/t));h<a;)y[p++]=xr(e,h,h+=t);return y}function rg(e){for(var t=-1,s=e==null?0:e.length,a=0,h=[];++t<s;){var p=e[t];p&&(h[a++]=p)}return h}function ig(){var e=arguments.length;if(!e)return[];for(var t=P(e-1),s=arguments[0],a=e;a--;)t[a-1]=arguments[a];return hi(fe(s)?sr(s):[s],Kt(t,1))}var sg=we(function(e,t){return Et(e)?Ps(e,Kt(t,1,Et,!0)):[]}),ng=we(function(e,t){var s=Ir(t);return Et(s)&&(s=i),Et(e)?Ps(e,Kt(t,1,Et,!0),re(s,2)):[]}),og=we(function(e,t){var s=Ir(t);return Et(s)&&(s=i),Et(e)?Ps(e,Kt(t,1,Et,!0),i,s):[]});function ag(e,t,s){var a=e==null?0:e.length;return a?(t=s||t===i?1:ve(t),xr(e,t<0?0:t,a)):[]}function cg(e,t,s){var a=e==null?0:e.length;return a?(t=s||t===i?1:ve(t),t=a-t,xr(e,0,t<0?0:t)):[]}function ug(e,t){return e&&e.length?Mn(e,re(t,3),!0,!0):[]}function hg(e,t){return e&&e.length?Mn(e,re(t,3),!0):[]}function lg(e,t,s,a){var h=e==null?0:e.length;return h?(s&&typeof s!="number"&&Zt(e,t,s)&&(s=0,a=h),id(e,t,s,a)):[]}function Wu(e,t,s){var a=e==null?0:e.length;if(!a)return-1;var h=s==null?0:ve(s);return h<0&&(h=jt(a+h,0)),vn(e,re(t,3),h)}function Ju(e,t,s){var a=e==null?0:e.length;if(!a)return-1;var h=a-1;return s!==i&&(h=ve(s),h=s<0?jt(a+h,0):Bt(h,a-1)),vn(e,re(t,3),h,!0)}function Yu(e){var t=e==null?0:e.length;return t?Kt(e,1):[]}function fg(e){var t=e==null?0:e.length;return t?Kt(e,Re):[]}function pg(e,t){var s=e==null?0:e.length;return s?(t=t===i?1:ve(t),Kt(e,t)):[]}function dg(e){for(var t=-1,s=e==null?0:e.length,a={};++t<s;){var h=e[t];a[h[0]]=h[1]}return a}function Xu(e){return e&&e.length?e[0]:i}function gg(e,t,s){var a=e==null?0:e.length;if(!a)return-1;var h=s==null?0:ve(s);return h<0&&(h=jt(a+h,0)),Ji(e,t,h)}function vg(e){var t=e==null?0:e.length;return t?xr(e,0,-1):[]}var yg=we(function(e){var t=st(e,ga);return t.length&&t[0]===e[0]?na(t):[]}),mg=we(function(e){var t=Ir(e),s=st(e,ga);return t===Ir(s)?t=i:s.pop(),s.length&&s[0]===e[0]?na(s,re(t,2)):[]}),_g=we(function(e){var t=Ir(e),s=st(e,ga);return t=typeof t=="function"?t:i,t&&s.pop(),s.length&&s[0]===e[0]?na(s,i,t):[]});function wg(e,t){return e==null?"":vp.call(e,t)}function Ir(e){var t=e==null?0:e.length;return t?e[t-1]:i}function bg(e,t,s){var a=e==null?0:e.length;if(!a)return-1;var h=a;return s!==i&&(h=ve(s),h=h<0?jt(a+h,0):Bt(h,a-1)),t===t?ep(e,t,h):vn(e,Tc,h,!0)}function Eg(e,t){return e&&e.length?cu(e,ve(t)):i}var xg=we(Zu);function Zu(e,t){return e&&e.length&&t&&t.length?ua(e,t):e}function Ig(e,t,s){return e&&e.length&&t&&t.length?ua(e,t,re(s,2)):e}function Sg(e,t,s){return e&&e.length&&t&&t.length?ua(e,t,i,s):e}var Pg=Qr(function(e,t){var s=e==null?0:e.length,a=ta(e,t);return lu(e,st(t,function(h){return ei(h,s)?+h:h}).sort(bu)),a});function Cg(e,t){var s=[];if(!(e&&e.length))return s;var a=-1,h=[],p=e.length;for(t=re(t,3);++a<p;){var y=e[a];t(y,a,e)&&(s.push(y),h.push(a))}return lu(e,h),s}function Oa(e){return e==null?e:wp.call(e)}function Ag(e,t,s){var a=e==null?0:e.length;return a?(s&&typeof s!="number"&&Zt(e,t,s)?(t=0,s=a):(t=t==null?0:ve(t),s=s===i?a:ve(s)),xr(e,t,s)):[]}function Og(e,t){return $n(e,t)}function Rg(e,t,s){return fa(e,t,re(s,2))}function Tg(e,t){var s=e==null?0:e.length;if(s){var a=$n(e,t);if(a<s&&Lr(e[a],t))return a}return-1}function Ng(e,t){return $n(e,t,!0)}function Lg(e,t,s){return fa(e,t,re(s,2),!0)}function Fg(e,t){var s=e==null?0:e.length;if(s){var a=$n(e,t,!0)-1;if(Lr(e[a],t))return a}return-1}function Dg(e){return e&&e.length?pu(e):[]}function $g(e,t){return e&&e.length?pu(e,re(t,2)):[]}function Mg(e){var t=e==null?0:e.length;return t?xr(e,1,t):[]}function jg(e,t,s){return e&&e.length?(t=s||t===i?1:ve(t),xr(e,0,t<0?0:t)):[]}function zg(e,t,s){var a=e==null?0:e.length;return a?(t=s||t===i?1:ve(t),t=a-t,xr(e,t<0?0:t,a)):[]}function qg(e,t){return e&&e.length?Mn(e,re(t,3),!1,!0):[]}function Ug(e,t){return e&&e.length?Mn(e,re(t,3)):[]}var kg=we(function(e){return di(Kt(e,1,Et,!0))}),Hg=we(function(e){var t=Ir(e);return Et(t)&&(t=i),di(Kt(e,1,Et,!0),re(t,2))}),Kg=we(function(e){var t=Ir(e);return t=typeof t=="function"?t:i,di(Kt(e,1,Et,!0),i,t)});function Vg(e){return e&&e.length?di(e):[]}function Bg(e,t){return e&&e.length?di(e,re(t,2)):[]}function Gg(e,t){return t=typeof t=="function"?t:i,e&&e.length?di(e,i,t):[]}function Ra(e){if(!(e&&e.length))return[];var t=0;return e=ui(e,function(s){if(Et(s))return t=jt(s.length,t),!0}),Go(t,function(s){return st(e,Ko(s))})}function Qu(e,t){if(!(e&&e.length))return[];var s=Ra(e);return t==null?s:st(s,function(a){return qt(t,i,a)})}var Wg=we(function(e,t){return Et(e)?Ps(e,t):[]}),Jg=we(function(e){return da(ui(e,Et))}),Yg=we(function(e){var t=Ir(e);return Et(t)&&(t=i),da(ui(e,Et),re(t,2))}),Xg=we(function(e){var t=Ir(e);return t=typeof t=="function"?t:i,da(ui(e,Et),i,t)}),Zg=we(Ra);function Qg(e,t){return yu(e||[],t||[],Ss)}function ev(e,t){return yu(e||[],t||[],Os)}var tv=we(function(e){var t=e.length,s=t>1?e[t-1]:i;return s=typeof s=="function"?(e.pop(),s):i,Qu(e,s)});function eh(e){var t=f(e);return t.__chain__=!0,t}function rv(e,t){return t(e),e}function Bn(e,t){return t(e)}var iv=Qr(function(e){var t=e.length,s=t?e[0]:0,a=this.__wrapped__,h=function(p){return ta(p,e)};return t>1||this.__actions__.length||!(a instanceof Se)||!ei(s)?this.thru(h):(a=a.slice(s,+s+(t?1:0)),a.__actions__.push({func:Bn,args:[h],thisArg:i}),new br(a,this.__chain__).thru(function(p){return t&&!p.length&&p.push(i),p}))});function sv(){return eh(this)}function nv(){return new br(this.value(),this.__chain__)}function ov(){this.__values__===i&&(this.__values__=dh(this.value()));var e=this.__index__>=this.__values__.length,t=e?i:this.__values__[this.__index__++];return{done:e,value:t}}function av(){return this}function cv(e){for(var t,s=this;s instanceof Tn;){var a=Gu(s);a.__index__=0,a.__values__=i,t?h.__wrapped__=a:t=a;var h=a;s=s.__wrapped__}return h.__wrapped__=e,t}function uv(){var e=this.__wrapped__;if(e instanceof Se){var t=e;return this.__actions__.length&&(t=new Se(this)),t=t.reverse(),t.__actions__.push({func:Bn,args:[Oa],thisArg:i}),new br(t,this.__chain__)}return this.thru(Oa)}function hv(){return vu(this.__wrapped__,this.__actions__)}var lv=jn(function(e,t,s){je.call(e,s)?++e[s]:Xr(e,s,1)});function fv(e,t,s){var a=fe(e)?Oc:rd;return s&&Zt(e,t,s)&&(t=i),a(e,re(t,3))}function pv(e,t){var s=fe(e)?ui:Qc;return s(e,re(t,3))}var dv=Cu(Wu),gv=Cu(Ju);function vv(e,t){return Kt(Gn(e,t),1)}function yv(e,t){return Kt(Gn(e,t),Re)}function mv(e,t,s){return s=s===i?1:ve(s),Kt(Gn(e,t),s)}function th(e,t){var s=fe(e)?_r:pi;return s(e,re(t,3))}function rh(e,t){var s=fe(e)?Mf:Zc;return s(e,re(t,3))}var _v=jn(function(e,t,s){je.call(e,s)?e[s].push(t):Xr(e,s,[t])});function wv(e,t,s,a){e=nr(e)?e:as(e),s=s&&!a?ve(s):0;var h=e.length;return s<0&&(s=jt(h+s,0)),Zn(e)?s<=h&&e.indexOf(t,s)>-1:!!h&&Ji(e,t,s)>-1}var bv=we(function(e,t,s){var a=-1,h=typeof t=="function",p=nr(e)?P(e.length):[];return pi(e,function(y){p[++a]=h?qt(t,y,s):Cs(y,t,s)}),p}),Ev=jn(function(e,t,s){Xr(e,s,t)});function Gn(e,t){var s=fe(e)?st:nu;return s(e,re(t,3))}function xv(e,t,s,a){return e==null?[]:(fe(t)||(t=t==null?[]:[t]),s=a?i:s,fe(s)||(s=s==null?[]:[s]),uu(e,t,s))}var Iv=jn(function(e,t,s){e[s?0:1].push(t)},function(){return[[],[]]});function Sv(e,t,s){var a=fe(e)?ko:Lc,h=arguments.length<3;return a(e,re(t,4),s,h,pi)}function Pv(e,t,s){var a=fe(e)?jf:Lc,h=arguments.length<3;return a(e,re(t,4),s,h,Zc)}function Cv(e,t){var s=fe(e)?ui:Qc;return s(e,Yn(re(t,3)))}function Av(e){var t=fe(e)?Wc:wd;return t(e)}function Ov(e,t,s){(s?Zt(e,t,s):t===i)?t=1:t=ve(t);var a=fe(e)?Xp:bd;return a(e,t)}function Rv(e){var t=fe(e)?Zp:xd;return t(e)}function Tv(e){if(e==null)return 0;if(nr(e))return Zn(e)?Xi(e):e.length;var t=Gt(e);return t==ye||t==De?e.size:aa(e).length}function Nv(e,t,s){var a=fe(e)?Ho:Id;return s&&Zt(e,t,s)&&(t=i),a(e,re(t,3))}var Lv=we(function(e,t){if(e==null)return[];var s=t.length;return s>1&&Zt(e,t[0],t[1])?t=[]:s>2&&Zt(t[0],t[1],t[2])&&(t=[t[0]]),uu(e,Kt(t,1),[])}),Wn=pp||function(){return Pe.Date.now()};function Fv(e,t){if(typeof t!="function")throw new wr(d);return e=ve(e),function(){if(--e<1)return t.apply(this,arguments)}}function ih(e,t,s){return t=s?i:t,t=e&&t==null?e.length:t,Zr(e,j,i,i,i,i,t)}function sh(e,t){var s;if(typeof t!="function")throw new wr(d);return e=ve(e),function(){return--e>0&&(s=t.apply(this,arguments)),e<=1&&(t=i),s}}var Ta=we(function(e,t,s){var a=oe;if(s.length){var h=li(s,ns(Ta));a|=he}return Zr(e,a,t,s,h)}),nh=we(function(e,t,s){var a=oe|be;if(s.length){var h=li(s,ns(nh));a|=he}return Zr(t,a,e,s,h)});function oh(e,t,s){t=s?i:t;var a=Zr(e,pe,i,i,i,i,i,t);return a.placeholder=oh.placeholder,a}function ah(e,t,s){t=s?i:t;var a=Zr(e,ue,i,i,i,i,i,t);return a.placeholder=ah.placeholder,a}function ch(e,t,s){var a,h,p,y,m,x,N=0,L=!1,M=!1,H=!0;if(typeof e!="function")throw new wr(d);t=Sr(t)||0,ct(s)&&(L=!!s.leading,M="maxWait"in s,p=M?jt(Sr(s.maxWait)||0,t):p,H="trailing"in s?!!s.trailing:H);function ee(xt){var Fr=a,ii=h;return a=h=i,N=xt,y=e.apply(ii,Fr),y}function se(xt){return N=xt,m=Ns(xe,t),L?ee(xt):y}function me(xt){var Fr=xt-x,ii=xt-N,Ch=t-Fr;return M?Bt(Ch,p-ii):Ch}function ne(xt){var Fr=xt-x,ii=xt-N;return x===i||Fr>=t||Fr<0||M&&ii>=p}function xe(){var xt=Wn();if(ne(xt))return Ce(xt);m=Ns(xe,me(xt))}function Ce(xt){return m=i,H&&a?ee(xt):(a=h=i,y)}function pr(){m!==i&&mu(m),N=0,a=x=h=m=i}function Qt(){return m===i?y:Ce(Wn())}function dr(){var xt=Wn(),Fr=ne(xt);if(a=arguments,h=this,x=xt,Fr){if(m===i)return se(x);if(M)return mu(m),m=Ns(xe,t),ee(x)}return m===i&&(m=Ns(xe,t)),y}return dr.cancel=pr,dr.flush=Qt,dr}var Dv=we(function(e,t){return Xc(e,1,t)}),$v=we(function(e,t,s){return Xc(e,Sr(t)||0,s)});function Mv(e){return Zr(e,ge)}function Jn(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new wr(d);var s=function(){var a=arguments,h=t?t.apply(this,a):a[0],p=s.cache;if(p.has(h))return p.get(h);var y=e.apply(this,a);return s.cache=p.set(h,y)||p,y};return s.cache=new(Jn.Cache||Yr),s}Jn.Cache=Yr;function Yn(e){if(typeof e!="function")throw new wr(d);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function jv(e){return sh(2,e)}var zv=Sd(function(e,t){t=t.length==1&&fe(t[0])?st(t[0],hr(re())):st(Kt(t,1),hr(re()));var s=t.length;return we(function(a){for(var h=-1,p=Bt(a.length,s);++h<p;)a[h]=t[h].call(this,a[h]);return qt(e,this,a)})}),Na=we(function(e,t){var s=li(t,ns(Na));return Zr(e,he,i,t,s)}),uh=we(function(e,t){var s=li(t,ns(uh));return Zr(e,R,i,t,s)}),qv=Qr(function(e,t){return Zr(e,B,i,i,i,t)});function Uv(e,t){if(typeof e!="function")throw new wr(d);return t=t===i?t:ve(t),we(e,t)}function kv(e,t){if(typeof e!="function")throw new wr(d);return t=t==null?0:jt(ve(t),0),we(function(s){var a=s[t],h=vi(s,0,t);return a&&hi(h,a),qt(e,this,h)})}function Hv(e,t,s){var a=!0,h=!0;if(typeof e!="function")throw new wr(d);return ct(s)&&(a="leading"in s?!!s.leading:a,h="trailing"in s?!!s.trailing:h),ch(e,t,{leading:a,maxWait:t,trailing:h})}function Kv(e){return ih(e,1)}function Vv(e,t){return Na(va(t),e)}function Bv(){if(!arguments.length)return[];var e=arguments[0];return fe(e)?e:[e]}function Gv(e){return Er(e,V)}function Wv(e,t){return t=typeof t=="function"?t:i,Er(e,V,t)}function Jv(e){return Er(e,G|V)}function Yv(e,t){return t=typeof t=="function"?t:i,Er(e,G|V,t)}function Xv(e,t){return t==null||Yc(e,t,Ut(t))}function Lr(e,t){return e===t||e!==e&&t!==t}var Zv=kn(sa),Qv=kn(function(e,t){return e>=t}),Mi=ru(function(){return arguments}())?ru:function(e){return yt(e)&&je.call(e,"callee")&&!kc.call(e,"callee")},fe=P.isArray,e0=Yt?hr(Yt):cd;function nr(e){return e!=null&&Xn(e.length)&&!ti(e)}function Et(e){return yt(e)&&nr(e)}function t0(e){return e===!0||e===!1||yt(e)&&Xt(e)==A}var yi=gp||Ha,r0=Rr?hr(Rr):ud;function i0(e){return yt(e)&&e.nodeType===1&&!Ls(e)}function s0(e){if(e==null)return!0;if(nr(e)&&(fe(e)||typeof e=="string"||typeof e.splice=="function"||yi(e)||os(e)||Mi(e)))return!e.length;var t=Gt(e);if(t==ye||t==De)return!e.size;if(Ts(e))return!aa(e).length;for(var s in e)if(je.call(e,s))return!1;return!0}function n0(e,t){return As(e,t)}function o0(e,t,s){s=typeof s=="function"?s:i;var a=s?s(e,t):i;return a===i?As(e,t,i,s):!!a}function La(e){if(!yt(e))return!1;var t=Xt(e);return t==w||t==u||typeof e.message=="string"&&typeof e.name=="string"&&!Ls(e)}function a0(e){return typeof e=="number"&&Kc(e)}function ti(e){if(!ct(e))return!1;var t=Xt(e);return t==Q||t==ae||t==O||t==_t}function hh(e){return typeof e=="number"&&e==ve(e)}function Xn(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=J}function ct(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function yt(e){return e!=null&&typeof e=="object"}var lh=mr?hr(mr):ld;function c0(e,t){return e===t||oa(e,t,xa(t))}function u0(e,t,s){return s=typeof s=="function"?s:i,oa(e,t,xa(t),s)}function h0(e){return fh(e)&&e!=+e}function l0(e){if(Wd(e))throw new ce(l);return iu(e)}function f0(e){return e===null}function p0(e){return e==null}function fh(e){return typeof e=="number"||yt(e)&&Xt(e)==Te}function Ls(e){if(!yt(e)||Xt(e)!=Ie)return!1;var t=In(e);if(t===null)return!0;var s=je.call(t,"constructor")&&t.constructor;return typeof s=="function"&&s instanceof s&&wn.call(s)==up}var Fa=qr?hr(qr):fd;function d0(e){return hh(e)&&e>=-J&&e<=J}var ph=ms?hr(ms):pd;function Zn(e){return typeof e=="string"||!fe(e)&&yt(e)&&Xt(e)==Ye}function fr(e){return typeof e=="symbol"||yt(e)&&Xt(e)==Xe}var os=Oi?hr(Oi):dd;function g0(e){return e===i}function v0(e){return yt(e)&&Gt(e)==qe}function y0(e){return yt(e)&&Xt(e)==Ze}var m0=kn(ca),_0=kn(function(e,t){return e<=t});function dh(e){if(!e)return[];if(nr(e))return Zn(e)?Tr(e):sr(e);if(ws&&e[ws])return Xf(e[ws]());var t=Gt(e),s=t==ye?Jo:t==De?yn:as;return s(e)}function ri(e){if(!e)return e===0?e:0;if(e=Sr(e),e===Re||e===-Re){var t=e<0?-1:1;return t*U}return e===e?e:0}function ve(e){var t=ri(e),s=t%1;return t===t?s?t-s:t:0}function gh(e){return e?Li(ve(e),0,k):0}function Sr(e){if(typeof e=="number")return e;if(fr(e))return z;if(ct(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ct(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Fc(e);var s=Io.test(e);return s||Po.test(e)?le(e.slice(2),s?2:8):xo.test(e)?z:+e}function vh(e){return kr(e,or(e))}function w0(e){return e?Li(ve(e),-J,J):e===0?e:0}function $e(e){return e==null?"":lr(e)}var b0=is(function(e,t){if(Ts(t)||nr(t)){kr(t,Ut(t),e);return}for(var s in t)je.call(t,s)&&Ss(e,s,t[s])}),yh=is(function(e,t){kr(t,or(t),e)}),Qn=is(function(e,t,s,a){kr(t,or(t),e,a)}),E0=is(function(e,t,s,a){kr(t,Ut(t),e,a)}),x0=Qr(ta);function I0(e,t){var s=rs(e);return t==null?s:Jc(s,t)}var S0=we(function(e,t){e=We(e);var s=-1,a=t.length,h=a>2?t[2]:i;for(h&&Zt(t[0],t[1],h)&&(a=1);++s<a;)for(var p=t[s],y=or(p),m=-1,x=y.length;++m<x;){var N=y[m],L=e[N];(L===i||Lr(L,Qi[N])&&!je.call(e,N))&&(e[N]=p[N])}return e}),P0=we(function(e){return e.push(i,Fu),qt(mh,i,e)});function C0(e,t){return Rc(e,re(t,3),Ur)}function A0(e,t){return Rc(e,re(t,3),ia)}function O0(e,t){return e==null?e:ra(e,re(t,3),or)}function R0(e,t){return e==null?e:eu(e,re(t,3),or)}function T0(e,t){return e&&Ur(e,re(t,3))}function N0(e,t){return e&&ia(e,re(t,3))}function L0(e){return e==null?[]:Fn(e,Ut(e))}function F0(e){return e==null?[]:Fn(e,or(e))}function Da(e,t,s){var a=e==null?i:Fi(e,t);return a===i?s:a}function D0(e,t){return e!=null&&Mu(e,t,sd)}function $a(e,t){return e!=null&&Mu(e,t,nd)}var $0=Ou(function(e,t,s){t!=null&&typeof t.toString!="function"&&(t=bn.call(t)),e[t]=s},ja(ar)),M0=Ou(function(e,t,s){t!=null&&typeof t.toString!="function"&&(t=bn.call(t)),je.call(e,t)?e[t].push(s):e[t]=[s]},re),j0=we(Cs);function Ut(e){return nr(e)?Gc(e):aa(e)}function or(e){return nr(e)?Gc(e,!0):gd(e)}function z0(e,t){var s={};return t=re(t,3),Ur(e,function(a,h,p){Xr(s,t(a,h,p),a)}),s}function q0(e,t){var s={};return t=re(t,3),Ur(e,function(a,h,p){Xr(s,h,t(a,h,p))}),s}var U0=is(function(e,t,s){Dn(e,t,s)}),mh=is(function(e,t,s,a){Dn(e,t,s,a)}),k0=Qr(function(e,t){var s={};if(e==null)return s;var a=!1;t=st(t,function(p){return p=gi(p,e),a||(a=p.length>1),p}),kr(e,ba(e),s),a&&(s=Er(s,G|W|V,$d));for(var h=t.length;h--;)pa(s,t[h]);return s});function H0(e,t){return _h(e,Yn(re(t)))}var K0=Qr(function(e,t){return e==null?{}:yd(e,t)});function _h(e,t){if(e==null)return{};var s=st(ba(e),function(a){return[a]});return t=re(t),hu(e,s,function(a,h){return t(a,h[0])})}function V0(e,t,s){t=gi(t,e);var a=-1,h=t.length;for(h||(h=1,e=i);++a<h;){var p=e==null?i:e[Hr(t[a])];p===i&&(a=h,p=s),e=ti(p)?p.call(e):p}return e}function B0(e,t,s){return e==null?e:Os(e,t,s)}function G0(e,t,s,a){return a=typeof a=="function"?a:i,e==null?e:Os(e,t,s,a)}var wh=Nu(Ut),bh=Nu(or);function W0(e,t,s){var a=fe(e),h=a||yi(e)||os(e);if(t=re(t,4),s==null){var p=e&&e.constructor;h?s=a?new p:[]:ct(e)?s=ti(p)?rs(In(e)):{}:s={}}return(h?_r:Ur)(e,function(y,m,x){return t(s,y,m,x)}),s}function J0(e,t){return e==null?!0:pa(e,t)}function Y0(e,t,s){return e==null?e:gu(e,t,va(s))}function X0(e,t,s,a){return a=typeof a=="function"?a:i,e==null?e:gu(e,t,va(s),a)}function as(e){return e==null?[]:Wo(e,Ut(e))}function Z0(e){return e==null?[]:Wo(e,or(e))}function Q0(e,t,s){return s===i&&(s=t,t=i),s!==i&&(s=Sr(s),s=s===s?s:0),t!==i&&(t=Sr(t),t=t===t?t:0),Li(Sr(e),t,s)}function ey(e,t,s){return t=ri(t),s===i?(s=t,t=0):s=ri(s),e=Sr(e),od(e,t,s)}function ty(e,t,s){if(s&&typeof s!="boolean"&&Zt(e,t,s)&&(t=s=i),s===i&&(typeof t=="boolean"?(s=t,t=i):typeof e=="boolean"&&(s=e,e=i)),e===i&&t===i?(e=0,t=1):(e=ri(e),t===i?(t=e,e=0):t=ri(t)),e>t){var a=e;e=t,t=a}if(s||e%1||t%1){var h=Vc();return Bt(e+h*(t-e+Be("1e-"+((h+"").length-1))),t)}return ha(e,t)}var ry=ss(function(e,t,s){return t=t.toLowerCase(),e+(s?Eh(t):t)});function Eh(e){return Ma($e(e).toLowerCase())}function xh(e){return e=$e(e),e&&e.replace(Gr,Bf).replace(zo,"")}function iy(e,t,s){e=$e(e),t=lr(t);var a=e.length;s=s===i?a:Li(ve(s),0,a);var h=s;return s-=t.length,s>=0&&e.slice(s,h)==t}function sy(e){return e=$e(e),e&&rt.test(e)?e.replace(Ii,Gf):e}function ny(e){return e=$e(e),e&&Rt.test(e)?e.replace(dt,"\\$&"):e}var oy=ss(function(e,t,s){return e+(s?"-":"")+t.toLowerCase()}),ay=ss(function(e,t,s){return e+(s?" ":"")+t.toLowerCase()}),cy=Pu("toLowerCase");function uy(e,t,s){e=$e(e),t=ve(t);var a=t?Xi(e):0;if(!t||a>=t)return e;var h=(t-a)/2;return Un(An(h),s)+e+Un(Cn(h),s)}function hy(e,t,s){e=$e(e),t=ve(t);var a=t?Xi(e):0;return t&&a<t?e+Un(t-a,s):e}function ly(e,t,s){e=$e(e),t=ve(t);var a=t?Xi(e):0;return t&&a<t?Un(t-a,s)+e:e}function fy(e,t,s){return s||t==null?t=0:t&&(t=+t),_p($e(e).replace(gt,""),t||0)}function py(e,t,s){return(s?Zt(e,t,s):t===i)?t=1:t=ve(t),la($e(e),t)}function dy(){var e=arguments,t=$e(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var gy=ss(function(e,t,s){return e+(s?"_":"")+t.toLowerCase()});function vy(e,t,s){return s&&typeof s!="number"&&Zt(e,t,s)&&(t=s=i),s=s===i?k:s>>>0,s?(e=$e(e),e&&(typeof t=="string"||t!=null&&!Fa(t))&&(t=lr(t),!t&&Yi(e))?vi(Tr(e),0,s):e.split(t,s)):[]}var yy=ss(function(e,t,s){return e+(s?" ":"")+Ma(t)});function my(e,t,s){return e=$e(e),s=s==null?0:Li(ve(s),0,e.length),t=lr(t),e.slice(s,s+t.length)==t}function _y(e,t,s){var a=f.templateSettings;s&&Zt(e,t,s)&&(t=i),e=$e(e),t=Qn({},t,a,Lu);var h=Qn({},t.imports,a.imports,Lu),p=Ut(h),y=Wo(h,p),m,x,N=0,L=t.interpolate||ki,M="__p += '",H=Yo((t.escape||ki).source+"|"+L.source+"|"+(L===at?Eo:ki).source+"|"+(t.evaluate||ki).source+"|$","g"),ee="//# sourceURL="+(je.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++qo+"]")+`
`;e.replace(H,function(ne,xe,Ce,pr,Qt,dr){return Ce||(Ce=pr),M+=e.slice(N,dr).replace(Ao,Wf),xe&&(m=!0,M+=`' +
__e(`+xe+`) +
'`),Qt&&(x=!0,M+=`';
`+Qt+`;
__p += '`),Ce&&(M+=`' +
((__t = (`+Ce+`)) == null ? '' : __t) +
'`),N=dr+ne.length,ne}),M+=`';
`;var se=je.call(t,"variable")&&t.variable;if(!se)M=`with (obj) {
`+M+`
}
`;else if(wo.test(se))throw new ce(v);M=(x?M.replace(jr,""):M).replace(Jt,"$1").replace(Br,"$1;"),M="function("+(se||"obj")+`) {
`+(se?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(m?", __e = _.escape":"")+(x?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+M+`return __p
}`;var me=Sh(function(){return Fe(p,ee+"return "+M).apply(i,y)});if(me.source=M,La(me))throw me;return me}function wy(e){return $e(e).toLowerCase()}function by(e){return $e(e).toUpperCase()}function Ey(e,t,s){if(e=$e(e),e&&(s||t===i))return Fc(e);if(!e||!(t=lr(t)))return e;var a=Tr(e),h=Tr(t),p=Dc(a,h),y=$c(a,h)+1;return vi(a,p,y).join("")}function xy(e,t,s){if(e=$e(e),e&&(s||t===i))return e.slice(0,jc(e)+1);if(!e||!(t=lr(t)))return e;var a=Tr(e),h=$c(a,Tr(t))+1;return vi(a,0,h).join("")}function Iy(e,t,s){if(e=$e(e),e&&(s||t===i))return e.replace(gt,"");if(!e||!(t=lr(t)))return e;var a=Tr(e),h=Dc(a,Tr(t));return vi(a,h).join("")}function Sy(e,t){var s=te,a=Ee;if(ct(t)){var h="separator"in t?t.separator:h;s="length"in t?ve(t.length):s,a="omission"in t?lr(t.omission):a}e=$e(e);var p=e.length;if(Yi(e)){var y=Tr(e);p=y.length}if(s>=p)return e;var m=s-Xi(a);if(m<1)return a;var x=y?vi(y,0,m).join(""):e.slice(0,m);if(h===i)return x+a;if(y&&(m+=x.length-m),Fa(h)){if(e.slice(m).search(h)){var N,L=x;for(h.global||(h=Yo(h.source,$e(yr.exec(h))+"g")),h.lastIndex=0;N=h.exec(L);)var M=N.index;x=x.slice(0,M===i?m:M)}}else if(e.indexOf(lr(h),m)!=m){var H=x.lastIndexOf(h);H>-1&&(x=x.slice(0,H))}return x+a}function Py(e){return e=$e(e),e&&lt.test(e)?e.replace(ai,tp):e}var Cy=ss(function(e,t,s){return e+(s?" ":"")+t.toUpperCase()}),Ma=Pu("toUpperCase");function Ih(e,t,s){return e=$e(e),t=s?i:t,t===i?Yf(e)?sp(e):Uf(e):e.match(t)||[]}var Sh=we(function(e,t){try{return qt(e,i,t)}catch(s){return La(s)?s:new ce(s)}}),Ay=Qr(function(e,t){return _r(t,function(s){s=Hr(s),Xr(e,s,Ta(e[s],e))}),e});function Oy(e){var t=e==null?0:e.length,s=re();return e=t?st(e,function(a){if(typeof a[1]!="function")throw new wr(d);return[s(a[0]),a[1]]}):[],we(function(a){for(var h=-1;++h<t;){var p=e[h];if(qt(p[0],this,a))return qt(p[1],this,a)}})}function Ry(e){return td(Er(e,G))}function ja(e){return function(){return e}}function Ty(e,t){return e==null||e!==e?t:e}var Ny=Au(),Ly=Au(!0);function ar(e){return e}function za(e){return su(typeof e=="function"?e:Er(e,G))}function Fy(e){return ou(Er(e,G))}function Dy(e,t){return au(e,Er(t,G))}var $y=we(function(e,t){return function(s){return Cs(s,e,t)}}),My=we(function(e,t){return function(s){return Cs(e,s,t)}});function qa(e,t,s){var a=Ut(t),h=Fn(t,a);s==null&&!(ct(t)&&(h.length||!a.length))&&(s=t,t=e,e=this,h=Fn(t,Ut(t)));var p=!(ct(s)&&"chain"in s)||!!s.chain,y=ti(e);return _r(h,function(m){var x=t[m];e[m]=x,y&&(e.prototype[m]=function(){var N=this.__chain__;if(p||N){var L=e(this.__wrapped__),M=L.__actions__=sr(this.__actions__);return M.push({func:x,args:arguments,thisArg:e}),L.__chain__=N,L}return x.apply(e,hi([this.value()],arguments))})}),e}function jy(){return Pe._===this&&(Pe._=hp),this}function Ua(){}function zy(e){return e=ve(e),we(function(t){return cu(t,e)})}var qy=ma(st),Uy=ma(Oc),ky=ma(Ho);function Ph(e){return Sa(e)?Ko(Hr(e)):md(e)}function Hy(e){return function(t){return e==null?i:Fi(e,t)}}var Ky=Ru(),Vy=Ru(!0);function ka(){return[]}function Ha(){return!1}function By(){return{}}function Gy(){return""}function Wy(){return!0}function Jy(e,t){if(e=ve(e),e<1||e>J)return[];var s=k,a=Bt(e,k);t=re(t),e-=k;for(var h=Go(a,t);++s<e;)t(s);return h}function Yy(e){return fe(e)?st(e,Hr):fr(e)?[e]:sr(Bu($e(e)))}function Xy(e){var t=++cp;return $e(e)+t}var Zy=qn(function(e,t){return e+t},0),Qy=_a("ceil"),e1=qn(function(e,t){return e/t},1),t1=_a("floor");function r1(e){return e&&e.length?Ln(e,ar,sa):i}function i1(e,t){return e&&e.length?Ln(e,re(t,2),sa):i}function s1(e){return Nc(e,ar)}function n1(e,t){return Nc(e,re(t,2))}function o1(e){return e&&e.length?Ln(e,ar,ca):i}function a1(e,t){return e&&e.length?Ln(e,re(t,2),ca):i}var c1=qn(function(e,t){return e*t},1),u1=_a("round"),h1=qn(function(e,t){return e-t},0);function l1(e){return e&&e.length?Bo(e,ar):0}function f1(e,t){return e&&e.length?Bo(e,re(t,2)):0}return f.after=Fv,f.ary=ih,f.assign=b0,f.assignIn=yh,f.assignInWith=Qn,f.assignWith=E0,f.at=x0,f.before=sh,f.bind=Ta,f.bindAll=Ay,f.bindKey=nh,f.castArray=Bv,f.chain=eh,f.chunk=tg,f.compact=rg,f.concat=ig,f.cond=Oy,f.conforms=Ry,f.constant=ja,f.countBy=lv,f.create=I0,f.curry=oh,f.curryRight=ah,f.debounce=ch,f.defaults=S0,f.defaultsDeep=P0,f.defer=Dv,f.delay=$v,f.difference=sg,f.differenceBy=ng,f.differenceWith=og,f.drop=ag,f.dropRight=cg,f.dropRightWhile=ug,f.dropWhile=hg,f.fill=lg,f.filter=pv,f.flatMap=vv,f.flatMapDeep=yv,f.flatMapDepth=mv,f.flatten=Yu,f.flattenDeep=fg,f.flattenDepth=pg,f.flip=Mv,f.flow=Ny,f.flowRight=Ly,f.fromPairs=dg,f.functions=L0,f.functionsIn=F0,f.groupBy=_v,f.initial=vg,f.intersection=yg,f.intersectionBy=mg,f.intersectionWith=_g,f.invert=$0,f.invertBy=M0,f.invokeMap=bv,f.iteratee=za,f.keyBy=Ev,f.keys=Ut,f.keysIn=or,f.map=Gn,f.mapKeys=z0,f.mapValues=q0,f.matches=Fy,f.matchesProperty=Dy,f.memoize=Jn,f.merge=U0,f.mergeWith=mh,f.method=$y,f.methodOf=My,f.mixin=qa,f.negate=Yn,f.nthArg=zy,f.omit=k0,f.omitBy=H0,f.once=jv,f.orderBy=xv,f.over=qy,f.overArgs=zv,f.overEvery=Uy,f.overSome=ky,f.partial=Na,f.partialRight=uh,f.partition=Iv,f.pick=K0,f.pickBy=_h,f.property=Ph,f.propertyOf=Hy,f.pull=xg,f.pullAll=Zu,f.pullAllBy=Ig,f.pullAllWith=Sg,f.pullAt=Pg,f.range=Ky,f.rangeRight=Vy,f.rearg=qv,f.reject=Cv,f.remove=Cg,f.rest=Uv,f.reverse=Oa,f.sampleSize=Ov,f.set=B0,f.setWith=G0,f.shuffle=Rv,f.slice=Ag,f.sortBy=Lv,f.sortedUniq=Dg,f.sortedUniqBy=$g,f.split=vy,f.spread=kv,f.tail=Mg,f.take=jg,f.takeRight=zg,f.takeRightWhile=qg,f.takeWhile=Ug,f.tap=rv,f.throttle=Hv,f.thru=Bn,f.toArray=dh,f.toPairs=wh,f.toPairsIn=bh,f.toPath=Yy,f.toPlainObject=vh,f.transform=W0,f.unary=Kv,f.union=kg,f.unionBy=Hg,f.unionWith=Kg,f.uniq=Vg,f.uniqBy=Bg,f.uniqWith=Gg,f.unset=J0,f.unzip=Ra,f.unzipWith=Qu,f.update=Y0,f.updateWith=X0,f.values=as,f.valuesIn=Z0,f.without=Wg,f.words=Ih,f.wrap=Vv,f.xor=Jg,f.xorBy=Yg,f.xorWith=Xg,f.zip=Zg,f.zipObject=Qg,f.zipObjectDeep=ev,f.zipWith=tv,f.entries=wh,f.entriesIn=bh,f.extend=yh,f.extendWith=Qn,qa(f,f),f.add=Zy,f.attempt=Sh,f.camelCase=ry,f.capitalize=Eh,f.ceil=Qy,f.clamp=Q0,f.clone=Gv,f.cloneDeep=Jv,f.cloneDeepWith=Yv,f.cloneWith=Wv,f.conformsTo=Xv,f.deburr=xh,f.defaultTo=Ty,f.divide=e1,f.endsWith=iy,f.eq=Lr,f.escape=sy,f.escapeRegExp=ny,f.every=fv,f.find=dv,f.findIndex=Wu,f.findKey=C0,f.findLast=gv,f.findLastIndex=Ju,f.findLastKey=A0,f.floor=t1,f.forEach=th,f.forEachRight=rh,f.forIn=O0,f.forInRight=R0,f.forOwn=T0,f.forOwnRight=N0,f.get=Da,f.gt=Zv,f.gte=Qv,f.has=D0,f.hasIn=$a,f.head=Xu,f.identity=ar,f.includes=wv,f.indexOf=gg,f.inRange=ey,f.invoke=j0,f.isArguments=Mi,f.isArray=fe,f.isArrayBuffer=e0,f.isArrayLike=nr,f.isArrayLikeObject=Et,f.isBoolean=t0,f.isBuffer=yi,f.isDate=r0,f.isElement=i0,f.isEmpty=s0,f.isEqual=n0,f.isEqualWith=o0,f.isError=La,f.isFinite=a0,f.isFunction=ti,f.isInteger=hh,f.isLength=Xn,f.isMap=lh,f.isMatch=c0,f.isMatchWith=u0,f.isNaN=h0,f.isNative=l0,f.isNil=p0,f.isNull=f0,f.isNumber=fh,f.isObject=ct,f.isObjectLike=yt,f.isPlainObject=Ls,f.isRegExp=Fa,f.isSafeInteger=d0,f.isSet=ph,f.isString=Zn,f.isSymbol=fr,f.isTypedArray=os,f.isUndefined=g0,f.isWeakMap=v0,f.isWeakSet=y0,f.join=wg,f.kebabCase=oy,f.last=Ir,f.lastIndexOf=bg,f.lowerCase=ay,f.lowerFirst=cy,f.lt=m0,f.lte=_0,f.max=r1,f.maxBy=i1,f.mean=s1,f.meanBy=n1,f.min=o1,f.minBy=a1,f.stubArray=ka,f.stubFalse=Ha,f.stubObject=By,f.stubString=Gy,f.stubTrue=Wy,f.multiply=c1,f.nth=Eg,f.noConflict=jy,f.noop=Ua,f.now=Wn,f.pad=uy,f.padEnd=hy,f.padStart=ly,f.parseInt=fy,f.random=ty,f.reduce=Sv,f.reduceRight=Pv,f.repeat=py,f.replace=dy,f.result=V0,f.round=u1,f.runInContext=E,f.sample=Av,f.size=Tv,f.snakeCase=gy,f.some=Nv,f.sortedIndex=Og,f.sortedIndexBy=Rg,f.sortedIndexOf=Tg,f.sortedLastIndex=Ng,f.sortedLastIndexBy=Lg,f.sortedLastIndexOf=Fg,f.startCase=yy,f.startsWith=my,f.subtract=h1,f.sum=l1,f.sumBy=f1,f.template=_y,f.times=Jy,f.toFinite=ri,f.toInteger=ve,f.toLength=gh,f.toLower=wy,f.toNumber=Sr,f.toSafeInteger=w0,f.toString=$e,f.toUpper=by,f.trim=Ey,f.trimEnd=xy,f.trimStart=Iy,f.truncate=Sy,f.unescape=Py,f.uniqueId=Xy,f.upperCase=Cy,f.upperFirst=Ma,f.each=th,f.eachRight=rh,f.first=Xu,qa(f,function(){var e={};return Ur(f,function(t,s){je.call(f.prototype,s)||(e[s]=t)}),e}(),{chain:!1}),f.VERSION=n,_r(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){f[e].placeholder=f}),_r(["drop","take"],function(e,t){Se.prototype[e]=function(s){s=s===i?1:jt(ve(s),0);var a=this.__filtered__&&!t?new Se(this):this.clone();return a.__filtered__?a.__takeCount__=Bt(s,a.__takeCount__):a.__views__.push({size:Bt(s,k),type:e+(a.__dir__<0?"Right":"")}),a},Se.prototype[e+"Right"]=function(s){return this.reverse()[e](s).reverse()}}),_r(["filter","map","takeWhile"],function(e,t){var s=t+1,a=s==C||s==ze;Se.prototype[e]=function(h){var p=this.clone();return p.__iteratees__.push({iteratee:re(h,3),type:s}),p.__filtered__=p.__filtered__||a,p}}),_r(["head","last"],function(e,t){var s="take"+(t?"Right":"");Se.prototype[e]=function(){return this[s](1).value()[0]}}),_r(["initial","tail"],function(e,t){var s="drop"+(t?"":"Right");Se.prototype[e]=function(){return this.__filtered__?new Se(this):this[s](1)}}),Se.prototype.compact=function(){return this.filter(ar)},Se.prototype.find=function(e){return this.filter(e).head()},Se.prototype.findLast=function(e){return this.reverse().find(e)},Se.prototype.invokeMap=we(function(e,t){return typeof e=="function"?new Se(this):this.map(function(s){return Cs(s,e,t)})}),Se.prototype.reject=function(e){return this.filter(Yn(re(e)))},Se.prototype.slice=function(e,t){e=ve(e);var s=this;return s.__filtered__&&(e>0||t<0)?new Se(s):(e<0?s=s.takeRight(-e):e&&(s=s.drop(e)),t!==i&&(t=ve(t),s=t<0?s.dropRight(-t):s.take(t-e)),s)},Se.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Se.prototype.toArray=function(){return this.take(k)},Ur(Se.prototype,function(e,t){var s=/^(?:filter|find|map|reject)|While$/.test(t),a=/^(?:head|last)$/.test(t),h=f[a?"take"+(t=="last"?"Right":""):t],p=a||/^find/.test(t);h&&(f.prototype[t]=function(){var y=this.__wrapped__,m=a?[1]:arguments,x=y instanceof Se,N=m[0],L=x||fe(y),M=function(xe){var Ce=h.apply(f,hi([xe],m));return a&&H?Ce[0]:Ce};L&&s&&typeof N=="function"&&N.length!=1&&(x=L=!1);var H=this.__chain__,ee=!!this.__actions__.length,se=p&&!H,me=x&&!ee;if(!p&&L){y=me?y:new Se(this);var ne=e.apply(y,m);return ne.__actions__.push({func:Bn,args:[M],thisArg:i}),new br(ne,H)}return se&&me?e.apply(this,m):(ne=this.thru(M),se?a?ne.value()[0]:ne.value():ne)})}),_r(["pop","push","shift","sort","splice","unshift"],function(e){var t=mn[e],s=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",a=/^(?:pop|shift)$/.test(e);f.prototype[e]=function(){var h=arguments;if(a&&!this.__chain__){var p=this.value();return t.apply(fe(p)?p:[],h)}return this[s](function(y){return t.apply(fe(y)?y:[],h)})}}),Ur(Se.prototype,function(e,t){var s=f[t];if(s){var a=s.name+"";je.call(ts,a)||(ts[a]=[]),ts[a].push({name:t,func:s})}}),ts[zn(i,be).name]=[{name:"wrapper",func:i}],Se.prototype.clone=Pp,Se.prototype.reverse=Cp,Se.prototype.value=Ap,f.prototype.at=iv,f.prototype.chain=sv,f.prototype.commit=nv,f.prototype.next=ov,f.prototype.plant=cv,f.prototype.reverse=uv,f.prototype.toJSON=f.prototype.valueOf=f.prototype.value=hv,f.prototype.first=f.prototype.head,ws&&(f.prototype[ws]=av),f},Zi=np();bt?((bt.exports=Zi)._=Zi,Ge._=Zi):Pe._=Zi}).call(Hs)})(hc,hc.exports);var pE=Object.defineProperty,dE=Object.defineProperties,gE=Object.getOwnPropertyDescriptors,Ol=Object.getOwnPropertySymbols,vE=Object.prototype.hasOwnProperty,yE=Object.prototype.propertyIsEnumerable,Rl=(c,r,i)=>r in c?pE(c,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[r]=i,to=(c,r)=>{for(var i in r||(r={}))vE.call(r,i)&&Rl(c,i,r[i]);if(Ol)for(var i of Ol(r))yE.call(r,i)&&Rl(c,i,r[i]);return c},mE=(c,r)=>dE(c,gE(r));function Ar(c,r,i){let n;const o=lc(c);return r.rpcMap&&(n=r.rpcMap[o]),n||(n=`${fE}?chainId=eip155:${o}&projectId=${i}`),n}function lc(c){return c.includes("eip155")?Number(c.split(":")[1]):Number(c)}function Ff(c){return c.map(r=>`${r.split(":")[0]}:${r.split(":")[1]}`)}function _E(c,r){const i=Object.keys(r.namespaces).filter(o=>o.includes(c));if(!i.length)return[];const n=[];return i.forEach(o=>{const l=r.namespaces[o].accounts;n.push(...l)}),n}function wE(c={},r={}){const i=Tl(c),n=Tl(r);return hc.exports.merge(i,n)}function Tl(c){var r,i,n,o;const l={};if(!so(c))return l;for(const[d,v]of Object.entries(c)){const _=Kl(d)?[d]:v.chains,S=v.methods||[],F=v.events||[],G=v.rpcMap||{},W=no(d);l[W]=mE(to(to({},l[W]),v),{chains:Va(_,(r=l[W])==null?void 0:r.chains),methods:Va(S,(i=l[W])==null?void 0:i.methods),events:Va(F,(n=l[W])==null?void 0:n.events),rpcMap:to(to({},G),(o=l[W])==null?void 0:o.rpcMap)})}return l}function bE(c){return c.includes(":")?c.split(":")[2]:c}function EE(c){const r={};for(const[i,n]of Object.entries(c)){const o=n.methods||[],l=n.events||[],d=n.accounts||[],v=Kl(i)?[i]:n.chains?n.chains:Ff(n.accounts);r[i]={chains:v,methods:o,events:l,accounts:d}}return r}const Df={},It=c=>Df[c],ic=(c,r)=>{Df[c]=r};class xE{constructor(r){this.name="polkadot",this.namespace=r.namespace,this.events=It("events"),this.client=It("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){if(this.chainId=r,!this.httpProviders[r]){const n=i||Ar(`${this.name}:${r}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2])||[]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var n;r[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[i])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProvider(r,i){const n=i||Ar(r,this.namespace);return typeof n>"u"?void 0:new Ei(new Ui(n,It("disableProviderPing")))}}class IE{constructor(r){this.name="eip155",this.namespace=r.namespace,this.events=It("events"),this.client=It("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(r){switch(r.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(r);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(r.request.method)?await this.client.request(r):this.getHttpProvider().request(r.request)}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}setDefaultChain(r,i){const n=lc(r);if(!this.httpProviders[n]){const o=i||Ar(`${this.name}:${n}`,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${n}`);this.setHttpProvider(n,o)}this.chainId=n,this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${n}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}createHttpProvider(r,i){const n=i||Ar(`${this.name}:${r}`,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Ei(new Ui(n,It("disableProviderPing")))}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var n;const o=lc(i);r[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[i])}),r}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}getHttpProvider(){const r=this.chainId,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}async handleSwitchChain(r){var i,n;let o=r.request.params?(i=r.request.params[0])==null?void 0:i.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const l=parseInt(o,16);if(this.isChainApproved(l))this.setDefaultChain(`${l}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:r.topic,request:{method:r.request.method,params:[{chainId:o}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${l}`);else throw new Error(`Failed to switch to chain 'eip155:${l}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(r){return this.namespace.chains.includes(`${this.name}:${r}`)}}class SE{constructor(r){this.name="solana",this.namespace=r.namespace,this.events=It("events"),this.client=It("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){if(!this.httpProviders[r]){const n=i||Ar(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.chainId=r,this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var n;r[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[i])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProvider(r,i){const n=i||Ar(r,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Ei(new Ui(n,It("disableProviderPing")))}}class PE{constructor(r){this.name="cosmos",this.namespace=r.namespace,this.events=It("events"),this.client=It("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){if(this.chainId=r,!this.httpProviders[r]){const n=i||Ar(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var n;r[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[i])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProvider(r,i){const n=i||Ar(r,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Ei(new Ui(n,It("disableProviderPing")))}}class CE{constructor(r){this.name="cip34",this.namespace=r.namespace,this.events=It("events"),this.client=It("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){if(this.chainId=r,!this.httpProviders[r]){const n=i||this.getCardanoRPCUrl(r);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{const n=this.getCardanoRPCUrl(i);r[i]=this.createHttpProvider(i,n)}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}getCardanoRPCUrl(r){const i=this.namespace.rpcMap;if(i)return i[r]}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProvider(r,i){const n=i||this.getCardanoRPCUrl(r);return typeof n>"u"?void 0:new Ei(new Ui(n,It("disableProviderPing")))}}class AE{constructor(r){this.name="elrond",this.namespace=r.namespace,this.events=It("events"),this.client=It("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){if(!this.httpProviders[r]){const n=i||Ar(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.chainId=r,this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var n;r[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[i])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProvider(r,i){const n=i||Ar(r,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Ei(new Ui(n,It("disableProviderPing")))}}class OE{constructor(r){this.name="multiversx",this.namespace=r.namespace,this.events=It("events"),this.client=It("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,i){if(!this.httpProviders[r]){const n=i||Ar(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.chainId=r,this.events.emit(xi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(i=>i.split(":")[1]===this.chainId.toString()).map(i=>i.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(i=>{var n;r[i]=this.createHttpProvider(i,(n=this.namespace.rpcMap)==null?void 0:n[i])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,i=this.httpProviders[r];if(typeof i>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return i}setHttpProvider(r,i){const n=this.createHttpProvider(r,i);n&&(this.httpProviders[r]=n)}createHttpProvider(r,i){const n=i||Ar(r,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new Ei(new Ui(n,It("disableProviderPing")))}}var RE=Object.defineProperty,TE=Object.defineProperties,NE=Object.getOwnPropertyDescriptors,Nl=Object.getOwnPropertySymbols,LE=Object.prototype.hasOwnProperty,FE=Object.prototype.propertyIsEnumerable,Ll=(c,r,i)=>r in c?RE(c,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[r]=i,ro=(c,r)=>{for(var i in r||(r={}))LE.call(r,i)&&Ll(c,i,r[i]);if(Nl)for(var i of Nl(r))FE.call(r,i)&&Ll(c,i,r[i]);return c},sc=(c,r)=>TE(c,NE(r));class Cc{constructor(r){this.events=new yc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=r,this.logger=typeof(r==null?void 0:r.logger)<"u"&&typeof(r==null?void 0:r.logger)!="string"?r.logger:Ae.pino(Ae.getDefaultLoggerOptions({level:(r==null?void 0:r.logger)||Cl})),this.disableProviderPing=(r==null?void 0:r.disableProviderPing)||!1}static async init(r){const i=new Cc(r);return await i.initialize(),i}async request(r,i){const[n,o]=this.validateChain(i);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:ro({},r),chainId:`${n}:${o}`,topic:this.session.topic})}sendAsync(r,i,n){this.request(r,n).then(o=>i(null,o)).catch(o=>i(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var r;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(r=this.session)==null?void 0:r.topic,reason:tr("USER_DISCONNECTED")}),await this.cleanup()}async connect(r){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(r),await this.cleanupPendingPairings(),!r.skipPairing)return await this.pair(r.pairingTopic)}on(r,i){this.events.on(r,i)}once(r,i){this.events.once(r,i)}removeListener(r,i){this.events.removeListener(r,i)}off(r,i){this.events.off(r,i)}get isWalletConnect(){return!0}async pair(r){this.shouldAbortPairingAttempt=!1;let i=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(i>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:n,approval:o}=await this.client.connect({pairingTopic:r,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});n&&(this.uri=n,this.events.emit("display_uri",n)),await o().then(l=>{this.session=l,this.namespaces||(this.namespaces=EE(l.namespaces),this.persist("namespaces",this.namespaces))}).catch(l=>{if(l.message!==Nf)throw l;i++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(r,i){try{if(!this.session)return;const[n,o]=this.validateChain(r);this.getProvider(n).setDefaultChain(o,i)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(r={}){this.logger.info("Cleaning up inactive pairings...");const i=this.client.pairing.getAll();if(ps(i)){for(const n of i)r.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${i.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const r=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[r]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await nE.init({logger:this.providerOpts.logger||Cl,relayUrl:this.providerOpts.relayUrl||uE,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const r=[...new Set(Object.keys(this.session.namespaces).map(i=>no(i)))];ic("client",this.client),ic("events",this.events),ic("disableProviderPing",this.disableProviderPing),r.forEach(i=>{if(!this.session)return;const n=_E(i,this.session),o=Ff(n),l=wE(this.namespaces,this.optionalNamespaces),d=sc(ro({},l[i]),{accounts:n,chains:o});switch(i){case"eip155":this.rpcProviders[i]=new IE({namespace:d});break;case"solana":this.rpcProviders[i]=new SE({namespace:d});break;case"cosmos":this.rpcProviders[i]=new PE({namespace:d});break;case"polkadot":this.rpcProviders[i]=new xE({namespace:d});break;case"cip34":this.rpcProviders[i]=new CE({namespace:d});break;case"elrond":this.rpcProviders[i]=new AE({namespace:d});break;case"multiversx":this.rpcProviders[i]=new OE({namespace:d});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",r=>{this.events.emit("session_ping",r)}),this.client.on("session_event",r=>{const{params:i}=r,{event:n}=i;if(n.name==="accountsChanged"){const o=n.data;o&&ps(o)&&this.events.emit("accountsChanged",o.map(bE))}else n.name==="chainChanged"?this.onChainChanged(i.chainId):this.events.emit(n.name,n.data);this.events.emit("session_event",r)}),this.client.on("session_update",({topic:r,params:i})=>{var n;const{namespaces:o}=i,l=(n=this.client)==null?void 0:n.session.get(r);this.session=sc(ro({},l),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:r,params:i})}),this.client.on("session_delete",async r=>{await this.cleanup(),this.events.emit("session_delete",r),this.events.emit("disconnect",sc(ro({},tr("USER_DISCONNECTED")),{data:r.topic}))}),this.on(xi.DEFAULT_CHAIN_CHANGED,r=>{this.onChainChanged(r,!0)})}getProvider(r){if(!this.rpcProviders[r])throw new Error(`Provider not found: ${r}`);return this.rpcProviders[r]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(r=>{var i;this.getProvider(r).updateNamespace((i=this.session)==null?void 0:i.namespaces[r])})}setNamespaces(r){const{namespaces:i,optionalNamespaces:n,sessionProperties:o}=r;i&&Object.keys(i).length&&(this.namespaces=i),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=o,this.persist("namespaces",i),this.persist("optionalNamespaces",n)}validateChain(r){const[i,n]=(r==null?void 0:r.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[i,n];if(i&&!Object.keys(this.namespaces||{}).map(d=>no(d)).includes(i))throw new Error(`Namespace '${i}' is not configured. Please call connect() first with namespace config.`);if(i&&n)return[i,n];const o=no(Object.keys(this.namespaces)[0]),l=this.rpcProviders[o].getDefaultChain();return[o,l]}async requestAccounts(){const[r]=this.validateChain();return await this.getProvider(r).requestAccounts()}onChainChanged(r,i=!1){var n;if(!this.namespaces)return;const[o,l]=this.validateChain(r);i||this.getProvider(o).setDefaultChain(l),((n=this.namespaces[o])!=null?n:this.namespaces[`${o}:${l}`]).defaultChain=l,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",l)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(r,i){this.client.core.storage.setItem(`${Al}/${r}`,i)}async getFromStore(r){return await this.client.core.storage.getItem(`${Al}/${r}`)}}const DE=Cc,$E="wc",ME="ethereum_provider",jE=`${$E}@2:${ME}:`,zE="https://rpc.walletconnect.com/v1/",fc=["eth_sendTransaction","personal_sign"],qE=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],pc=["chainChanged","accountsChanged"],UE=["message","disconnect","connect"];var kE=Object.defineProperty,HE=Object.defineProperties,KE=Object.getOwnPropertyDescriptors,Fl=Object.getOwnPropertySymbols,VE=Object.prototype.hasOwnProperty,BE=Object.prototype.propertyIsEnumerable,Dl=(c,r,i)=>r in c?kE(c,r,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[r]=i,Ks=(c,r)=>{for(var i in r||(r={}))VE.call(r,i)&&Dl(c,i,r[i]);if(Fl)for(var i of Fl(r))BE.call(r,i)&&Dl(c,i,r[i]);return c},$l=(c,r)=>HE(c,KE(r));function ho(c){return Number(c[0].split(":")[1])}function nc(c){return`0x${c.toString(16)}`}function GE(c){const{chains:r,optionalChains:i,methods:n,optionalMethods:o,events:l,optionalEvents:d,rpcMap:v}=c;if(!ps(r))throw new Error("Invalid chains");const _={chains:r,methods:n||fc,events:l||pc,rpcMap:Ks({},r.length?{[ho(r)]:v[ho(r)]}:{})},S=l==null?void 0:l.filter(V=>!pc.includes(V)),F=n==null?void 0:n.filter(V=>!fc.includes(V));if(!i&&!d&&!o&&!(S!=null&&S.length)&&!(F!=null&&F.length))return{required:r.length?_:void 0};const G=(S==null?void 0:S.length)&&(F==null?void 0:F.length)||!i,W={chains:[...new Set(G?_.chains.concat(i||[]):i)],methods:[...new Set(_.methods.concat(o!=null&&o.length?o:qE))],events:[...new Set(_.events.concat(d||UE))],rpcMap:v};return{required:r.length?_:void 0,optional:i.length?W:void 0}}class Ac{constructor(){this.events=new vr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=jE,this.on=(r,i)=>(this.events.on(r,i),this),this.once=(r,i)=>(this.events.once(r,i),this),this.removeListener=(r,i)=>(this.events.removeListener(r,i),this),this.off=(r,i)=>(this.events.off(r,i),this),this.parseAccount=r=>this.isCompatibleChainId(r)?this.parseAccountId(r).address:r,this.signer={},this.rpc={}}static async init(r){const i=new Ac;return await i.initialize(r),i}async request(r){return await this.signer.request(r,this.formatChainId(this.chainId))}sendAsync(r,i){this.signer.sendAsync(r,i,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(r){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(r);const{required:i,optional:n}=GE(this.rpc);try{const o=await new Promise(async(d,v)=>{var _;this.rpc.showQrModal&&((_=this.modal)==null||_.subscribeModal(S=>{!S.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),v(new Error("Connection request reset. Please try again.")))})),await this.signer.connect($l(Ks({namespaces:Ks({},i&&{[this.namespace]:i})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:r==null?void 0:r.pairingTopic})).then(S=>{d(S)}).catch(S=>{v(new Error(S.message))})});if(!o)return;this.setChainIds(this.rpc.chains);const l=Z1(o.namespaces,[this.namespace]);this.setAccounts(l),this.events.emit("connect",{chainId:nc(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",r=>{const{params:i}=r,{event:n}=i;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",r)}),this.signer.on("chainChanged",r=>{const i=parseInt(r);this.chainId=i,this.events.emit("chainChanged",nc(this.chainId)),this.persist()}),this.signer.on("session_update",r=>{this.events.emit("session_update",r)}),this.signer.on("session_delete",r=>{this.reset(),this.events.emit("session_delete",r),this.events.emit("disconnect",$l(Ks({},tr("USER_DISCONNECTED")),{data:r.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",r=>{var i,n;this.rpc.showQrModal&&((i=this.modal)==null||i.closeModal(),(n=this.modal)==null||n.openModal({uri:r})),this.events.emit("display_uri",r)})}switchEthereumChain(r){this.request({method:"wallet_switchEthereumChain",params:[{chainId:r.toString(16)}]})}isCompatibleChainId(r){return typeof r=="string"?r.startsWith(`${this.namespace}:`):!1}formatChainId(r){return`${this.namespace}:${r}`}parseChainId(r){return Number(r.split(":")[1])}setChainIds(r){const i=r.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));i.length&&(this.chainId=i[0],this.events.emit("chainChanged",nc(this.chainId)),this.persist())}setChainId(r){if(this.isCompatibleChainId(r)){const i=this.parseChainId(r);this.chainId=i,this.switchEthereumChain(i)}}parseAccountId(r){const[i,n,o]=r.split(":");return{chainId:`${i}:${n}`,address:o}}setAccounts(r){this.accounts=r.filter(i=>this.parseChainId(this.parseAccountId(i).chainId)===this.chainId).map(i=>this.parseAccountId(i).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(r){var i,n;const o=(i=r==null?void 0:r.chains)!=null?i:[],l=(n=r==null?void 0:r.optionalChains)!=null?n:[],d=o.concat(l);if(!d.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const v=o.length?(r==null?void 0:r.methods)||fc:[],_=o.length?(r==null?void 0:r.events)||pc:[],S=(r==null?void 0:r.optionalMethods)||[],F=(r==null?void 0:r.optionalEvents)||[],G=(r==null?void 0:r.rpcMap)||this.buildRpcMap(d,r.projectId),W=(r==null?void 0:r.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(V=>this.formatChainId(V)),optionalChains:l.map(V=>this.formatChainId(V)),methods:v,events:_,optionalMethods:S,optionalEvents:F,rpcMap:G,showQrModal:!!(r!=null&&r.showQrModal),qrModalOptions:W,projectId:r.projectId,metadata:r.metadata}}buildRpcMap(r,i){const n={};return r.forEach(o=>{n[o]=this.getRpcUrl(o,i)}),n}async initialize(r){if(this.rpc=this.getRpcConfig(r),this.chainId=this.rpc.chains.length?ho(this.rpc.chains):ho(this.rpc.optionalChains),this.signer=await DE.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:r.disableProviderPing,relayUrl:r.relayUrl,storageOptions:r.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let i;try{const{WalletConnectModal:n}=await Q1(()=>import("./index-84d57964.js").then(o=>o.a),["assets/index-84d57964.js","assets/index-59901e21.js","assets/index-166bc574.css"]);i=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(i)try{this.modal=new i(Ks({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(r){if(!r)return;const{chains:i,optionalChains:n,rpcMap:o}=r;i&&ps(i)&&(this.rpc.chains=i.map(l=>this.formatChainId(l)),i.forEach(l=>{this.rpc.rpcMap[l]=(o==null?void 0:o[l])||this.getRpcUrl(l)})),n&&ps(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n==null?void 0:n.map(l=>this.formatChainId(l)),n.forEach(l=>{this.rpc.rpcMap[l]=(o==null?void 0:o[l])||this.getRpcUrl(l)}))}getRpcUrl(r,i){var n;return((n=this.rpc.rpcMap)==null?void 0:n[r])||`${zE}?chainId=eip155:${r}&projectId=${i||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const r=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),i=this.session.namespaces[`${this.namespace}:${r}`]?this.session.namespaces[`${this.namespace}:${r}`]:this.session.namespaces[this.namespace];this.setChainIds(r?[this.formatChainId(r)]:i==null?void 0:i.accounts),this.setAccounts(i==null?void 0:i.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(r){return typeof r=="string"||r instanceof String?[this.parseAccount(r)]:r.map(i=>this.parseAccount(i))}}const ix=Ac;export{ix as EthereumProvider,UE as OPTIONAL_EVENTS,qE as OPTIONAL_METHODS,pc as REQUIRED_EVENTS,fc as REQUIRED_METHODS,Ac as default};
